<?php
 class WxpayAPI { private static $debug = true; private static $pay_url = "\150\164\x74\x70\163\x3a\57\57\141\160\x69\56\155\143\150\x2e\167\145\151\x78\x69\x6e\x2e\x71\x71\x2e\x63\x6f\x6d\x2f\x6d\x6d\x70\x61\171\x6d\153\x74\x74\162\x61\156\x73\x66\x65\x72\163\x2f\160\x72\x6f\x6d\157\164\151\157\156\57\164\162\x61\156\163\x66\145\x72\163"; private static $query_url = "\x68\164\164\160\163\72\57\x2f\x61\160\151\56\x6d\143\x68\56\x77\x65\x69\x78\151\156\x2e\x71\161\56\x63\157\x6d\57\x6d\155\x70\x61\171\x6d\x6b\164\x74\162\x61\156\x73\146\x65\x72\x73\x2f\x67\x65\164\x74\x72\141\x6e\x73\x66\x65\x72\x69\156\x66\x6f"; public static function pay($param, $extra = array()) { goto BMUUD; llxvq: $headers["\x43\125\122\114\117\x50\x54\137\123\123\114\137\x56\105\122\111\x46\131\x50\105\105\122"] = false; goto sFKj3; ioVkv: $headers = array(); goto zlNoS; TBid0: if ($gGDL5) { goto RLW8Z; } goto q7RRK; B56NE: eKuS1: goto ziHGG; Hwczg: $svPVJ = empty($extra["\x72\x6f\157\x74\x63\x61"]); goto ZB3vb; qX08r: $b_Z0u = !empty($xml); goto m13jP; p5CUz: $response = ihttp_request(self::$pay_url, $xml_data, $headers); goto S79vV; dCzXL: $sign = self::sign($data, $extra["\163\151\x67\156\x5f\153\145\171"]); goto DmDqw; vXcqf: h1hKg: goto QDedY; VBp1A: WeUtility::logging("\164\162\x61\x63\x65", "\x78\x6d\154\75" . var_export($xml, true)); goto B56NE; I0z7j: if ($return_code == "\123\125\103\x43\105\123\123" && $result_code == "\x53\125\x43\103\105\123\x53") { goto jVVd8; } goto OqxGr; wZHMA: RLW8Z: goto p5CUz; Utawr: WeUtility::logging("\x74\x72\141\143\x65", "\x72\x65\x73\x70\157\x6e\163\145\75" . $response); goto Spavk; gCT6E: $headers["\x43\125\x52\x4c\117\x50\x54\137\x43\x41\x49\116\x46\x4f"] = $extra["\x72\x6f\157\x74\x63\141"]; goto vXcqf; dck4U: $ret = array("\163\x75\143\143\145\163\x73" => true, "\160\x61\x72\x74\156\145\162\137\164\x72\x61\144\145\x5f\156\157" => $xml->partner_trade_no, "\160\141\171\155\x65\x6e\x74\137\x6e\x6f" => $xml->payment_no, "\160\141\171\155\x65\156\x74\x5f\164\x69\155\x65" => $xml->payment_time); goto nW0Dw; zlNoS: $headers["\x43\157\x6e\x74\145\156\x74\55\124\171\160\x65"] = "\x61\x70\160\x6c\151\x63\141\x74\x69\157\x6e\x2f\x78\x2d\167\x77\x77\x2d\x66\157\162\155\55\165\x72\154\x65\x6e\143\x6f\144\x65\x64"; goto llxvq; Vf6hz: if ($nrCmM) { goto Qx4NQ; } goto w1FnG; m13jP: if ($b_Z0u) { goto TRmt0; } goto Jhn8U; aRbOm: $gGDL5 = !self::$debug; goto qf3Xy; Jhn8U: return "\x5b\x77\170\x70\x61\x79\55\x61\x70\151\x3a\x70\141\x79\135\x20\160\141\162\163\145\40\x78\155\154\x20\116\125\114\x4c"; goto XcNHz; VL3u4: if ($gGDL5) { goto eKuS1; } goto VBp1A; ziHGG: $return_code = $xml->return_code ? (string) $xml->return_code : ''; goto ZYyn2; dDOxe: jVVd8: goto dck4U; EjTUN: $err_code = $xml->err_code ? (string) $xml->err_code : ''; goto nxANc; BMUUD: $data = array("\x6d\143\x68\x5f\141\160\160\x69\144" => $param["\155\143\150\x5f\x61\160\160\151\144"], "\155\143\x68\x69\144" => $param["\155\x63\x68\x69\x64"], "\156\x6f\156\143\145\137\163\164\162" => $param["\156\157\x6e\x63\145\x5f\163\x74\x72"], "\x70\x61\x72\164\156\145\162\137\164\x72\141\144\145\x5f\x6e\157" => $param["\x70\141\x72\164\156\x65\x72\x5f\164\x72\141\x64\145\137\x6e\x6f"], "\x6f\160\145\x6e\151\x64" => $param["\x6f\160\x65\156\x69\144"], "\x63\x68\x65\x63\x6b\137\x6e\141\155\x65" => $param["\143\150\145\x63\153\137\156\141\155\145"], "\162\145\x5f\165\163\145\162\x5f\x6e\x61\155\x65" => $param["\162\145\x5f\x75\163\145\x72\x5f\156\x61\x6d\145"], "\x61\x6d\157\x75\x6e\164" => $param["\141\155\157\x75\156\164"] * 100, "\144\x65\163\143" => $param["\x64\x65\x73\x63"], "\163\x70\142\x69\x6c\x6c\137\x63\x72\145\x61\x74\145\x5f\151\x70" => $param["\x73\x70\x62\151\154\154\x5f\x63\162\145\141\164\x65\137\151\x70"]); goto dCzXL; QDedY: $gGDL5 = !self::$debug; goto TBid0; ZB3vb: if ($svPVJ) { goto h1hKg; } goto gCT6E; t4jXv: WeUtility::logging("\x74\162\x61\x63\x65", "\x68\x65\x61\x64\x65\x72\x73\75" . var_export($headers, true)); goto wZHMA; S79vV: $nrCmM = !($response == ''); goto Vf6hz; sFKj3: $headers["\103\125\122\x4c\117\120\x54\x5f\x53\123\114\x5f\x56\105\122\x49\106\131\110\x4f\123\x54"] = false; goto LOTW3; XcNHz: TRmt0: goto P4rL4; ZYyn2: $return_msg = $xml->return_msg ? (string) $xml->return_msg : ''; goto WvgFa; nxANc: $err_code_des = $xml->err_code_des ? (string) $xml->err_code_des : ''; goto I0z7j; P4rL4: $gGDL5 = !self::$debug; goto VL3u4; nW0Dw: return $ret; goto u3yjU; u3yjU: zBAGr: goto n7Soj; q7RRK: WeUtility::logging("\164\162\x61\x63\x65", "\x78\x6d\x6c\137\144\x61\x74\141\x3d" . $xml_data); goto t4jXv; V0EMR: $headers["\x43\125\122\114\x4f\120\124\137\123\123\114\x43\105\122\x54"] = $extra["\x61\x70\151\x63\154\151\145\156\x74\137\x63\x65\x72\164"]; goto mWNNH; LOTW3: $headers["\x43\125\122\114\117\120\124\x5f\x53\123\114\x43\x45\122\124\x54\131\x50\x45"] = "\x50\x45\x4d"; goto V0EMR; w1FnG: return "\x5b\167\170\160\141\171\x2d\x61\x70\151\x3a\x70\141\171\x5d\40\162\145\163\x70\157\x6e\x73\145\40\116\x55\114\x4c"; goto Eh843; DmDqw: $xml_data = "\74\x78\x6d\x6c\x3e\x3c\x6d\143\x68\x5f\x61\x70\x70\151\x64\76{$data["\x6d\143\150\137\141\x70\160\x69\144"]}\x3c\57\x6d\143\150\137\x61\160\x70\151\x64\76\74\x6d\143\x68\151\x64\x3e{$data["\155\x63\150\x69\144"]}\x3c\x2f\x6d\143\150\151\x64\76\74\x6e\157\x6e\x63\x65\x5f\163\x74\x72\76{$data["\156\x6f\156\143\x65\x5f\163\x74\162"]}\x3c\x2f\156\x6f\x6e\x63\x65\x5f\x73\x74\x72\x3e\x3c\160\x61\x72\x74\x6e\x65\x72\x5f\164\162\x61\144\145\137\156\157\76{$data["\160\x61\162\164\156\x65\x72\x5f\164\162\141\144\145\x5f\156\157"]}\74\57\160\141\x72\164\156\x65\x72\137\x74\x72\141\144\145\x5f\156\157\x3e\x3c\157\160\x65\156\x69\x64\76{$data["\x6f\x70\145\x6e\151\144"]}\x3c\57\157\160\145\x6e\151\144\76\x3c\143\150\x65\143\x6b\x5f\156\x61\x6d\x65\76{$data["\x63\x68\145\x63\153\x5f\156\141\155\x65"]}\74\57\143\150\145\x63\153\137\156\x61\155\x65\x3e\x3c\x72\x65\x5f\165\163\145\162\x5f\x6e\x61\155\x65\x3e{$data["\162\145\x5f\165\163\145\162\x5f\156\x61\155\145"]}\74\57\162\x65\x5f\165\163\x65\162\137\156\x61\155\x65\76\74\x61\x6d\157\165\156\x74\76{$data["\x61\x6d\157\x75\156\x74"]}\x3c\57\x61\x6d\x6f\165\156\164\76\x3c\x64\145\x73\x63\76{$data["\x64\145\x73\143"]}\x3c\x2f\x64\145\163\143\76\74\163\x70\142\151\154\154\137\x63\162\x65\x61\164\x65\137\x69\x70\x3e{$data["\x73\x70\x62\x69\154\154\x5f\143\x72\x65\x61\x74\145\137\151\160"]}\x3c\x2f\x73\160\x62\151\x6c\x6c\x5f\143\162\145\x61\164\x65\x5f\151\x70\x3e\74\163\151\147\156\76{$sign}\x3c\57\x73\x69\x67\x6e\x3e\74\57\x78\155\154\x3e"; goto ioVkv; WvgFa: $result_code = $xml->result_code ? (string) $xml->result_code : ''; goto EjTUN; OqxGr: return $return_code . "\72" . $return_msg . "\54" . $err_code . "\72" . $err_code_des; goto YHLel; Eh843: Qx4NQ: goto z_RL9; YHLel: goto zBAGr; goto dDOxe; rdl_i: $xml = @simplexml_load_string($response); goto qX08r; qf3Xy: if ($gGDL5) { goto Dxanl; } goto Utawr; Spavk: Dxanl: goto rdl_i; mWNNH: $headers["\x43\125\122\x4c\x4f\x50\x54\137\123\123\x4c\113\x45\x59\124\x59\120\x45"] = "\x50\105\115"; goto JA3_f; JA3_f: $headers["\x43\x55\x52\114\x4f\120\x54\137\x53\x53\114\x4b\x45\x59"] = $extra["\x61\160\151\143\154\x69\x65\x6e\x74\x5f\x6b\x65\x79"]; goto Hwczg; z_RL9: $response = $response["\x63\157\156\164\145\x6e\164"]; goto aRbOm; n7Soj: } public static function query($param) { } public static function sign($data, $sign_key) { goto Qi2VR; o7NHr: foreach ($data as $k => $v) { goto Uu6jJ; Uu6jJ: $CM3R5 = !($v == '' || $k == "\x73\151\x67\x6e"); goto MKzLt; Eng1h: kSEH1: goto x5Nsg; twW20: goto kSEH1; goto GGloA; GGloA: ANN3H: goto jRGll; MKzLt: if ($CM3R5) { goto ANN3H; } goto twW20; jRGll: $data_str .= "{$k}\x3d{$v}\x26"; goto Eng1h; x5Nsg: } goto WXBpG; ypmyn: return $sign; goto PsekX; Qi2VR: ksort($data); goto dqEiw; foYbJ: $data_str .= "\153\x65\171\75" . $sign_key; goto C5p52; dqEiw: $data_str = ''; goto o7NHr; WXBpG: nEQUh: goto foYbJ; C5p52: $sign = strtoupper(md5($data_str)); goto ypmyn; PsekX: } }