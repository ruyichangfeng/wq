<!DOCTYPE html>
<html>
<head>
    <meta charset="utf8">
    <title>js拖拽效果</title>
    <style type="text/css">
        #nickname {
            width : 200px;
            height: 200px;
            position: absolute;
            background: #99dd33;
            cursor: move;
        }
        #qrcode {
            width : 200px;
            height: 200px;
            position: absolute;
            background: #99dd33;
            cursor: move;
        }
    </style>
</head>
<body>
<div id="nickname"></div>
<div id="qrcode"></div>
</body>
<script type="text/javascript">
    window.onload=function() {
        var disX = disY = 0;                         // 鼠标距离div的左距离和上距离
        var nickname = document.getElementById("nickname");  // 得到nickname对象
        var qrcode = document.getElementById("qrcode");  // 得到nickname对象

        // 鼠标按下nickname时
        nickname.onmousedown = function(e) {
            var evnt = e || event;                   // 得到鼠标事件
            disX = evnt.clientX - nickname.offsetLeft;   // 鼠标横坐标 - nickname的left
            disY = evnt.clientY - nickname.offsetTop;    // 鼠标纵坐标 - nickname的top

            // 鼠标移动时
            document.onmousemove = function(e) {
                var evnt = e || event;
                var x = evnt.clientX - disX;
                var y = evnt.clientY - disY;
                var window_width  = document.documentElement.clientWidth  - nickname.offsetWidth;
                var window_height = document.documentElement.clientHeight - nickname.offsetHeight;

                x = ( x < 0 ) ? 0 : x;                          // 当nickname到窗口最左边时
                x = ( x > window_width ) ? window_width : x;    // 当nickname到窗口最右边时
                y = ( y < 0 ) ? 0 : y;                          // 当nickname到窗口最上边时
                y = ( y > window_height ) ? window_height : y;  // 当nickname到窗口最下边时

                nickname.style.left = x + "px";
                nickname.style.top  = y + "px";
            };

            // 鼠标抬起时
            document.onmouseup = function() {
                document.onmousemove =null;
                document.onmouup = null;
            };

            return false;
        };


        // 鼠标按下qrcode时
        qrcode.onmousedown = function(e) {
            var evnt = e || event;                   // 得到鼠标事件
            disX = evnt.clientX - qrcode.offsetLeft;   // 鼠标横坐标 - qrcode的left
            disY = evnt.clientY - qrcode.offsetTop;    // 鼠标纵坐标 - qrcode的top

            // 鼠标移动时
            document.onmousemove = function(e) {
                var evnt = e || event;
                var x = evnt.clientX - disX;
                var y = evnt.clientY - disY;
                var window_width  = document.documentElement.clientWidth  - qrcode.offsetWidth;
                var window_height = document.documentElement.clientHeight - qrcode.offsetHeight;

                x = ( x < 0 ) ? 0 : x;                          // 当qrcode到窗口最左边时
                x = ( x > window_width ) ? window_width : x;    // 当qrcode到窗口最右边时
                y = ( y < 0 ) ? 0 : y;                          // 当qrcode到窗口最上边时
                y = ( y > window_height ) ? window_height : y;  // 当qrcode到窗口最下边时

                qrcode.style.left = x + "px";
                qrcode.style.top  = y + "px";
            };

            // 鼠标抬起时
            document.onmouseup = function() {
                document.onmousemove =null;
                document.onmouup = null;
            };

            return false;
        };
    };
</script>
</html>