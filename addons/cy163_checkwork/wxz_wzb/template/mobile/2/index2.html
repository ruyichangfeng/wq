<html><head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" id="viewport">
		<meta name="viewport" content="target-densitydpi=get-target-densitydpi, width=device-width, user-scalable=no">
		<meta name="format-detection" content="telephone=no">
		
		<title>{$item['title']}</title>
		<link href="{MODULE_URL}template/mobile/2/css/common.css" rel="stylesheet">
		<link rel="stylesheet" href="{MODULE_URL}template/mobile/2/css/mui.css">
		<link rel="stylesheet" type="text/css" href="{MODULE_URL}template/mobile/2/css/swiper.min.css">
		<link rel="stylesheet" href="{MODULE_URL}template/mobile/2/css/indexstyle.css">
		<link rel="stylesheet" type="text/css" href="{MODULE_URL}template/mobile/2/css/indexstyleadd.css">
		<script type="text/javascript" src=" https://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
	</head>

	<body>
		<input type="hidden" id="pid" value="{$pid['id']}">
		<div class="main">
		{if $item['theme']}
			<div class="swiper-container advertising swiper-container-horizontal">
				<div class="swiper-wrapper" style="height:auto;">
					<div class="swiper-slide swiper-slide-duplicate swiper-slide-next" style="height:auto;">
						<img src="{php echo tomedia($item['theme'])}">							
					</div>
					<div class="swiper-slide swiper-slide-prev" style="height:auto;">
						<img src="{php echo tomedia($item['theme'])}">					
					</div>				    
					<div class="swiper-slide swiper-slide-duplicate swiper-slide-active" style="height:auto;">
						<img src="{php echo tomedia($item['theme'])}">						
					</div>
				</div>
				<div class="swiper-pagination swiper-pagination-bullets"><span class="swiper-pagination-bullet swiper-pagination-bullet-active"></span></div>
			</div>	
		{/if}
				<section class="content">
				<div class="fixedfile">
					<div class="all-vide">
						<section class="block_video" id="play" style="height: 210px;"><video id="html5Media1" autoplay="" controls="" preload="auto" width="100%" height="100%" poster="{php echo tomedia($list['settings']['img'])}" webkit-playsinline="" playsinline="" type="application/x-mpegURL" src="{$list['settings']['hls']}"></video></section>
					<i class="max-start"></i>

					<p class="header-an">{$item['title']}</p>
					<div class="schedule">
						<p class="iconfont sche-start"></p>
						<p class="sche-nowtime">00:00</p>
						<div class="process">
					        <div class="process-bar"></div>
					        <span class="bar" id="mybar"></span>
					    </div>
						<p class="sche-alltime">00:00</p>
					</div>
					<div class="watermark">
							<p>小智新版直播</p>
							<div class="fl vp">
								 <i class="iconfont"></i>
								 <span id="browsenum">
								 {if $item['istruenum']==1}
								{$item['real_num']}
								{else}
								{$item['total_num']}
								{/if}</span>
							</div>
						</div>
					</div>
					<ul class="TAstate borb" style="position:relative">
					{loop $menu $key $value}
						<li class="{if $key==0} currentli {/if}" data-type={$value['type']}>{$value['name']}</li>
					{/loop}
					</ul>
				</div>
				<section class="contents">
					{if $roll && $roll['type']==1}
					<section class="width640 gun">
						<marquee onmouseover="this.stop();" onmouseout="this.start();" scrollamount="8" scrolldelay="160" direction="left" width="100%" loop="-1" behavior="scroll" height="25px">{$roll['content']}</marquee>
					</section>
					{/if}
					{loop $menu $key $value}
					{if $value['type']=='3'}
					<div class="showthisd {if $key !=0} hidediv {/if} live">
						<div class="grap" style="cursor: pointer; display: none; z-index: 5;"></div>
						<ul class="chat_title" style="cursor: pointer;">
							<p class="tishis">您已进入直播房间，请文明聊天，营造和谐上网环境人人有责</p>
							<!-- <p class="tishis">直播已结束</p> -->
							<p id="msghistory">
								
							</p>
						</ul>
						<div class="footer">
							<div class="allgift">
								<ul class="gift-list">
									<li>
										<p><img src="{MODULE_URL}template/mobile/2/image/hongbao1.png"></p>
										<p>群发红包</p>
									</li>
									<li>
										<p><img src="{MODULE_URL}template/mobile/2/image/dashang.png"></p>
										<p>打赏主播</p>
									</li>
									{loop $gift $value}
									<li data-id="{$value['id']}">
										<p><img src="{$value['pic']}"></p>
										<p>{$value['name']}</p>
										<p><span class="moneynum">{php echo $value['amount']/100}</span>元</p>
									</li>
									{/loop}
									
								</ul>
								<!--数量加减-->
								<div class="zhuang">
									<div class="countes">数量</div>
									<div class="moneymag">
										<p class="jian" style="cursor: pointer;"><em class="iconfont jianicon">-</em></p>
										<input type="text" id="count" name="count" value="1" class="countKuang" readonly="">
										<input type="hidden" name="gift_id" value="" id="gift_id">
										<p class="jia" style="cursor: pointer;"><em class="iconfont jiaicon">+</em></p>
									</div>
									<div class="allmoney">合计:<span class="money"></span><button type="button" class="give">赠送</button></div>
								</div>
							</div>
							<!--底部-->
							<div class="footer-bar">
								<div class="footer-left">
									<a class="btnicont iconfont face" style="cursor: pointer;"></a>
									<input type="text" class="text-input" id="send_msg_text" placeholder="和大伙说点什么吧">
									<a class="btnicont gift iconfont" style="cursor: pointer;"></a>
								</div>
								<div class="footer-right">
									<!-- <a class="btnicont iconfont showfun" style="cursor: pointer;">&#xe612;</a> -->
									<!-- <a class="btn-sub">发送</a> -->
									<a id="mune" class="iconfont showfun" style="cursor: pointer;"></a>
								</div>
							</div>
							<!--表情-->
							<ul class="browlist">
	
							</ul>
							<ul class="showfunction">
								<li class="index-list">
									<a href="{php echo $this->createMobileUrl('index')}">
										<p>
											<i class="iconfont"></i>
										</p>
										<p>首页</p>
									</a>
								</li>
								<!-- <li>
									<p>
										<i class="iconfont"></i>
									</p>
									<p>图片</p>
									<input type="file" class="input-files" id="up" onchange="upimage();">
								</li> -->
								<li>
									<a href="{php echo $this->createMobileUrl('withdraw',array('rid' => $rid))}">
										<p>
											<i class="iconfont"></i>
										</p>
										<p>提现</p>
									</a>
								</li>
							</ul>
						</div>
						<!--禁言管理star-->
						<div class="function-all Bannedmages ">
								<div class="Banned-list">
									<span>全员禁言</span>
									 <span class="bannerdbtn" style="background-color: rgb(204, 204, 204);">
									  		<input type="checkbox" style="" id="allcheck">
									 	<em class="btn-movel">
									 	</em>
									 </span>
								</div>
								<!-- <div class="Banned-list">
									<span>禁止上传图片</span>
									 <span class="bannerdbtn checkbtn" style="background-color: rgb(204, 204, 204);">
									  		<input type="checkbox" style="" id="disimg">
									 	<em class="btn-movel">
									 	</em>
									 </span>
								</div> -->
								<div class="colose">
									关闭
								</div>
						</div>
						<!--功能展示star-->
						<!-- <div class="function-all">
							<div class="function-file">
								<div>
									<img src="{MODULE_URL}template/mobile/2/image/ico.png" />
									<section>
										<p>直播间名称</p>
										<p>创建人：林小酒</p>
									</section>
								</div>
								<div>
									<img src="{MODULE_URL}template/mobile/2/image/head.png" />
									<section>
										<p>林小酒</p>
										<p>当前主播</p>
									</section>
								</div>
							</div>
							<div class="function-live">
								<ul>
									<li class="collection-on">
										<i class="iconfont">&#xe625;</i>
										<p>收藏</p>
									</li>
									<li>
										<i class="iconfont">&#xe60f;</i>
										<p>关注</p>
									</li>
									<li>
										<i class="iconfont">&#xe627;</i>
										<p>直播介绍</p>
									</li>
									<li>
										<i class="iconfont">&#xe610;</i>
										<p>直播间</p>
									</li>
								</ul>
							</div>
						</div> -->
						<!--关注公众号-->
						<div class="focus-on-qz layui-m-anim-scale qrcode"><img src="{php echo tomedia($setting['attention_code'])}"><p>长按二维码关注公众号</p><p>"关注后可掌握直播最新动态哦"</p></div>
						<!--收藏-->
						<div class="collection">
							<img src="{MODULE_URL}template/mobile/2/image/collection.png">
						</div>
						<!--操作-->
						<div class="operation width640">
							<ul>
								<li id="shutup"></li>
								<li id="black"></li>
								<li class="opclose">关闭</li>
							</ul>
						</div>
					</div>
					<!--红包列表-->
					<div class="redlist width640 layui-m-anim-scale">
						<div class="masks"></div>
						<div class="overflow">
							<div class="redcenters width640 ovredlist">
							<div class="hiders">
								<div class="HeadTop">
									<i class="iconfont cose" id="redlistcose"></i>
								</div>
								<!--红包信息-->
								<div class="RedPack_Info">
									<div class="packimgs">
										<img src="{MODULE_URL}template/mobile/2/image/ico.png">
									</div>
									<p class="FromWho text_flow">的红包<i class="iconfont"></i></p>
									<p class="qm text_flow">恭喜发财，大吉大利！</p>
									<p class="qm text_flow rednull"></p>
								</div>
							</div>
							<ul class="alllist">
								<h5></h5>

							</ul>
						</div>
						</div>
					</div>
					<!--开-->
					<div class="open width640 layui-m-anim-scale">
						<div class="masks"></div>
						<div class="redcenters width640 ovredlist">
							<div class="hiders">
								<div class="open-red"></div>
								<div class="HeadTop">
								</div>
								<i class="iconfont cose" id="guan"></i>
								<!--红包信息-->
								<div class="RedPack_Info">
									<div class="packimgs">
										<img src="">
									</div>
									<p class="qm text_flow"></p>
									<p class="qm text_flow"></p>
									<p class="FromWho text_flow"></p>
								</div>
								<div class="openkai">
									<div class="openkais">
										開
									</div>
								</div>
							</div>
							<p class="text_flow mar10">查看大家的手气 &gt;</p>
						</div>
					</div>
					<!--全员禁言-->
					<div class="width640 Banned layui-m-anim-scale">
						<div class="mask"></div>
						<div class="redcenters">
							<h5>禁言列表</h5>
							<i class="iconfont cose"></i>
							<ul class="alllist shutuplist">
								
								
							</ul>
						</div>
					</div>
					<!--打赏红包-->
					{php $settings = iunserializer($dashangsetting['settings'])}
					<section class="redenvelope width640 layui-m-anim-scale">
						<div class="mask"></div>
						<div class="redcenters width640">
							<div class="hiders">
								<div class="HeadTop">
									<i class="iconfont cose"></i>
								</div>
								<!--红包信息-->
								<div class="RedPack_Info">
									<div class="packimgs">
										<img src="{MODULE_URL}template/mobile/2/image/ico.png">
									</div>
									<p class="FromWho text_flow">资料捏碎</p>
									<p class="qm text_flow">{$dashangsetting['content']}</p>
								</div>
							</div>
							<ul class="c-money">
								<li data-money="{$settings['one']}">
									<a href="javascript:;">
										<p>{$settings['remark1']}</p>
										<p>（{php echo ($settings['one']/100)}元）</p>
									</a>
								</li>
								<li data-money="{$settings['two']}">
									<a href="javascript:;">
										<p>{$settings['remark2']}</p>
										<p>（{php echo ($settings['two']/100)}元）</p>
									</a>
								</li>
								<li data-money="{$settings['three']}">
									<a href="javascript:;">
										<p>{$settings['remark3']}</p>
										<p>（{php echo ($settings['three']/100)}元）</p>
									</a>
								</li>
								<li data-money="{$settings['four']}">
									<a href="javascript:;">
										<p>{$settings['remark4']}</p>
										<p>（{php echo ($settings['four']/100)}元）</p>
									</a>
								</li>
								<li data-money="{$settings['five']}">
									<a href="javascript:;">
										<p>{$settings['remark5']}</p>
										<p>（{php echo ($settings['five']/100)}元）</p>
									</a>
								</li>
								<li data-money="{$settings['six']}">
									<a href="javascript:;">
										<p>{$settings['remark6']}</p>
										<p>（{php echo ($settings['six']/100)}元）</p>
									</a>
								</li>
							</ul>
							<p class="other-m">其他金额</p>
						</div>
	
						<div class="two-top width640 layui-m-anim-scale">
							<div class="masks"></div>
							<div class="dshang-m width640">
								<h1 class="ttitles font-s">其它金额 </h1>
								<div class="p-money">
									<span>金额(元)</span>
									<input type="number" name="money" id="othermoney" placeholder="0.01-1000之间">
								</div>
								<p class="ttitles t-btns"><button disabled="disabled" class="font-s">完成</button></p>
							</div>
						</div>
					</section>
					<!--右侧-->
					<ul class="cont-right" {if $value['type']=='3'} style="display:block;" {else} style="display:none;" {/if}>
						<a href="{php echo $this->createMobileUrl('index')}"><li><i class="iconfont">&#xe63d;</i></li></a>
						<li class="focus-onto"><i class="iconfont"></i></li>
						<!-- <a ><li><i class="iconfont icon-ding"></i></li></a> -->
						<a href="{php echo $this->createMobileUrl('invitation')}"><li><i class="iconfont"></i></li></a>
						<a href="javascript:;" onclick="window.location.reload();"><li><i class="iconfont"></i></li></a>
						<!-- <li class="functions"><i class="iconfont">&#xe628;</i></li> -->
						<!-- <div class="zan-box">
							<a class="zan-click" href="javascript:void(0);"><li class="zan"><i class="iconfont"></i><em class="zan-num">1483</em></li></a>
							<div class="love"></div>
						</div> -->
					</ul>
					<!-- <p class="history" onclick="history();">查看历史消息^</p> -->
					{elseif $value['type']=='2'}
						{php $settings = iunserializer($value['settings'])}
					<div class="showthisd {if $key !=0} hidediv {/if} minh">
						<div class="allconts">
							{$settings['content']}
						</div>
					</div>		
					{elseif $value['type']=='5'}
						{php $settings = iunserializer($value['settings'])}
					<div class="showthisd {if $key !=0} hidediv {/if} minh hidediv3">
						<div class="allconts rankpm">
							<div class="nav-box clearfix">
							{php $i=1;$j=count($settings['list']);}
							{loop $settings['list'] $kk $vv}
								{if $i==1}{php $rankid = $kk;}{/if}
								<p class="nav-btn{php echo $i} {if $i==$j} nav-btn7 {/if}{if $i==1} nav-select {else} nav-unselect {/if}" onclick="rank({$kk},{$j});">{$vv}</p>
							{php $i++;}
							{/loop}
								
							</div>
							<div class="totip">
								{php $i=1;$j=count($settings['list']);}
								{loop $settings['list'] $kk $vv}
								<ul id="rank{$kk}" {if $i!=1}style="display: none"{/if} class="rankcontent"></ul>
								{php $i++;}
								{/loop}
								
								
							</div>
						</div>
					</div>	
					{elseif $value['type']=='7'}
					<div class="showthisd {if $key !=0} hidediv {/if} minh">
						<div class="goods-box allconts">
						</div>
					</div>	
					{elseif $value['type']=='1'}
					{php $settings = iunserializer($value['settings'])}
					<div class="showthisd {if $key !=0} hidediv {/if} minh">
						<iframe src="{$settings['iframe']}" frameborder="no" marginheight="0" marginwidth="0" allowTransparency="true" style="overflow-y:auto"></iframe>
					</div>
					{elseif $value['type']=='4'}
					<div class="showthisd {if $key !=0} hidediv {/if} minh">
					暂无
					</div>
					{/if}
					{/loop}
								
								
				</section>
			</section>
			<div class="reading">
				<div class="stargrap"></div>
				<i class="iconfont readcolse"></i>
				<a href="">
					<img src="{MODULE_URL}template/mobile/2/image/111.jpg">
				</a>

			</div>
		</div>

		<!--红包层-->
		<style>
			.sendredbagwin {
				position: fixed !important;
				bottom: 0;
				width: 100%;
				height: 100%;
				margin: auto;
				left: 0;
				right: 0;
				z-index: 10;
				display: none;
			}
			
			.redbagmask {
				position: fixed;
				background-color: rgba(0, 0, 0, .5);
				width: 100%;
				height: 100%;
				z-index: 11;
			}
			
			.sendredbagwinmain {
				position: fixed;
				margin: auto;
				max-width: 640px;
				left: 0;
				right: 0;
				bottom: 0;
				z-index: 12;
				background-color: rgb(255, 245, 245);
				height: 365px;
			}
			.sendredbagwin .inputs{
				vertical-align: middle !important;
				margin-bottom: 0 !important;
				padding: 4px 2px !important;
			}
			.fl {
				float: left;
			}
			
			.fr {
				float: right;
			}
			
			.clearfix:after {
				content: "";
				display: block;
				clear: both;
			}
			/*发红包*/
			
			.main-wrap {
				padding: 1rem;
				font-size: 1.4rem;
			}
			
			.sendredbagwin li {
				margin-top: 1rem;
				width: 100%;
			}
			
			.sendredbagwin .line span {
				display: block;
				font-size: 15px;
			}
			
			.sendredbagwin .line {
				padding: 0rem 1rem;
				background-color: #fff;
				margin-top: 1rem;
				height: 42px;
				margin: 21px 0px;
				line-height: 40px;
			}
					.sendredbagwin	input::-webkit-input-placeholder { /* WebKit browsers */
			  vertical-align: middle;
			  padding: 6px 0px;
			}
			
			.sendredbagwin .inputbox {
				margin-right: .5rem;
				height: 3rem;
				text-align: right;
				border: 0;
				margin-bottom: 0px;
				padding: 12px 2px;
				
			}
			
			.sendredbagwin .redtype {
				font-size: 1.2rem;
				padding-left: 1rem;
			}
			
			.sendredbagwin em {
				color: #31ac84;
				cursor: pointer;
				font-style: normal;
			}
			
			.sendredbagwin .remark {
				resize: none;
			}
			
			.sendredbagwin .redmoney {}
			
			.sendredbagwin .livebtn {
				border: 0;
				color: #fff;
				width: 100%;
				height: 3.5rem;
				line-height: 3.5rem;
				font-size: 1.6rem;
				border-radius: .5rem;
				text-align: center;
				cursor: pointer;
				display: block;
				cursor: pointer;
				font-family: 14/1 "微软雅黑";
			}
			
			.sendredbagwinmain ul li:last-child {
				margin-top: 17px;
			}
			
			.sendredbagwinmain input::-webkit-input-placeholder,
			textarea::-webkit-input-placeholder {
				color: #d8d8d8;
				font: 14px/1 微软雅黑 !important;
				line-height: 21px;
			}
			
			.livebtn.red {
				background-color: #d84e43;
			}
			
			.livebtn.red[disabled] {
				background-color: rgba(216, 78, 67, .7);
				color: (255, 255, 255, 0.81);
				font: 14px/1 微软雅黑 !important;
				font-family: 14/1 "微软雅黑";
			}
			
			.vcenter {
				/* -webkit-box-pack: center; */
				-moz-box-pack: center;
				-ms-flex-align: center;
				/* IE 10 */
				-webkit-align-items: center;
				-moz-align-items: center;
				/* align-items: center; */
			}
			
			.livebtn.blue {
				background-color: rgba(0, 172, 255, .5);
			}
			
			.totalmoney i {
				font-size: 1.2rem;
				font-size: 17px;
				color: #31ac84;
				font-style: normal;
				padding: .1rem .1rem .2rem .1rem;
				margin-left: .3rem;
			}
			
			#msg-tipbar {
				height: 3rem;
				line-height: 3rem;
				text-align: center;
				background-color: #E64340;
				color: #fff;
				width: 100%;
				left: 0;
				top: 0;
				display: none;
			}
			
			.d-flex {
				display: -webkit-box;
				display: -webkit-flex;
				display: -ms-flexbox;
				display: flex;
			}
			
			.flex {
				-webkit-box-flex: 1;
				-webkit-flex: 1;
				-ms-flex: 1;
				flex: 1;
			}
			
			@-webkit-keyframes layui-m-anim-scale {
				0% {
					opacity: 0;
					-webkit-transform: scale(.5);
					transform: scale(.5);
				}
				100% {
					opacity: 1;
					-webkit-transform: scale(1);
					transform: scale(1);
				}
			}
			
			@keyframes layui-m-anim-scale {
				0% {
					opacity: 0;
					-webkit-transform: scale(.5);
					transform: scale(.5);
				}
				100% {
					opacity: 1;
					-webkit-transform: scale(1);
					transform: scale(1);
				}
			}
			
			.layui-m-anim-scale {
				animation-name: layui-m-anim-scale;
				-webkit-animation-name: layui-m-anim-scale;
				animation-duration: .2s;
				-webkit-animation-duration: .2s;
				animation-fill-mode: both;
				-webkit-animation-fill-mode: both;
			}
			
			.min_tips_box .bg {
				position: fixed;
				z-index: 1005;
				left: 0;
				top: 0;
				content: "";
				width: 100%;
				height: 100%;
				background: #000000;
				opacity: 0.3;
				filter: alpha(opacity=5);
			}
			
			.min_tips_box .tips_content {
				position: fixed;
				z-index: 1006;
				max-width: 80%;
				min-width: 10rem;
				line-height: 2rem;
				margin-top: -2.3rem;
				margin-left: -50%;
				padding: 1.2rem 1rem;
				left: 50%;
				top: 50%;
				background: #000000;
				border-radius: 5px;
				text-align: center;
				color: #fff;
				box-shadow: 0 0 5px #000000;
				word-break: break-all;
			}
			
		</style>
		<div class="sendredbagwin" style="display: none;">
			<div class="redbagmask" style="cursor:pointer;"></div>
			<div class="sendredbagwinmain layui-m-anim-scale">
				<div id="msg-tipbar">
				</div>
				<ul style=" padding: 0 1rem 1rem 1rem;">
					<li class="d-flex line vcenter">
						<span>红包个数</span>
						<input type="tel" placeholder="填写个数" class="flex inputbox" id="bagAmount" min="0">
						<span>个</span>
					</li>
					<li class="d-flex line vcenter">
						<span class="totalmoney">总金额<i class="iconfont"></i></span>
						<input type="number" placeholder="填写金额" class="flex inputbox inputs" id="bagMoney" min="0">
						<span>元</span>
					</li>
					<li class="redtype">
						<div class="clearfix">
							<div class="fl">
								<span class="typemsg">金额随机</span>，
								<em id="changeRedType">改为普通红包</em>
							</div>
							<div class="fr redmoney">
								<!-- ￥<span class="bag-money-show">0.00</span><span class="service-money">+<em></em>(2%手续费)</span> -->
								￥<span class="bag-money-show">0.00</span><span class="service-money"><em></em></span>
							</div>
						</div>

					</li>
					<li class="d-flex line vcenter">
						<span>留言</span>
						<input type="text" class="flex remark inputbox" id="bagMessage" placeholder="恭喜发财！">
					</li>
					<li>
						<input type="button" disabled="disabled" class="livebtn red" id="btnSendRedBag" value="塞钱进红包">
					</li>
					<li>
						<a href="javascript:;" class="livebtn blue btn-cancel">取消</a>
					</li>
				</ul>

			</div>
		</div>
		<script type="text/javascript" src="{MODULE_URL}template/mobile/2/js/jquery-2.1.4.min.js"></script>
		<script type="text/javascript" src="{MODULE_URL}template/mobile/2/js/fastclick.js"></script>
		<script type="text/javascript">FastClick.attach(document.body);</script>
		<script type="text/javascript" src="{MODULE_URL}template/mobile/2/js/mui.min.js"></script>
		<!-- <script type="text/javascript" src="{MODULE_URL}template/mobile/2/js/webim.js"></script> -->
		<script type="text/javascript" src="{MODULE_URL}template/mobile/2/js/demo_base.js"></script>
		<!--<script type="text/javascript" src="{MODULE_URL}template/mobile/2/js/dropload/dropload1.js"></script>-->
		<script type="text/javascript" src="{MODULE_URL}template/mobile/2/js/ady.js?v=1"></script>
		<script type="text/javascript" src="{MODULE_URL}template/mobile/2/js/swiper-3.3.1.jquery.min.js"></script>
		{if $item['theme']}
		<script type="text/javascript">
			// 广告轮播
			var mySwiper = new Swiper ('.swiper-container', {
			    // 如果需要分页器
			    pagination: '.swiper-pagination',
			    loop : true,
			  })
			setInterval("mySwiper.slideNext()", 4000);
		</script>		
		{/if}
		<script>
			$(function() {
				if(getCookie('qrshow'+loginInfo.tid)!=1)
					{
						if('1'=='1')
						{
						  if ('0'=='0') {
							  $('.grap').show();	
						      $('.qrcode').html('<span class = "focus-on-click">+</span><img src="{php echo tomedia($setting['attention_code'])}"/><p>长按二维码关注公众号</p><p>"关注后可掌握直播最新动态哦"</p>');
						      $('.qrcode').show();
						      setCookie('qrshow'+loginInfo.tid,1,3);
					       }
						}
					  
					}
					var liveurl = "{$list['settings']['rtmp']}";
					var livehttp = "{$list['settings']['hls']}";
					var linum = $(".TAstate li").length;
					if (linum==1) {
						$(".TAstate li").width("100%");
					}else if(linum==2){
						$(".TAstate li").width("50%");
					}else if(linum==3){
						$(".TAstate li").width("33%");
					}else if(linum==4){
						$(".TAstate li").width("25%");
					}else if(linum==5){
						$(".TAstate li").width("20%");
					}
					var ranknum = $(".rankpm div p").length;
					if (ranknum==1) {
						$(".rankpm div p").width("100%");
					}else if(ranknum==2){
						$(".rankpm div p").width("50%");
					}else if(ranknum==3){
						$(".rankpm div p").width("33%");
					}else if(ranknum==4){
						$(".rankpm div p").width("25%");
					}
		    wx.config({
		        debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
		        appId: "{$_W['account']['jssdkconfig']['appId']}",
		        timestamp: "{$_W['account']['jssdkconfig']['timestamp']}",
		        nonceStr: "{$_W['account']['jssdkconfig']['nonceStr']}",
		        signature: "{$_W['account']['jssdkconfig']['signature']}",
		        jsApiList: ['getLocation','onMenuShareAppMessage','onMenuShareTimeline','hideMenuItems','previewImage'] // 必填，需要使用的JS接口列表，所有JS接口列表见附录2
		    });
		    wx.ready(function(){
		      wx.onMenuShareAppMessage({
		          title: "{$setting['share_title']}",
		          desc: "{$setting['share_desc']}",
		          link: "{php echo $_W['siteroot'].str_replace('./','app/',$this->createMobileurl('index2',array('share_uid' => $uid,'rid'=>$rid)))}",
		          imgUrl: "{php echo $_W['attachurl'].$setting['share_img']}",
		          success: function () { 

		          },
		          cancel: function () { 
		          }
		      });
		      wx.onMenuShareTimeline({
		          title: "{$setting['share_title']}",
				  desc: "{$setting['share_desc']}",
				  link:"{php echo $_W['siteroot'].str_replace('./','app/',$this->createMobileurl('index2',array('share_uid' => $uid,'rid'=>$rid)))}",
				  imgUrl: "{php echo $_W['attachurl'].$setting['share_img']}",
		          success: function () {
		        
		          },
		          cancel: function () { 
		          }
		      });
		      wx.hideMenuItems({
		          menuList: [
		              'menuItem:readMode', 
		              'menuItem:openWithSafari',
		              'menuItem:copyUrl',
		              'menuItem:exposeArticle',
		              'menuItem:share:qq',
		              'menuItem:profile',
		              'menuItem:addContact',
		              'menuItem:share:QZone',
		          ]
		      });
		      $('body').on('click', '.char_message>img', function(event) {
		      	event.preventDefault();

			      	var imgArray = [];
			      	var thisimg = $(this).attr('src');
			      	$('.char_message>img').each(function(index, el) {
			      		var itemSrc = $(this).attr('src');
		            	imgArray.push(itemSrc);
			      	});
			      	// alert(thisimg);
			      	wx.previewImage({
				      current: thisimg,
				      urls: imgArray
				    });	      		
		      });
			      
		      });

function isWX() {
    var u = navigator.userAgent, app = navigator.appVersion;
    return u.indexOf("MicroMessenger") > -1;
}



                var founder = {
                    uid:"",
                    nickname:"",
                    headurl:""
                }


				var tid='2201';

				var minMoney = 0.01; //每人最小金额1元
				var zbRedBag = {
					randomBtn: '改为拼手气红包',
					fixedBtn: '改为普通红包',
					randomText: '金额随机',
					fixedText: '金额固定',
					bagMessage: '恭喜发财！',
					msg1: '至少需要设置1个红包',
					msg2: '平均每人不能少于' + minMoney + '元'

				};
				var msgbar = $("#msg-tipbar");
				var bag_money_show = $(".bag-money-show");

				var pd = {
					bagAmount: 0,
					bagMoney: 0,
					bagType: 1, //1随机，默认  2固定
					bagMessage: zbRedBag.bagMessage,
					bagServiceMoney: 0, //平台服务费0%
				};
				var red = {
					redid:0,
					redtitle:'恭喜发财',
					toredName:'',
					toredHead:'',
					redMoney:0,
					rednum:0
				};
				var personal = {
					uid:0,
					nickname:'',
					headurl:''
				}
				//聊天框
				$(document).on('click', '.chat_title', function(event) {
					event.preventDefault();
					$(".allgift").slideUp('fast');
					$(".browlist").slideUp('fast');
					$(".showfunction").slideUp('fast');
					hideflag = true;
					//表情
				}).on('click', '.face', function(event) {
					event.preventDefault();
					$('.grap').hide();
					if(hideflag) {
						$(".browlist").slideDown('fast');
						hideflag = false;
					} else {
						if($('.showfunction').css('display') == 'block' || $('.allgift').css('display') == 'block') {
							$(".allgift").slideUp('fast');
							$(".showfunction").slideUp('fast');
							$(".browlist").slideDown('fast');
							hideflag = false;
						} else {
							$(".browlist").slideUp('fast');
							hideflag = true;
						}
					}
					//加号
				}).on('click', '.showfun', function(event) {
					event.preventDefault();
					$('.grap').hide();
					if(hideflag) {
						$('.showfunction').slideDown('fast');
						hideflag = false;
					} else {
						if($('.allgift').css('display') == 'block' || $('.browlist').css('display') == 'block') {
							$(".allgift").slideUp('fast');
							$(".browlist").slideUp('fast');
							$('.showfunction').slideDown('fast');
							hideflag = false;
						} else {
							$('.showfunction').slideUp('fast');
							hideflag = true;
						}
					}
					//礼物
				}).on('click', '.gift', function(event) {
					event.preventDefault();
					$('.grap').show().css("z-index", "4");
					$('.gift-list li').each(function(index, el) {
						if($(this).hasClass('select')) {
							var summoney = $('.countKuang').val() * parseInt($(this).find('.moneynum').html());
							
							$('.money').html('￥' + summoney);
						} else {
							$('.countKuang').val('1');
						}
					});
					if(hideflag) {
						$(".allgift").slideDown('fast');
						hideflag = false;
					} else {
						if($('.browlist').css('display') == 'block' || $('.showfunction').css('display') == 'block') {
							$(".browlist").slideUp('fast');
							$('.showfunction').slideUp('fast');
							$(".allgift").slideDown('fast');
							hideflag = false;
						} else {
							$(".allgift").slideUp('fast');
							$('.grap').hide();
							hideflag = true;
						}
					}
					//获得焦点
				}).on('focus', '.text-input', function(event) {
					loginInfo.pop=1;
					event.preventDefault();
					if ($(this).val().length >= 1 ) {
						$("#mune").empty().removeClass('iconfont showfun').addClass('btn-sub').html('发送');
					};
					$(".allgift").slideUp('fast');
					$(".browlist").slideUp('fast');
					$(".show").slideUp('fast');
					$(".showfunction").slideUp('fast');
					$(".grap").slideUp('fast');
					hideflag = true;
				//发送消息按钮
				}).on('click', '.btn-sub', function(event) {
					event.preventDefault();
					if ($('.text-input').val().length == 0 || $('.text-input').val().match(/^\s+$/g)) {
						$(document).minTipsBox({
							tipsContent: '请输入内容',
							tipsTime: 1
						});
						$('.text-input').val('');
					}else{
						if(('a'+$('.text-input').val()).indexOf('http://')>0)
                       {
                       	$(document).minTipsBox({
							tipsContent: '不能发送超链接',
							tipsTime: 1
						});
						$('.text-input').val('');
						return false;
                       }
						//alert($('.text-input').val());
						onSendMsg("{php echo $this->createMobileurl('addcomment',array('rid'=>$rid))}");
					}
				//失去焦点
				}).on('blur', '.text-input', function(event) {
					loginInfo.pop=1;
					event.preventDefault();
					if($('.text-input').val() == '') {
						$('.btn-sub').one('click', function(e) {
							e.preventDefault();
							if ($.trim($('.text-input').val()) === '') {
								$(document).minTipsBox({
									tipsContent: '请输入内容',
									tipsTime: 1
								});
								return false;
							}
						});
						$("#mune").empty().removeClass('btn-sub').addClass('iconfont showfun').html('&#xe63b;');
					}
				//礼物列表
				}).on('click', '.gift-list li', function(event) {
					event.preventDefault();
					var $this = $(this);
					var item = $this.index();
					$this.addClass("select").siblings().removeClass("select");
					
					if(item < 2) {
						//群红包
						if(item == 0) {
							$(".sendredbagwin").show();
						} else {
                            //将主播信息赋值
                            personal.uid = founder.uid;
                            personal.nickname = founder.nickname;
                            personal.headurl = founder.headurl;
                            $('.redenvelope .RedPack_Info').find('.packimgs').children('img').attr('src',personal.headurl);
                            $('.redenvelope .RedPack_Info').find('p').eq(0).html(personal.nickname);
							//主播红包
							$(".redenvelope").show();
						}
						$(".zhuang").slideUp('fast');
						$(".allgift").slideUp('fast');
						hideflag = true;
					} else {
						//var onemoney = parseInt($this.find('.moneynum').html());
						var onemoney = ($this.find('.moneynum').html());
						
						$('#gift_id').val($this.attr('data-id'));
						$('.countKuang').val(1);
						$(".zhuang").slideDown('fast');
						$('.money').html('￥' + onemoney);
					}
					//加
				}).on('click', '.jia', function(event) {
					var num = $('.countKuang').val();
					$('.countKuang').val(++num);
					$('.gift-list li').each(function(index, el) {
						if($(this).hasClass('select')) {
							var thismoney = parseInt($(this).find('.moneynum').html());
							//var thismoney = ($(this).find('.moneynum').html());
							$('.money').html('￥' + thismoney * num);
						}
					});
					//减
				}).on('click', '.jian', function(event) {
					var num = $('.countKuang').val();
					--num;
					if(num < 2) {
						num = 1;
						$('.countKuang').val(num);
					} else {
						$('.countKuang').val(num);
					}
					$('.countKuang').val(num);
					$('.gift-list li').each(function(index, el) {
						if($(this).hasClass('select')) {
							var thismoney = parseInt($(this).find('.moneynum').html());
							var thismoney = ($(this).find('.moneynum').html());
							$('.money').html('￥' + thismoney * num);
						}
					});
					//更多
				}).on('click', '.functions', function(event) {
					event.preventDefault();
					$(".grap").toggle().css("z-index", "5");
					$(".function-all").slideDown('fast');
					//红包个数
				}).on("input", "#bagAmount", function() {
					calc();
					//总金额
				}).on("input", "#bagMoney", function() {
					calc();
					//留言
				}).on("input", "#bagMessage", function() {
					var _val = $(this).val();
					if(_val.length > 25) {
						$(this).val(_val.substring(0, 25));
					}
					calc();
					//群红包类型
				}).on("click", "#changeRedType", function() {
					pd.bagType = pd.bagType == 1 ? 2 : 1;
					if(pd.bagType == 1) {
						$(".redtype .typemsg").html(zbRedBag.randomText);
						$("#changeRedType").html(zbRedBag.fixedBtn);
						// $(".totalmoney i").show();
						$(".totalmoney").html('总金额<i class="iconfont">&#xe631;</i>');
						calc();
					} else if(pd.bagType == 2) {
						$(".redtype .typemsg").html(zbRedBag.fixedText);
						$("#changeRedType").html(zbRedBag.randomBtn);
						// $(".totalmoney i").hide();
						$(".totalmoney").html('单个金额');
						calc();
					}
					//群红包遮罩
				}).on("click", ".redbagmask", function() {
					$(".sendredbagwin").hide();
					$('.grap').hide();
					//群红包取消
				}).on("click", ".btn-cancel", function() {
					$(".sendredbagwin").hide();
					$('.grap').hide();
					//群红包确认支付
				}).on("click", "#btnSendRedBag", function() {
					calc();
					var ispost = false;
					if(!ispost) {
						pd.bagMessage = $("#bagMessage").val() || $("#bagMessage").attr("placeholder");
						var dbjson = {
							topicId: tid || 0, //话题id
							total_fee: pd.bagMoney, //金额
							byUserId: 1015310, //用户id
							rtype: pd.bagType, //红包类型
							focus: 0,
							nums: pd.bagAmount, //红包数量
							note: pd.bagMessage //红包留言
						};

						ispost = true;

						$.ajax({
							type: "POST",
							url: "{php echo $this->createMobileUrl('setpacket',array('rid' => $rid))}",
							data: dbjson,
							dataType: 'json',
							success: function(result) {
							
								console.log(result.isweixin);
								if(result.s == 1 && result.isweixin == 1) {
									callPay(result.msg, dbjson);
								} else if(result.isweixin == 0) {
									$(document).minTipsBox({
										tipsContent: result.tip,
										tipsTime: 1
									});
								} else {
									$(document).minTipsBox({
										tipsContent: result.msg || result.tip,
										tipsTime: 1
									});
								}
							},
							error: function() {
								ispost = false;
								$(document).minTipsBox({
									tipsContent: 'error',
									tipsTime: 1
								});
							}
						});
					}
				//单个红包(列表)
				}).on('click', '.chat_left .iconfont', function(event) {
					personal.uid = $(this).attr('value').split('_')[1];
					personal.nickname = $(this).parents('.chat_left').next().find('.char_name').html().split('<span')[0];
					personal.headurl = $(this).prev().children('img').attr('src');
					$('.redenvelope .RedPack_Info').find('.packimgs').children('img').attr('src',personal.headurl);
					$('.redenvelope .RedPack_Info').find('p').eq(0).html(personal.nickname);
					$(".mask").show();
					$(".redenvelope").show();
				//红包遮罩层关闭
				}).on('click', '.mask', function(event) {
					$(".redenvelope").hide();
					$(".Banned").hide();
					$(".grap").hide();
				//单人红包关闭
				}).on('click', '.cose', function(event) {
					$(".redenvelope").hide();
				//禁言管理关闭
				}).on('click', '.colose', function(event) {
					$(".Bannedmages").hide();
					$(".showfunction").slideUp('fast');
					$(".grap").hide();
					hideflag = true;
				//其他金额弹出
				}).on('click', '.other-m', function(event) {
					$(".two-top").show();
				//其他金额遮罩层关闭
				}).on('click', '.masks', function(event) {
					$(".two-top").hide();
					$('.redlist').hide();
				//头像点击底部向上滑动(拉黑、禁言)
				}).on('click', '.clickhead', function(event) {
					event.preventDefault();
					var user=$(this).attr('user');
					var username=$(this).attr("username");
					$.ajax({
						type: "POST",
						url: "{php echo $this->createMobileUrl('getshut',array('rid' => $rid))}",
						dataType: 'json',
						success: function(result) {
							var ShuttedUinList = result.msg;
							console.log(ShuttedUinList);
							console.log(user);
							console.log(ShuttedUinList.indexOf('"'+user+'"'));
							if(ShuttedUinList.indexOf('"'+user+'"')>0){
								  $('#shutup').attr('onclick','cancelshutup("{php echo $this->createMobileUrl('setshut',array('rid' => $rid,'type'=>2))}","'+user+'","'+username+'")');
								  $('#shutup').html('取消禁言');
							}else{
								  $('#shutup').attr('onclick','shutup("{php echo $this->createMobileUrl('setshut',array('rid' => $rid,'type'=>1))}","'+user+'","'+username+'")');
								  $('#shutup').html('禁言');
							}
						},
						error: function() {
							ispost = false;
							$(document).minTipsBox({
								tipsContent: 'error',
								tipsTime: 1
							});
						}
					});
					
					$('#black').attr('onclick','black("'+user+'")');
					$('#black').html('拉黑');
      				$(".grap").show();
					$(".operation").slideDown('fast');
				//关闭底部
				}).on('click', '.opclose', function(event) {
					$(".grap").hide();
					$(".operation").slideUp('fast');
				//最外遮罩层关闭事件
				}).on('click', '.grap', function(event) {
					$('.Banned').hide();
					$(".function-all").slideUp('fast');
					$(".showfunction").slideUp('fast');
					$(".focus-on").hide();
					$(".collection").hide();
					$(".operation").slideUp('fast');
					$('.Banned').hide();
					$(this).removeClass("graps").hide();
					$(".allgift").slideUp('fast');
					hideflag = true;
				//公众号关注弹出
				}).on('click', '.focus-onto', function(event) {
					$(".grap").toggle().css("z-index","5");
					$(".focus-on").toggle();
					$('.qrcode').html('<span class = "focus-on-click">+</span><img src="{php echo tomedia($setting['attention_code'])}"/><p>长按二维码关注公众号</p><p>"关注后可掌握直播最新动态哦"</p>');     
					$('.qrcode').show();
				//公众号关注关闭
				}).on('click','.focus-on-click',function(){
					$(".grap").toggle().css("z-index","5");
					$(".focus-on").toggle();
				//消息取消、撤回
				}).on('click', '.close', function(event) {
					$(this).parents("li").remove();
	
					var str=$(this).parents(".char_message").html().split('<div class="send">');
					if(str[0]!='')
					{
						$.ajax({
                        type: "POST",
                        url: "./deletemsg",
                        data: {tid:loginInfo.tid,msg:str[0],uid:loginInfo.uid},
                        dataType: "json",
                        success: function(data) {
                        },
                        error: function(XMLHttpRequest, textStatus, errorThrown) {
                           
                        }
                    });
					}
					 
					//sendclose($(this).parents("li")[0].id.replace('seq',''));
				//收藏
				}).on('click', '.function-live ul li', function(event) {
					var item = $(this).index();
					if (item == 0) {
						$(".grap").show().addClass("graps");
						$(".collection").toggle();
					}else if(item == 3){
						
					}else if(item == 1){
						$(".grap").show();
						$(".focus-on").show();
						$(".function-all").slideUp('fast');
					}
				}).on('input', '.text-input', function(event) {
					event.preventDefault();
					if ($(this).val().length >= 1) {
						$("#mune").empty().removeClass('iconfont showfun').addClass('btn-sub').html('发送');
					}else{
						$("#mune").empty().removeClass('btn-sub').addClass('iconfont showfun').html('&#xe63b;');
					}
				//点击红包(显示)
				}).on('click', '.red_message,.lookred', function(event) {
					event.preventDefault();
					var $this = $(this);
					$('.redlist').find('.alllist').children('h5').nextAll().remove();
					if ($this.hasClass('red_message')) {
						red.redid = $this.find('.red-red').attr('value');
						red.toredName = $this.prev().attr('username');
						red.toredHead = $this.parents('.redbao').find('.head_portrait').children('img').attr('src');
					}else if($this.hasClass('lookred')){
						red.redid = $this.attr('value');
					}
					if (red.redid > 0) {
						$.ajax({
							url: "{php echo $this->createMobileUrl('checkpacket',array('rid' => $rid))}",
							type: 'POST',
							dataType: 'json',
							data: {sendid: red.redid},
							success:function(json){
								if(json.status==-1)
								{
							        $(document).minTipsBox({
									tipsContent: json.msg,
									tipsTime: 1
								});
								    return false;
							     }
								red.redtitle = json.redinfo.title;
								red.redtype = json.redinfo.type==1?'随机':'固定';
								red.redMoney = json.redinfo.money;
								red.rednum = json.redinfo.num;
							
								if ($this.hasClass('lookred')) {
									red.toredName = json.redinfo.nickname;
									red.toredHead = json.redinfo.headurl;
								};
								if(json.status==-2)
								{
							        $('.open').find('.packimgs').children('img').attr('src',red.toredHead);
									$('.open').find('.RedPack_Info').children('p').eq(0).html(red.toredName);
									$('.open').find('.openkai').hide();
									$('.open').find('.RedPack_Info').children('p').eq(2).html('该红包已过期');
									$('.open').show();
								    return false;
							     }
								else if (json.status == 0) 
								{
									$('.open').show();
									$('.open').find('.packimgs').children('img').attr('src',red.toredHead);
									$('.open').find('.RedPack_Info').children('p').eq(0).html(red.toredName);
									$('.open').find('.RedPack_Info').children('p').eq(1).html('发了一个红包，金额'+red.redtype+'');
									$('.open').find('.openkai').hide();
									$('.open').find('.RedPack_Info').children('p').eq(2).html('手慢了,红包派完了');	
								}
								else if(json.status==1)
								{
									$('.open').show();
									$('.open').find('.packimgs').children('img').attr('src',red.toredHead);
									$('.open').find('.RedPack_Info').children('p').eq(0).html(red.toredName);
									$('.open').find('.RedPack_Info').children('p').eq(1).html('发了一个红包，金额'+red.redtype+'');
									loginInfo.red=1;
									$('.open').find('.openkai').show();
									$('.open').find('.RedPack_Info').children('p').eq(2).html(red.redtitle);
								}
								else{
									$('.open').hide();
									$('.redlist').show();
									$('.redlist').find('.alllist').children('h5').nextAll().remove();
									$('.redlist').find('.packimgs').children('img').attr('src',red.toredHead);
									var type = red.redtype==1?'<i class="iconfont">&#xe631;</i>':'';
									$('.redlist').find('.RedPack_Info').children('p').eq(0).html(red.toredName+'的红包'+type);
									$('.redlist').find('.RedPack_Info').children('p').eq(1).html(red.redtitle);
									// $('.redlist').find('.RedPack_Info').children('p').eq(2).html();
									$('.redlist').find('.alllist').children('h5').html(red.rednum+'个红包,共'+(red.redMoney/100)+'元');
									var str = '';
									if (json.redlist.length > 0) {
										$.each(json.redlist,function(index, value) {
											if (value.uid == loginInfo.uid) {
												$('.redlist').find('.RedPack_Info').children('p').eq(2).html((value.amount/100)+'元');
											}
											var start = new Date(value.dateline * 1000);
											var times = (start.getMonth() + 1) + '-' + start.getDate() + ' ' + (start.getHours() < 10 ? '0' + start.getHours() : start.getHours()) + ':' + (start.getMinutes() < 10 ? '0' + start.getMinutes() : start.getMinutes());
											str+='<li><img src="'+value.headimgurl+'"><div><p>'+value.nickname+'</p><p>'+times+'</p></div><span>'+(value.amount/100)+'元</span></li>';
										});
										$('.redlist').find('.alllist').children('h5').after(str);
									}
								}
							},
							error:function(){
								$(document).minTipsBox({
									tipsContent: 'error',
									tipsTime: 1
								});
							}
						});
					}else{
						$(document).minTipsBox({
							tipsContent: 'error',
							tipsTime: 1
						});
					}
				}).on('click', '.redcenters .cose', function(event) {
					$('.Banned').hide();
					$('.grap').removeClass("graps").hide();
				});
				$(document).on('focus', '#up', function(event) {
					event.preventDefault();
					loginInfo.pop=1;
				}).on('blur', '#up', function(event) {
					event.preventDefault();
					loginInfo.pop=1;
				});;
				// $('.text-input').on('keydown', function(event) {
				// 	event.preventDefault();
				// 	if (event.keyCode == 13) {
				// 		onSendMsg();
				// 	}else{
				// 		return;
				// 	}
				// })
				$(".text-input").keyup(function(event){
			        if(event.keyCode == 13){
			        	if ($('.text-input').val().length == 0 || $('.text-input').val().match(/^\s+$/g)) {
							$(document).minTipsBox({
								tipsContent: '请输入内容',
								tipsTime: 1
							});
							$('.text-input').val('');
						}else{
							//alert($('.text-input').val());
							onSendMsg();
						}
			        }
			    });
               
               $("#allcheck").change(function(){
               	
               	if ($("#allcheck").prop('checked')==true) {
               		allshutup(1);
               	}
               	else
               	{
               		allshutup(0);
               	}
               });
               $("#disimg").change(function(){
               	
               	if ($("#disimg").prop('checked')==true) {
               		disimg(0);
               	}
               	else
               	{
               		disimg(1);
               	}
               });
				//红包(关)
				$('.main').on('click', '#guan', function(event) {
					$('.open').hide();
				//红包开
				}).on('click', '.openkai', function(event) {
					if(loginInfo.red!=1)
						{
							return false;
						}
						loginInfo.red=0;
					$(this).addClass('rey');
					$('.redlist').find('.alllist').children('h5').nextAll().remove();
					var type = red.redtype==1?'<i class="iconfont">&#xe631;</i>':'';
					$('.redlist').find('.packimgs').children('img').attr('src',red.toredHead);
					$('.redlist').find('.RedPack_Info').children('p').eq(0).html(red.toredName+'的红包'+type);
					$('.redlist').find('.RedPack_Info').children('p').eq(1).html(red.redtitle);
					$('.redlist').find('.alllist').children('h5').html(red.rednum+'个红包,共'+(red.redMoney/100)+'元');
					if (red.redid > 0) {
						$.ajax({
							url: "{php echo $this->createMobileUrl('getpacket',array('rid' => $rid))}",
							type: 'POST',
							dataType: 'json',
							data: {sendid: red.redid},
							success:function(json){
								var str = '';
								if(json.status==-2)
								{
									$('.open').find('.RedPack_Info').children('p').eq(2).html('该红包已过期');
									$('.openkai').hide();
								}
								else if(json.status==-1)
								{
								  	 $(document).minTipsBox({
									tipsContent: '出错了',
									tipsTime: 1
								});
								    return false;
								}
								else if(json.status==0)
								{
                                    $('.open').show();
									$('.open').find('.openkai').hide();
									$('.open').find('.RedPack_Info').children('p').eq(2).html('手慢了,红包派完了');	
								}
								else if(json.status==2)
								{
									if (json.redlist.length > 0) {
										$.each(json.redlist,function(index, value) {
											
											if (value.uid == loginInfo.uid) {
												$('.redlist').find('.RedPack_Info').children('p').eq(2).html((value.amount/100)+'元');
											}
											var start = new Date(value.dateline * 1000);
											var times = (start.getMonth() + 1) + '-' + start.getDate() + ' ' + (start.getHours() < 10 ? '0' + start.getHours() : start.getHours()) + ':' + (start.getMinutes() < 10 ? '0' + start.getMinutes() : start.getMinutes()) ;
											str+='<li><img src="'+value.headimgurl+'"><div><p>'+value.nickname+'</p><p>'+times+'</p></div><span>'+(value.amount/100)+'元</span></li>';
										});
										$('.redlist').find('.alllist').children('h5').after(str);
									}
								$('.open').hide();	
								$('.redlist').show();
								}

								$('.openkai').removeClass('rey');
								
							},
							error:function(){
								$(document).minTipsBox({
									tipsContent: 'error',
									tipsTime: 1
								});
							}
						});
					}else{
						$(document).minTipsBox({
							tipsContent: 'error',
							tipsTime: 1
						});
					}
					
				//关闭抢红包列表
				}).on('click', '#redlistcose', function(event) {
					$('.redlist').hide();
				}).on('click', '.mar10', function(event) {
					event.preventDefault();
					$('.open').hide();
					$('.redlist').show();
				//查看红包领取情况(查看而已)
				}).on('click', '.mar10', function(event) {
					event.preventDefault();
					$('.rednull').html('');
					$('.open').hide();
					$('.redlist').show();
					$('.redlist').find('.alllist').children('h5').nextAll().remove();
					$('.redlist').find('.packimgs').children('img').attr('src',red.toredHead);
					var type = red.redtype==1?'<i class="iconfont">&#xe631;</i>':'';
					$('.redlist').find('.RedPack_Info').children('p').eq(0).html(red.toredName+'的红包'+type);
					$('.redlist').find('.RedPack_Info').children('p').eq(1).html(red.redtitle);
					// $('.redlist').find('.RedPack_Info').children('p').eq(2).html();
					$('.redlist').find('.alllist').children('h5').html(red.rednum+'个红包,共'+red.redMoney+'元');
					$.ajax({
						url: "{php echo $this->createMobileUrl('checkpacket',array('rid' => $rid))}",
						type: 'POST',
						dataType: 'json',
						data: {sendid: red.redid},
						success:function(json){
							var str = '';
							if (json.length > 0) {
								$.each(json,function(index, value) {
									if (value.uid == loginInfo.uid) {
										$('.redlist').find('.RedPack_Info').children('p').eq(2).html(value.amount+'元');
									}
									var start = new Date(value.createtime * 1000);
									var times = (start.getMonth() + 1) + '-' + start.getDate() + ' ' + (start.getHours() < 10 ? '0' + start.getHours() : start.getHours()) + ':' + (start.getMinutes() < 10 ? '0' + start.getMinutes() : start.getMinutes());
									str+='<li><img src="'+value.headurl+'"><div><p>'+value.nickname+'</p><p>'+times+'</p></div><span>'+value.money+'元</span></li>';
								});
								$('.redlist').find('.alllist').children('h5').after(str);
							}
						},
						error:function(){
							$(document).minTipsBox({
								tipsContent: 'error',
								tipsTime: 1
							});
						}
					});
				});

				$('.c-money li').on('click', function(event) {
					event.preventDefault();
					var $this = $(this);
					// personal.uid = _str.split('_')[1];
					var rewardjson1 = {
						money: $this.attr('data-money') || 0,
						touid: personal.uid || 0,  
						type: '1',
						tid: tid || 0
					};
					$.ajax({
						url: "{php echo $this->createMobileUrl('setreward',array('rid' => $rid))}",
						type: 'POST',
						dataType: 'json',
						data: rewardjson1,
						success:function(result){
							if(result.s == 1 && result.isweixin == 1) {
								callPay(result.msg);
							} else if(result.isweixin == 0) {
								$(document).minTipsBox({
									tipsContent: result.tip,
									tipsTime: 1
								});
							} else {
								$(document).minTipsBox({
									tipsContent: result.msg || result.tip,
									tipsTime: 1
								});
							}
						},
						error: function() {
							$(document).minTipsBox({
								tipsContent: 'error',
								tipsTime: 1
							});
						}
					});
				});

				//其他金额(输入框)
				$('#othermoney').on('input', function(event) {
					var money = $(this).val();
					if (/\s+/.test(money)) {
						return;
					};
					if (money >= 0.01 && money <= 1000) {
						$('.font-s').removeAttr('disabled');
					}else{
						$(".font-s").attr("disabled", "disabled");
					}
				});
				//其他金额确认按钮
				$('.font-s').on('click', function(event) {
					var rewardjson2 = {
						money: parseFloat($('#othermoney').val()).toFixed(2) || 0.01,
						touid: personal.uid || 0,  //打赏人uid/主播uid
						type: '2',
						tid: tid || 0
					};
					$.ajax({
						url: "{php echo $this->createMobileUrl('setreward',array('rid' => $rid))}",
						type: 'POST',
						dataType: 'json',
						data: rewardjson2,
						success:function(result){
							if(result.s == 1 && result.isweixin == 1) {
								callPay(result.msg);
							} else if(result.isweixin == 0) {
								$(document).minTipsBox({
									tipsContent: result.tip,
									tipsTime: 1
								});
							} else {
								$(document).minTipsBox({
									tipsContent: result.msg || result.tip,
									tipsTime: 1
								});
							}
						},
						error: function() {
							$(document).minTipsBox({
								tipsContent: 'error',
								tipsTime: 1
							});
						}
					});
				});
				//礼物支付
				$('.give').on('click', function(event) {
					var i = 0;
					$('.gift-list li').each(function(index, el) {
						if ($(this).hasClass('select')) {
							i++;
							var giftjson = {
								num: parseInt($('.countKuang').val()) || 1,
								item: index,
								id: $("#gift_id").val(),
								touid: founder.uid || 0,
								tid: tid || 0
							};
							$.ajax({
								url: "{php echo $this->createMobileUrl('setgift',array('rid' => $rid))}",
								type: 'POST',
								dataType: 'json',
								data: giftjson,
								success:function(result){
									if(result.s == 1 && result.isweixin == 1) {
										
										callPay(result.msg);
									} else if(result.isweixin == 0) {
										$(document).minTipsBox({
											tipsContent: result.tip,
											tipsTime: 1
										});
									} else {
										$(document).minTipsBox({
											tipsContent: result.msg || result.tip,
											tipsTime: 1
										});
									}
								},
								error: function() {
									$(document).minTipsBox({
										tipsContent: 'error',
										tipsTime: 1
									});
								}
							});
						}
					});
					//无选中状态
					if (i < 1) {
						$(document).minTipsBox({
							tipsContent: '请选中礼物',
							tipsTime: 1
						});
					};
				});
				//支付
				function callPay(json, otherdata) {
					if(typeof WeixinJSBridge == "undefined") {
					
						if(document.addEventListener) {
							document.addEventListener('WeixinJSBridgeReady', jsApiCall(json, otherdata), false);
						} else if(document.attachEvent) {
							document.attachEvent('WeixinJSBridgeReady', jsApiCall(json, otherdata));
							document.attachEvent('onWeixinJSBridgeReady', jsApiCall(json, otherdata));
						}
					} else {
					
						jsApiCall(json, otherdata);
					}
				}
				//支付
				function jsApiCall(obj, otherdata) {
					if(obj.status == 1) {
						WeixinJSBridge.invoke(
							'getBrandWCPayRequest', {
								"appId": "" + obj.appId + "",
								"timeStamp": "" + obj.timeStamp + "",
								"nonceStr": "" + obj.nonceStr + "",
								"package": "" + obj.package + "",
								"signType": "" + obj.signType + "",
								"paySign": "" + obj.paySign + "",
							},
							function(res) {
								if(res.err_msg == 'get_brand_wcpay_request:ok') {
                                    $('.grap').hide();
									$(".two-top").hide();
									$(".redenvelope").hide();
									$(".zhuang").slideUp('fast');
									$(".allgift").slideUp('fast');
									$(document).minTipsBox({
										tipsContent: "红包发送成功",
										tipsTime: 1
									});
									$(".sendredbagwin").hide();
								} else if(res.err_msg != "get_brand_wcpay_request:cancel") {
									//失败调起扫码
									setTimeout(function() {
										qrpay(otherdata)
									}, 500);
								}
							}
						);
					} else {
						alert(obj.res);
					}
				}
				//扫码支付
				function qrpay(otherdata) {
					$(document).minTipsBox({
						tipsContent: "准备付款",
						tipsTime: 1
					});

					$.ajax({
						type: "POST",
						url: "/Index/redpay?type=qr",
						data: otherdata,
						dataType: "json",
						success: function(data) {
							if(data.isok) {
								// $(".redbagBox").hide();
								// $("#payqrcode").attr("src", "/live/nt?data=" + data.Msg);
								// $(".QRcodePay").show();
							} else {
								$(document).minTipsBox({
									tipsContent: data.Msg,
									tipsTime: 1
								});
							}
						},
						error: function(XMLHttpRequest, textStatus, errorThrown) {
							$(document).minTipsBox({
								tipsContent: "支付失败",
								tipsTime: 1
							});
						}
					});
				}
				//群红包输入框判断
				function calc() {
					var amountline = $("#bagAmount").closest(".line");
					var moneyline = $("#bagMoney").closest(".line");
					var servicemoneyline = $(".service-money");
					if(/\s+/.test($("#bagAmount").val()) || /\s+/.test($("#bagMoney").val())) {
						return;
					}
					// if (/^0{1}([.]\d{1,2})?$|^[1-9]\d*([.]{1}[0-9]{1,2})?$/.test($("#bagMoney").val()) == false) {
					// 	$("#bagMoney").val($("#bagMoney").val().substring(0,$("#bagMoney").val().length-1));
					// }

					var bagamount = parseInt($("#bagAmount").val()) || 0;
					var bagmoney = parseFloat($("#bagMoney").val()) || 0;
					//随机
					if (pd.bagType == 1) {
						pd.bagMoney = bagmoney.toFixed(2);
					//固定
					}else if(pd.bagType == 2){
						pd.bagMoney = parseFloat((bagamount*bagmoney).toFixed(2));
					}
					pd.bagAmount = bagamount;
					

					if(bagamount <= 0) {
						amountline.addClass("line-error");
						msgbar.html(zbRedBag.msg1).show();

					} else {
						amountline.removeClass("line-error");
						msgbar.html("").hide();
					}

					if (pd.bagType == 1) {
						if((pd.bagMoney / pd.bagAmount) < minMoney) {
							moneyline.addClass("line-error");
							msgbar.html(zbRedBag.msg2).show();
						} else {
							moneyline.removeClass("line-error");
							msgbar.html("").hide();

						}
					}else{
						if (pd.bagMoney < 0.01) {
							moneyline.addClass("line-error");
							msgbar.html(zbRedBag.msg2).show();
						}
					}
					// pd.bagServiceMoney=pd.bagMoney*0.02;
					// pd.bagServiceMoney = pd.bagMoney*0;
					bag_money_show.text(pd.bagMoney);

					if(pd.bagAmount > 0 && pd.bagMoney > 0 ) {
						if (pd.bagType == 1) {
							if ((pd.bagMoney / pd.bagAmount) >= minMoney) {
								$("#btnSendRedBag").removeAttr("disabled");
							} else {
								$("#btnSendRedBag").attr("disabled", "disabled");
							}
						}else{
							if (bagmoney >= 0.01) {
								$("#btnSendRedBag").removeAttr("disabled");
							} else {
								$("#btnSendRedBag").attr("disabled", "disabled");
							}
						}
						
					} else {
						$("#btnSendRedBag").attr("disabled", "disabled");

					}
					// $(".service-money em").text(parseFloat(pd.bagServiceMoney).toFixed(2));
					// pd.bagServiceMoney > 0 ? servicemoneyline.show() : servicemoneyline.hide();
				}
				//弹窗提示
				(function($) {
					$.fn.extend({
						"minTipsBox": function(options) {
							options = $.extend({
								tipsContent: "", //提示内容
								tipsTime: 1 //停留时间 , 1 等于 1秒
							}, options);
							var $minTipsBox = ".min_tips_box";
							var $tipsContent = ".min_tips_box .tips_content";
							var $tipsTime = parseFloat(options.tipsTime) * 1000;
							//弹出框html代码
							var $minTipsBoxHtml = '<div class="min_tips_box">' +
								'<b class="bg"></b>' +
								'<span class="tips_content"></span>' +
								'</div>';
							//判断是否有提示框
							if($($minTipsBox).length > 0) {
								$($minTipsBox).show();
								resetBox();
								setTimeout(function() {
									$($minTipsBox).hide();
								}, $tipsTime);
							} else {
								$($minTipsBoxHtml).appendTo("body");
								resetBox();
								setTimeout(function() {
									$($minTipsBox).hide();
								}, $tipsTime);
							}
							//重置提示框属性
							function resetBox() {

								$($tipsContent).html(options.tipsContent);
								var tipsBoxLeft = $($tipsContent).width() / 2 + 10;
								$($tipsContent).css("margin-left", "-" + tipsBoxLeft + "px");
							}
						}
					});
				})(jQuery);

				var rankflag = true;
				//tab切换
				$(".TAstate").find("li").each(function(index) {
					$(this).click(function() {
						$(this).addClass("currentli").siblings().removeClass("currentli");
						$(".showthisd").eq($(this).index()).show().siblings(".showthisd").hide();
						if ($(this).index() > 0) {
							//$('.cont-right').hide();
							$('.gun').hide();
						}else{
							//$('.cont-right').show();
							$('.gun').show();
						}
						if($(this).attr('data-type')=='3'){
							$('.cont-right').show();
						}else{
							$('.cont-right').hide();
						}
	
						if($(this).attr('data-type')=='5')
						{
							rank({$rankid},$(".rankpm div p").length);
						}
						if($(this).attr('data-type')=='7')
						{
							panic();
						}
					})
				});
				//进来广告
				$(".readcolse").click(function() {
					$(".reading").hide();
				})

			})
		</script>
		<script>


			///var accountMode = 1;
			//var sdkAppID = '1400016757';
			//var accountType = 7911;

			//var avChatRoomId = 'group_2201'; //'49'; 

			//if(webim.Tool.getQueryString("groupid")) {
			//	avChatRoomId = webim.Tool.getQueryString("groupid");
			//}

			//var selType = webim.SESSION_TYPE.GROUP;
			//var selToID = avChatRoomId;
			//var selSess = null;

			//默认群组头像(选填)
			var selSessHeadUrl = 'img/2017.jpg';
			var friendHeadUrl = 'img/2017.jpg';

			var nickname;
            var isadmin=0;
            var roomadmin='{$roomadmin}';
            //var ShuttedUinList='[{"uid":"1647"},{"uid":"1115"},{"uid":"97"}]';

            if(roomadmin.indexOf('"'+'{$user["id"]}'+'"')>0)
            {
               isadmin=1;
			   $('.showfunction').append('<li class="functions"><p><i class="iconfont">&#xe61e;</i></p><p>禁言管理</p></li><li onclick="showshutup();"><p><i class="iconfont">&#xe632;</i></p><p>禁言列表</p></li>');	
               
                             	 $('#send_msg_text').removeAttr('readonly');
       $('#send_msg_text').attr('placeholder','和大伙说点什么吧');
                         
            }
			//当前用户身份
			var loginInfo = {
				'identifier': 'user_{$user["id"]}', //当前用户ID,必须是否字符串类型，选填
				'uid':'{$user["id"]}',
				'identifierNick': '{$user["nickname"]}', //当前用户昵称，选填
				'headurl': '{$user["headimgurl"]}', //当前用户默认头像，选填
				'isadmin':isadmin,
				'rid':'{$rid}',
				'allshutup':'{$item["isallshutup"]}',
				'disimg':'0',
				'pop':0
			};
			//var onGroupSystemNotifys = {
				// "5": onDestoryGroupNotify, 
				// "11": onRevokeGroupNotify, 
			//	"255": onCustomGroupNotify
			//};
//
			//监听连接状态回调变化事件
			//var onConnNotify = function(resp) {
				//switch(resp.ErrorCode) {
			//		case webim.CONNECTION_STATUS.ON:
						//webim.Log.warn('连接状态正常...');
			////			break;
			//		case webim.CONNECTION_STATUS.OFF:
				//		webim.Log.warn('连接已断开，无法收到新消息，请检查下你的网络是否正常');
				//		break;
				//	default:
				//		webim.Log.error('未知连接状态,status=' + resp.ErrorCode);
				//		break;
				//}
			//};

			//监听事件
			//var listeners = {
			//	"onConnNotify": onConnNotify, //选填
			//	"jsonpCallback": jsonpCallback, //IE9(含)以下浏览器用到的jsonp回调函数,移动端可不填，pc端必填
			//	"onBigGroupMsgNotify": onBigGroupMsgNotify, //监听新消息(大群)事件，必填
			//	"onMsgNotify": onMsgNotify, //监听新消息(私聊(包括普通消息和全员推送消息)，普通群(非直播聊天室)消息)事件，必填
			//	"onGroupSystemNotifys": onGroupSystemNotifys //,监听（多终端同步）群系统消息事件，必填
					// "onGroupInfoChangeNotify": onGroupInfoChangeNotify//监听群资料变化事件，选填
			//};

			//var isAccessFormalEnv = true; //是否访问正式环境

			//if(webim.Tool.getQueryString("isAccessFormalEnv") == "false") {
			//	isAccessFormalEnv = false; //访问测试环境
			//}

			//var isLogOn = true; //是否在浏览器控制台打印sdk日志

			//其他对象，选填
			//var options = {
			//	'isAccessFormalEnv': isAccessFormalEnv, //是否访问正式环境，默认访问正式，选填
			//	'isLogOn': isLogOn //是否开启控制台打印日志,默认开启，选填
			//};

			//var curPlayAudio = null; //当前正在播放的audio对象

			//var openEmotionFlag = false; //是否打开过表情
            
            
            
			//sdkLogin();
		
           setInterval(function(){
           	$.ajax({
					type: 'POST',
					url: "/Index/getbrowse",
					data: {
						id: '2201'
					},
					dataType: 'json',
					success: function(data) {
                     $('#browsenum').html(data.browse);
                     $(".zan-num").html(data.lovenum);
                     loginInfo.zanN=data.lovenum;
					}
				});
           },10000);
	       

			function imageClick(obj) {
			
			}

			var page = 1;

			$('.chat_title').on('scroll', function(event) {

				var $this =$(this),  
				viewH =$(this).height(),//可见高度  
				contentH =$(this).get(0).scrollHeight,//内容高度  
				scrollTop =$(this).scrollTop();//滚动高度  

				var h = contentH-viewH;
				if (scrollTop == 0) {
				$.post("{php echo $this->createMobileurl('commentpage',array('rid'=>$rid))}",{page:page}, function(data) {
					
					if(data.s==1){
						var str = '';
						$.each(data.content, function(index, value) {
							var start = new Date(value.createtime * 1000);
							var times = start.getFullYear() + '-' + (start.getMonth() + 1) + '-' + start.getDate() + ' ' + (start.getHours() < 10 ? '0' + start.getHours() : start.getHours()) + ':' + (start.getMinutes() < 10 ? '0' + start.getMinutes() : start.getMinutes()) + ':' + (start.getSeconds() < 10 ? '0' + start.getSeconds() : start.getSeconds());
							var adminstr='';	
							var identifierUser="user_"+value.uid;	
							if(roomadmin.indexOf('"'+identifierUser.replace('user_','')+'"')>0)
							{
								adminstr='<span class="sec"> (管理员) </span>';  
							}
							switch (value.type) {
								case 'comment':
									str+='<li><div class="chat_left">';    
									if(identifierUser==loginInfo.identifier){
										str+='<div class="head_portrait"><img src="'+value.headimgurl+'"></div><i class="iconfont" value="'+identifierUser+'">&#xe8be;</i></div><div class="chat_right"><div class="char_name">'+value.nickname+adminstr+'</div><div class="char_message">'+convertTextMsgToHtml(value.content)+'<div class="send"></div></div></div></li>'; 
									}else{
										if(roomadmin.indexOf('"'+identifierUser.replace('user_','')+'"')>0){
											str+='<div class="head_portrait"><img src="'+value.headimgurl+'"></div><i class="iconfont" value="'+identifierUser+'">&#xe8be;</i></div><div class="chat_right"><div class="char_name">'+value.nickname+'<span class="sec"> (管理员) </span></div><div class="char_message">'+convertTextMsgToHtml(value.content)+'<div class="send"></div></div></div></li>';
										}else{
											if(loginInfo.isadmin==1){
												str+='<div class="head_portrait clickhead" user="'+identifierUser+'" username="'+value.nickname+'"><img src="'+value.headimgurl+'"></div><i class="iconfont" value="'+identifierUser+'">&#xe8be;</i></div><div class="chat_right"><div class="char_name">'+value.nickname+'</div><div class="char_message">'+convertTextMsgToHtml(value.content)+'<div class="send"></div></div></div></li>'; 
											}else{
												str+='<div class="head_portrait"><img src="'+value.headimgurl+'"></div><i class="iconfont" value="'+identifierUser+'">&#xe8be;</i></div><div class="chat_right"><div class="char_name">'+value.nickname+'</div><div class="char_message">'+convertTextMsgToHtml(value.content)+'<div class="send"></div></div></div></li>';
											}
										}
									}   
									break;
								case 'gift':
									str+='<p class="red-tishi"><i class="iconfont" value="'+identifierUser+'"></i>'+value.content+'</p>';
									break;
								case 'reward':
									str+='<p class="red-tishi">'+value.content+'</p>';
									break;
								case 'grouppacket':
									str+='<li class="redbao"><div class="chat_left"><div class="head_portrait"><img src="'+value.headimgurl+'"></div><i class="iconfont" value="'+identifierUser+'">&#xe8be;</i></div><div class="chat_right"><div class="char_name" username="'+value.nickname+'">'+value.nickname+adminstr+'</div><div class="char_message red_message"><div class="red-red" value="'+value.id+'"><img src="{MODULE_URL}template/mobile/image/hongbao.png" height="45px"><div class="red-cent"><p class="red-title">'+value.content+'</p><p>领取红包</p></div></div><div class="send"></div><div class="red_name"><span class = "red_name1">直播间</span><span class = "red_name2">红包</span></div></div></div></li>';
									break;
							};
						});
						$('#msghistory').prepend(str);

						$('.chat_title').scrollTop(($this.get(0).scrollHeight-$this.height())-h);
						page++;
					}
					
					
				},'json');
				
				}
			});
            $.ajax({
					type: 'POST',
					url: "/Index/setbrowse",
					data: {
						id: loginInfo.tid
					},
					dataType: 'json',
					success: function(data) {

			        }
			});

function shutuplist(url) {
    $('.shutuplist').html('');
	$.ajax({
		type: "POST",
		url: url,
		dataType: 'json',
		success: function(result) {
			var str='';
			console.log(result.list.length);
			for(var i=0;i<result.list.length;i++){
				str+='<li><img src="'+result.list[i].headimgurl+'"/><div><p>'+result.list[i].nickname+'</p></div><span onclick=cancelshutup("{php echo $this->createMobileUrl('setshut',array('rid' => $rid,'type'=>2))}","user_'+result.list[i].touid+'","'+result.list[i].nickname+'")>移除</span></li>';
			}
			$('.shutuplist').append(str);
		},
		error: function() {
			ispost = false;
			$(document).minTipsBox({
				tipsContent: 'error',
				tipsTime: 1
			});
		}
	});
}
function showshutup()
{
	shutuplist("{php echo $this->createMobileUrl('getshut',array('rid' => $rid))}");
	$('.Banned').show();
	$(".function-all").slideUp('fast');										
	$(".showfunction").slideUp('fast');		
	hideflag = true;								
}
function allshutup(type)
{
    $.ajax({
                        url: "{php echo $this->createMobileUrl('setallshut',array('rid' => $rid))}",
                        type: 'POST',
                        dataType: 'json',
                        data: {allshutup:type},
                        success:function(result){
                            if(result.s == 1) {
                             //sendallshutup();
                             if(loginInfo.isadmin!=1)
                             {
                             	 $('#send_msg_text').attr('readonly','true');
                             	 $('#send_msg_text').attr('placeholder','全员禁言中');
                             }
       loginInfo.allshutup=1;
                            }
                            else
                            {
                             //sendallcancel();
                             $('#send_msg_text').removeAttr('readonly');
       $('#send_msg_text').attr('placeholder','和大伙说点什么吧');
       loginInfo.allshutup=0;
                            }
                        }
                    });
    
}	
function disimg(type)
{

    $.ajax({
                        url: './disimg',
                        type: 'POST',
                        dataType: 'json',
                        data: {tid:'2201',disimg:type},
                        success:function(result){
                            if(result.status == 1) {
                             senddisimg();
       loginInfo.disimg=1;
                            }
                            else
                            {
                             sendimgcancel();
       loginInfo.disimg=0;
                            }
                        }
                    });
    
}			


		</script>
	
	
	<script>
	window.onload = function(){
					if({$shutup}){
						$('#send_msg_text').attr('readonly','true');
						$('#send_msg_text').attr('placeholder','您已被禁言');
					}
					if({$item['isallshutup']}==1){
						$('#send_msg_text').attr('readonly','true');
						$('#send_msg_text').attr('placeholder','全员禁言中');  
					}
					if({$menu[0]['type']}==7){
						panic();
					}
		          $.post("{php echo $this->createMobileurl('commentpage',array('rid'=>$rid))}",{page:0}, function(data) {
					if(data.s==1){
						var str = '';
						$.each(data.content, function(index, value) {
							
							var start = new Date(value.createtime * 1000);
							var times = start.getFullYear() + '-' + (start.getMonth() + 1) + '-' + start.getDate() + ' ' + (start.getHours() < 10 ? '0' + start.getHours() : start.getHours()) + ':' + (start.getMinutes() < 10 ? '0' + start.getMinutes() : start.getMinutes()) + ':' + (start.getSeconds() < 10 ? '0' + start.getSeconds() : start.getSeconds());
							var adminstr='';	
							var identifierUser="user_"+value.uid;	
							if(roomadmin.indexOf('"'+identifierUser.replace('user_','')+'"')>0)
							{
								adminstr='<span class="sec"> (管理员) </span>';  
							}
							switch (value.type) {
								case 'comment':
									str+='<li><div class="chat_left">';    
									if(identifierUser==loginInfo.identifier){
										
										str+='<div class="head_portrait"><img src="'+value.headimgurl+'"></div><i class="iconfont" value="'+identifierUser+'">&#xe8be;</i></div><div class="chat_right"><div class="char_name">'+value.nickname+adminstr+'</div><div class="char_message">'+convertTextMsgToHtml(value.content)+'<div class="send"></div></div></div></li>'; 
									}else{
										if(roomadmin.indexOf('"'+identifierUser.replace('user_','')+'"')>0){
											
											str+='<div class="head_portrait"><img src="'+value.headimgurl+'"></div><i class="iconfont" value="'+identifierUser+'">&#xe8be;</i></div><div class="chat_right"><div class="char_name">'+value.nickname+'<span class="sec"> (管理员) </span></div><div class="char_message">'+convertTextMsgToHtml(value.content)+'<div class="send"></div></div></div></li>';
										}else{
											
											if(loginInfo.isadmin==1){
												str+='<div class="head_portrait clickhead" user="'+identifierUser+'" username="'+value.nickname+'"><img src="'+value.headimgurl+'"></div><i class="iconfont" value="'+identifierUser+'">&#xe8be;</i></div><div class="chat_right"><div class="char_name">'+value.nickname+'</div><div class="char_message">'+convertTextMsgToHtml(value.content)+'<div class="send"></div></div></div></li>'; 
											}else{
												str+='<div class="head_portrait"><img src="'+value.headimgurl+'"></div><i class="iconfont" value="'+identifierUser+'">&#xe8be;</i></div><div class="chat_right"><div class="char_name">'+value.nickname+'</div><div class="char_message">'+convertTextMsgToHtml(value.content)+'<div class="send"></div></div></div></li>';
											}
										}
									}   
									break;
								case 'gift':
									str+='<p class="red-tishi"><i class="iconfont" value="'+identifierUser+'"></i>'+value.content+'</p>';	
									break;
								case 'reward':
									str+='<p class="red-tishi">'+value.content+'</p>';
									break;
								case 'grouppacket':
									str+='<li class="redbao"><div class="chat_left"><div class="head_portrait"><img src="'+value.headimgurl+'"></div><i class="iconfont" value="'+identifierUser+'">&#xe8be;</i></div><div class="chat_right"><div class="char_name" username="'+value.nickname+'">'+value.nickname+adminstr+'</div><div class="char_message red_message"><div class="red-red" value="'+value.id+'"><img src="{MODULE_URL}template/mobile/2/image/hongbao.png" height="45px"><div class="red-cent"><p class="red-title">'+value.content+'</p><p>领取红包</p></div></div><div class="send"></div><div class="red_name"><span class = "red_name1">直播间</span><span class = "red_name2">红包</span></div></div></div></li>';
									break;
							};
						});

						$('#msghistory').prepend(str);

						$('.chat_title').scrollTop($('.chat_title').get(0).scrollHeight-$('.chat_title').height());
						
					}
					
					
				},'json');



//switch开关
	if ({$item['isallshutup']}==1) {
		$(".bannerdbtn").children('em').removeClass('btn-movel').addClass('btn-mover').parent().css({backgroundColor: '#31ac82'});
	} else{
		 $(".bannerdbtn").children('em').removeClass('btn-mover').addClass('btn-movel').parent().css({backgroundColor: '#ccc'});
	}
	
  $(".bannerdbtn").on('click', function(event) {
                if ($(this).children('em').hasClass('btn-mover')) {
                    $(this).children('em').removeClass('btn-mover').addClass('btn-movel').parent().css({backgroundColor: '#ccc'});
                }
                else {
                    $(this).children('em').removeClass('btn-movel').addClass('btn-mover').parent().css({backgroundColor: '#31ac82'});
                };

            });

}	
	</script>
<script>
$(function(){ 
	initEmotionUL();
	setInterval("showMsg('{php echo $this->createMobileurl('getmsg',array('rid'=>$rid))}')", 500);
}); 
</script>
<script type="text/javascript">
var body= $(".main").width();
var vedio=body*0.56;
$(".block_video").height(vedio);
var image = "{php echo tomedia($list['settings']['img'])}";//封面图片
var a=0;
var se;
var u = navigator.userAgent;
var video_status = null;
var vedio_an = vedio+52;

var isandroid = u.indexOf('Android') > -1 || u.indexOf('Linux') > -1; //android终端或者uc浏览器
       if(isandroid==true)
       {
window.onresize = function(){
if(loginInfo.pop==1)
{
	loginInfo.pop=0;
	return false;
}
$('.watermark p').css("top","66px");
$('.watermark .vp').css("top","56px");
$(".block_video").height(vedio_an);
$('#html5Media2').css("object-position","0px 52px");
$(".header-an").show();
if (video_status == 0) {
	var timer1 = setTimeout(function() {
			$(".schedule").hide();
		}, 5000)
	$(".all-vide").on('click',function(event) {
		event.preventDefault();
		if ($(".schedule").css("display") == "none") {
			$(".schedule").show();
			timer1 = setTimeout(function() {
				$(".schedule").hide();
			}, 5000)
		} else {
			$(".schedule").hide();
		}
		$(".schedule").on('click', function(event) {
			event.preventDefault();
			event.stopPropagation();
			clearTimeout(timer1);
			$(".schedule").show();
			timer1 = setTimeout(function() {
				$(".schedule").hide();
			}, 6000)
		});
	});
};
$('#html5Media2').attr('width',$(window).width()+'px');
$('#html5Media2').attr('height',$(window).height()+'px');
$('.advertising').hide();
var height = $(window).height();//窗口可视高度1019
var foot=$(".footer").height(); //底部固定高度
var TAstate=$(".TAstate").height() //tab切换高度
// var gun=$(".gun").height(); //文字滚动的高度
$(".live").css("height",height-vedio_an-foot-TAstate);
var bj=height-vedio-TAstate;
$('.TAstate').css('z-index','3');
if(a==0){
	a=1;
	$('.max-start').hide();
	if(loginInfo.isend==1)
	{
	 $('.schedule').show();
	}
	$('#html5Media2').attr('x5-video-player-type','h5');
	$('#html5Media2').attr('x5-video-player-fullscreen',true);
	$(".minh .allconts").css({'overflow':'scroll', 'overflow-x':'hidden','height':bj,'background-color':'#fff','padding-bottom':'30px'});
}else{
	a=0;
	$('.schedule').hide();
	$('#html5Media2').attr('x5-video-player-type','h5');
	$('#html5Media2').attr('x5-video-player-fullscreen',true);
	$(".minh .allconts").css({'overflow':'', 'overflow-x':'','height': '','background-color':'','padding-bottom':''});
}

}
}
function panic()
{
	$('.goods-box').hide();
	$('.goods-box').html('');
	var nowtime=0;
	$.ajax({
								url: "{php echo $this->createMobileurl('store',array('rid'=>$rid))}",
								type: 'POST',
								dataType: 'json',
								data: {tid:'2201'},
								success:function(json){
									var str = '';
									$.each(json.msg,function(index,value) {

										str+='<div class="goods-list clearfix"><div class="list-l"><img src="'+value.img+'"/></div><div class="list-r"><p class="r-name">'+value.title+'</p><div class="r-bottom clearfix"><p class="r-price"><span>￥</span><em>'+value.price+'</em></p>';
										if(index==0)
						                   {
						                    nowtime=value.nowtime;
						                   }
                                        if(value.endtime < nowtime)
                                         {
                                          str+='<a class="r-sub r-sub2" href="javascript:void(0);">已结束</a>';
                                           }
								        else
								        {  
								        	if(value.startime>nowtime)
								        	{
                                             str+='<a class="r-sub r-sub2 panic" href="javascript:void(0);" value="'+value.startime+'" hashref="'+value.link+'"></a>';
								        	}
								        	else
								        	{
								        		str+='<a class="r-sub r-sub2" href="'+value.link+'">马上买</a>';
								        	}
								        	
								        }
											str+='</div></div></div>';	
										    
											});
                                            $('.goods-box').append(str);
											var gW = $(".TAstate").width()*0.36;
											var gH = parseInt(gW*0.58);
											$(".list-l").height(gH);
											$(".list-r").height(gH);
											$('.goods-box').show();
											window.clearInterval(se);
											countdown(nowtime*1000);
								         }
								     });				
}
function countdown(nowtime){

	se=setInterval(function() {
   nowtime=parseInt(nowtime)+100;
	$(".panic").each(function() { 
		if(parseInt($(this).attr('value'))>100)
		{
	 var endTime = new Date(parseInt($(this).attr('value')) * 1000); 
            var nMS = endTime.getTime() - nowtime; 

             //console.log(endTime.getTime() +'==='+ nowtime);
            var myD = Math.floor(nMS / (1000 * 60 * 60 * 24)); 
            var myH = (Math.floor(nMS / (1000 * 60 * 60)) % 24 + myD*24)<10?"0"+(Math.floor(nMS / (1000 * 60 * 60)) % 24 + myD*24):(Math.floor(nMS / (1000 * 60 * 60)) % 24 + myD*24);
            var myM = (Math.floor(nMS / (1000 * 60)) % 60)<10?"0"+(Math.floor(nMS / (1000 * 60)) % 60):(Math.floor(nMS / (1000 * 60)) % 60); 
            var myS = (Math.floor(nMS / 1000) % 60)<10?"0"+(Math.floor(nMS / 1000) % 60):(Math.floor(nMS / 1000) % 60); 
            var myMS = Math.floor(nMS / 100) % 10; 
                  
            if (myD >= 0) { 
                var str = myH + ":" + myM + ":" + myS + ":" + myMS; 
             }
            else { 
                var str = "马上抢"; 
                $(this).attr('href',$(this).attr('hashref'));
            } 

          $(this).html(str); 
}})},100);
}
function fullscreen()
{
	$('#html5Media2').attr('x5-video-player-type','');
	$('#html5Media2').attr('x5-video-player-fullscreen',false);
	document.getElementById('html5Media2').play();
}
function rank(num,i){
	console.log(11);
	if(num==1){
		if(i==1){
			$('.nav-btn1').attr('class','nav-btn1 nav-btn7  nav-select');
		}else{
			$('.nav-btn1').attr('class','nav-btn1 nav-select');
		}
		$('.nav-btn1').attr('class','nav-btn1 nav-select');
		$('.nav-btn2').attr('class','nav-btn2 nav-unselect');
		$('.nav-btn3').attr('class','nav-btn3 nav-unselect');
		$('.nav-btn4').attr('class','nav-btn4 nav-unselect');
	}else if(num==2){
		$('.nav-btn1').attr('class','nav-btn1 nav-unselect');
		if(i==2){
			$('.nav-btn2').attr('class','nav-btn2 nav-btn7  nav-select');
		}else{
			$('.nav-btn2').attr('class','nav-btn2 nav-select');
		}
		$('.nav-btn3').attr('class','nav-btn3 nav-unselect');
		$('.nav-btn4').attr('class','nav-btn4 nav-unselect');
	}else if(num==3){
		$('.nav-btn1').attr('class','nav-btn1 nav-unselect');
		$('.nav-btn2').attr('class','nav-btn2 nav-unselect');
		if(i==3){
			$('.nav-btn3').attr('class','nav-btn3 nav-btn7  nav-select');
		}else{
			$('.nav-btn3').attr('class','nav-btn3 nav-select');
		}
		$('.nav-btn4').attr('class','nav-btn4 nav-unselect');
	}else if(num==4){
		$('.nav-btn1').attr('class','nav-btn1 nav-unselect');
		$('.nav-btn2').attr('class','nav-btn2 nav-unselect');
		$('.nav-btn3').attr('class','nav-btn3 nav-unselect');
		if(i==4){
			$('.nav-btn4').attr('class','nav-btn4 nav-btn7  nav-select');
		}else{
			$('.nav-btn4').attr('class','nav-btn4 nav-select');
		}
	}
	
	$('#rank'+num).html('');
	$.ajax({
		url: "{php echo $this->createMobileurl('rank',array('rid'=>$rid))}",
		type: 'POST',
		dataType: 'json',
		data: {type:num},
		success:function(json){
			var str = '';
			$('#rank'+num).attr('value',1);
			$.each(json.msg,function(index, el) {
				str+='<li>';
				if (index == 0) {
					str+='<span style="margin-top:10px;"><img src="{MODULE_URL}template/mobile/2/image/1.png" width="30px"></span>';
				}else if(index == 1){
					str+='<span style="margin-top:10px;"><img src="{MODULE_URL}template/mobile/2/image/2.png" width="30px"></span>';
				}else if(index == 2){
					str+='<span style="margin-top:10px;"><img src="{MODULE_URL}template/mobile/2/image/3.png" width="30px"></span>';
				}else{
					str+='<span>'+(parseInt(index)+1)+'</span>';
				}
				str+='<img src="'+el.headimgurl+'" width="35px" height="35px"> <em class="names">'+el.nickname+'</em>';

				if(num==1){
					str+='邀请<i class="iconfont men">'+el.c+'</i>人';
				}else if(num==2){
					str+='¥<i class="iconfont men">'+(el.fee)+'</i>元';
				}else if(num==3){
					str+='¥<i class="iconfont men">'+(el.amount)+'</i>元';
				}else if(num==4){
					str+='¥<i class="iconfont men">'+(el.amount)+'</i>元';
				}
				
				str+='</li>';	
			});
			$('#rank1').hide();
			$('#rank2').hide();
			$('#rank3').hide();
			$('#rank4').hide();
			console.log('#rank'+num);
			$('#rank'+num).show();
			$('#rank'+num).html(str);
			
		}
	});
	

	};
		video_status = 0;
		var w = "100%";//视频宽度
var h = vedio;//视频高度
var url = "{$list['settings']['hls']}";//视频地址
loginInfo.isend=1;


	var objectPlayer=new aodianPlayer({
  container:'play',//播放器容器ID，必要参数
  hlsUrl: url,//控制台开通的APP hls地址，必要参数
  /* 以下为可选参数*/
  width: w,//播放器宽度，可用数字、百分比等
  height: h,//播放器高度，可用数字、百分比等
  autostart: true,//是否自动播放，默认为false
  controlbardisplay: 'enable',//是否显示控制栏，值为：disable、enable默认为disable。
 // adveDeAddr: image,//封面图片链接

 adveDeAddr : image,
  adveWidth: w,//封面图宽度
  adveHeight: h,//封面图高度
  nowtime:2,
  startime:1,
  //adveReAddr: ''//封面图点击链接

});



			
				var $h_height=$(".advertising").height();//顶部广告高度
				var videoheight=$(".fixedfile").height();//视频到tab高度
				var height = $(window).height();//窗口可视高度1019
				var foot=$(".footer").height(); //底部固定高度
				// var gun=$(".gun").height()||0; //文字滚动的高度
				var noloock = $('.main').get(0).scrollHeight;//窗口内容高度1125
				var TAstate=$(".TAstate").height() //tab切换高度
				var sheihgt =height-videoheight-foot-$h_height;
//				$(".chat_title").css("height", sheihgt);
				
				 var allvt=vedio+TAstate; //视频到tab高度
				var intsheihgt ;

				intsheihgt =height-allvt-foot;
				$(".live").css("height", intsheihgt); //计算高度
				        



if($h_height>height){
	$(".footer-bar").hide();
}
	$(document).scroll(function(){
				var ssss=$(window).scrollTop();
//				console.log(ssss);
//				console.log($h_height);
				var hidt=$h_height-200;
				if($h_height>height){
						if(ssss>=hidt){
						$(".footer-bar").show();
	//					console.log(13);
					}else{
						$(".footer-bar").hide();
					}	
				}
				})


//点赞
goJudge(clickLovePC,clickLoveMO);
// 移动PC端判断
function goJudge(fnPC,fnMO) {
	if ((navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i))) {
		fnMO();
	}
	else {
		fnPC();
	}
}
function clickLovePC() {
	$(".zan-click").on('mousedown', function(event) {
		$(".cont-right .zan-box i").css('color','rgb(245, 28, 48)');
	});
	$(".zan-click").on('mouseup', function(event) {
		$(".cont-right .zan-box i").css('color','#ff3d03');
	});
}
function clickLoveMO() {
	$(".zan-click").on('touchstart', function(event) {
		$(".cont-right .zan-box i").css('color','rgb(245, 28, 48)');
	});
	$(".zan-click").on('touchend', function(event) {
		$(".cont-right .zan-box i").css('color','#ff3d03');
	});
}
$(".zan-click").on('click', function(event) {
	if(new Date().getTime()>loginInfo.zantime+500)
	{
		sendLove();
		sendGroupLoveMsg();
	}
	loginInfo.zantime=new Date().getTime();
});
function sendLove() {
	sendLoves('.love','100','7','200');
	var sl1 = setTimeout(function(){
		sendLoves('.love','100','7','200');
		var sl2 = setTimeout(function(){
			sendLoves('.love','100','7','200');
			clearTimeout(sl2);
		}, 200)
		clearTimeout(sl1);
	}, 200)
	loginInfo.zanN++;
}
function sendLoves(obj,ow,on,oh) {
		$(".zan-num").html(loginInfo.zanN);
	var n = Math.floor(Math.random() * on + 1);
	var i=$(obj).children('img').length;
	var w = parseInt(Math.random() * ow);
	$(obj).append("<img class = 'loveimg' src=''>");
	$(obj).children().eq(i).attr('src','{MODULE_URL}template/mobile/2/image/l'+n+'.png');
	if (w < ow/3) {
		$(".loveimg").animate({
			bottom: oh,
			opacity:"0",
			left: -w,
			width: 40,
			height: 40,
		},2500,function(){
			$(this).remove();
		});
	};
	if (w > 2*ow/3) {
		$(".loveimg").animate({
			bottom: oh,
			opacity:"0",
			left: -w,
			width: 36,
			height: 36,
		},3500,function(){
			$(this).remove();
		});
	};
	if (w >= ow/3 || w <= 2*ow/3) {
		$(".loveimg").animate({
			bottom: oh,
			opacity: "0",
			left: -w,
			width: 32,
			height: 32,
		},3000,function(){
			$(this).remove();
		});
	};
}
		</script>
<div style="display:none;">
<script src="https://s13.cnzz.com/z_stat.php?id=1273392991&web_id=1273392991" language="JavaScript"></script>
</div>
<script type="text/javascript" charset="UTF-8" src="{MODULE_URL}template/mobile/2/js/htmlplay.js"></script></body></html>