<!DOCTYPE html>
<html lang="en">

<head>
    {template 'web/header'}
    <style>
    #couponTable tbody tr{
        display: none;
    }
    #couponTable tbody tr td{
        line-height: 36px;
    }
    @media screen and (max-width:710px) {
        .layui-form-mid,#couponAdd {
            margin-left: 150px !important;
        }
        #couponAdd{
            margin-top: 10px;
        }
    }
    </style>
</head>

<body>
    <div class="layui-elem-quote lineh38 fontsize16">
        <a href="#">全局设置</a>
    </div>
    <fieldset class="layui-elem-field">
        <legend>全局设置</legend>
        <div class="layui-field-box">
            <form class="layui-form" role="form" method="post" action="{php echo $this->createWebUrl('TplGlobal', array('op'=>'update'))}" name="tplgolbal" lay-filter="tplgolbal" id="tplgolbal">
                <fieldset class="layui-elem-field layui-field-title site-title">
                    <legend><a name="name">头部部分</a></legend>
                </fieldset>
                <div class="layui-form-item">
                    <label class="layui-form-label">网站标题</label>
                    <div class="layui-input-inline" style="width: 60%;">
                        <input type="text" name="headerTitle" required lay-verify="required" placeholder="请输入网站标题" autocomplete="off" class="layui-input" value="{if isset($list[0]['title']['content']) && $list[0]['title']['content']}{$list[0]['title']['content']}{else}网站标题{/if}">
                    </div>
                </div>
                <fieldset class="layui-elem-field layui-field-title site-title">
                    <legend><a name="name">首页轮播图部分</a></legend>
                </fieldset>
                <div class="layui-form-item">
                    <label class="layui-form-label">轮播图高度</label>
                    <div class="layui-input-inline" style="width: 60%;">
                        <input type="number" name="bannerHeight" required lay-verify="required" placeholder="请输入高度" autocomplete="off" class="layui-input" value="{if isset($list[1]['serialize']['height']) && $list[1]['serialize']['height']}{$list[1]['serialize']['height']}{else}180{/if}">
                    </div>
                    <div class="layui-form-mid layui-word-aux">一般为180</div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">是否自动播放</label>
                    <div class="layui-input-inline" style="width: 60%;">
                        <input type="checkbox" name="bannerAutoPlay" title="" lay-skin="primary" {if isset($list[1]['serialize']['play']) && $list[1]['serialize']['play'] == 1}checked{/if}>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">播放时间间隔(s)</label>
                    <div class="layui-input-inline" style="width: 60%;">
                        <input type="number" name="bannerTimeInterval" required lay-verify="required" placeholder="请输入时间间隔" autocomplete="off" class="layui-input" value="{if isset($list[1]['serialize']['time'])}{$list[1]['serialize']['time']}{else}3{/if}">
                    </div>
                </div>
                <fieldset class="layui-elem-field layui-field-title site-title">
                    <legend><a name="name">首页导航部分</a></legend>
                </fieldset>
                <div class="layui-form-item">
                    <label class="layui-form-label">首页导航样式</label>
                    <div class="layui-input-inline" style="width: 60%;">
                        <select name="navStyle" lay-verify="required">
                            <option value="0" {if isset($list[2]['serialize']['style']) && $list[2]['serialize']['style'] == 0}selected{/if}>一行四列(默认)</option>
                            <option value="1" {if isset($list[2]['serialize']['style']) && $list[2]['serialize']['style'] == 1}selected{/if}>一行三列</option>
                            <option value="2" {if isset($list[2]['serialize']['style']) && $list[2]['serialize']['style'] == 2}selected{/if}>一行五列</option>
                        </select>
                    </div>
                    <a href="#" class="layui-form-mid" style="color: #01AAED;">导航样式说明</a>
                </div>
                <fieldset class="layui-elem-field layui-field-title site-title">
                    <legend><a name="name">首页标题部分</a></legend>
                </fieldset>
                <div class="layui-form-item">
                    <label class="layui-form-label">首页标题修饰样式</label>
                    <div class="layui-input-inline" style="width: 60%;">
                        <select name="titleStyle" lay-verify="required">
                            <option value="0" {if isset($list[5]['title']['style']) && $list[5]['title']['style'] == 0}selected{/if}>默认版</option>
                            <option value="1" {if isset($list[5]['title']['style']) && $list[5]['title']['style'] == 1}selected{/if}>第二版</option>
                            <option value="2" {if isset($list[5]['title']['style']) && $list[5]['title']['style'] == 2}selected{/if}>第三版</option>
                            <option value="3" {if isset($list[5]['title']['style']) && $list[5]['title']['style'] == 3}selected{/if}>第四版</option>
                        </select>
                    </div>
                    <a href="#" class="layui-form-mid" style="color: #01AAED;">标题样式说明</a>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">标题设置</label>
                    <div class="layui-input-inline" style="width: 60%;">
                        <div class="layui-row">
                            <div class="layui-col-sm12 layui-col-md6" style="height: 36px; line-height: 36px;margin-bottom: 10px;vertical-align: middle;">
                                <input type="text" name="couponTitle" required lay-verify="required" placeholder="请输入优惠券模块标题" autocomplete="off" class="layui-input" value="{if isset($list[4]['title']['content'])}{$list[4]['title']['content']}{else}优惠券列表{/if}" style="width: 60%;">
                            </div>
                            <div class="layui-col-sm12 layui-col-md6" style="height: 36px; line-height: 36px;margin-bottom: 10px;vertical-align: middle;">
                                <input type="checkbox" name="couponTitleDisplay" title="是否隐藏优惠券模块标题" lay-skin="primary" {if isset($list[4]['title']['hidden']) && $list[4]['title']['hidden'] == 1}checked{/if}>
                            </div>
                            <div class="layui-col-sm12 layui-col-md6" style="height: 36px; line-height: 36px;margin-bottom: 10px;vertical-align: middle;">
                                <input type="text" name="productTitle" required lay-verify="required" placeholder="请输入产品模块标题" autocomplete="off" class="layui-input" value="{if isset($list[5]['title']['content'])}{$list[5]['title']['content']}{else}产品列表{/if}" style="width: 60%;">
                            </div>
                            <div class="layui-col-sm12 layui-col-md6" style="height: 36px; line-height: 36px;margin-bottom: 10px;vertical-align: middle;">
                                <input type="checkbox" name="productTitleDisplay" title="是否隐藏产品模块标题" lay-skin="primary" {if isset($list[5]['title']['hidden']) && $list[5]['title']['hidden'] == 1}checked{/if}>
                            </div>
                            <div class="layui-col-sm12 layui-col-md6" style="height: 36px; line-height: 36px;margin-bottom: 10px;vertical-align: middle;">
                                <input type="text" name="articleTitle" required lay-verify="required" placeholder="请输入文章模块标题" autocomplete="off" class="layui-input" value="{if isset($list[6]['title']['content'])}{$list[6]['title']['content']}{else}文章列表{/if}" style="width: 60%;">
                            </div>
                            <div class="layui-col-sm12 layui-col-md6" style="height: 36px; line-height: 36px;margin-bottom: 10px;vertical-align: middle;">
                                <input type="checkbox" name="articleTitleDisplay" title="是否隐藏文章模块标题" lay-skin="primary" {if isset($list[6]['title']['hidden']) && $list[6]['title']['hidden'] == 1}checked{/if}>
                            </div>
                        </div>
                    </div>
                </div>
                <fieldset class="layui-elem-field layui-field-title site-title">
                    <legend><a name="name">首页公告栏部分</a></legend>
                </fieldset>
                <div class="layui-form-item">
                    <label class="layui-form-label">公告栏内容</label>
                    <div class="layui-input-inline" style="width: 60%;float: left;margin-right: 10px;">
                        <textarea name="announcementCount" required lay-verify="required" placeholder="请输入公告栏内容" class="layui-textarea">{if isset($list[3]['serialize']['content']) && $list[3]['serialize']['content']}{$list[3]['serialize']['content']}{else}公告内容{/if}</textarea>
                    </div>
                    <div class="layui-form-mid layui-word-aux">回车表示换行</div>
                </div>
                <fieldset class="layui-elem-field layui-field-title site-title">
                    <legend><a name="name">首页优惠券部分</a></legend>
                </fieldset>
                <div class="layui-form-item">
                    <label class="layui-form-label">首页优惠券样式</label>
                    <div class="layui-input-inline" style="width: 60%;">
                        <select name="couponStyle" lay-verify="required">
                            <option value="0" {if isset($list[4]['serialize']['style']) && $list[4]['serialize']['style'] == 0}selected{/if}>默认版(黄色)</option>
                            <option value="1" {if isset($list[4]['serialize']['style']) && $list[4]['serialize']['style'] == 1}selected{/if}>第二版(红色)</option>
                            <option value="2" {if isset($list[4]['serialize']['style']) && $list[4]['serialize']['style'] == 2}selected{/if}>第三版(蓝色)</option>
                            <option value="3" {if isset($list[4]['serialize']['style']) && $list[4]['serialize']['style'] == 3}selected{/if}>第四版(绿色)</option>
                        </select>
                    </div>
                    <a href="#" class="layui-form-mid" style="color: #01AAED;">优惠券样式说明</a>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">选择优惠券</label>
                    <div class="layui-input-inline" style="width: 60%;">
                        <select name="couponChange" lay-verify="required">
                            {loop $couponlist $index $item}
                            <option value="{$item['id']}">{$item['title']}</option>
                            {/loop}
                        </select>
                        <input type="hidden" name="couponList" value="{if isset($list[4]['serialize']['list']) && $list[4]['serialize']['list']}{$list[4]['serialize']['list']}{/if}">
                    </div>
                    <button class="layui-btn layui-btn-normal" style="margin-left: 5px;" id="couponAdd">添加优惠券</button>
                </div>
                <div style="width: 80%;margin-left: 50px; margin-top: 15px;">
                    <table class="layui-table" style="text-align: center;" id="couponTable">
                        <colgroup>
                            <col width="50">
                            <col width="100">
                            <col>
                        </colgroup>
                        <thead>
                            <tr>
                                <th>id</th>
                                <th>优惠券名称</th>
                                <th>金额</th>
                                <th>最大领取数</th>
                                <th>开始时间</th>
                                <th>截止时间</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody>
                            {loop $couponlist $index $item}
                            <tr id="couponTr{$item['id']}" {if isset($list[4]['serialize']['list']) && in_array($item['id'],explode(',',$list[4]['serialize']['list']))}style="display:table-row;"{/if}>
                                <td>{$item['id']}</td>
                                <td>{$item['title']}</td>
                                <td>{$item['value']}</td>
                                <td>{if $item['limit_num']}{$item['limit_num']}{else}无限制{/if}</td>
                                <td>{php echo date('Y-m-d',$item['addtime'])}</td>
                                <td>{php echo date('Y-m-d',$item['expire_time'])}</td>
                                <td><a href="javascript:void(0);" onclick="couponDel({$item['id']})">删除</a></td>
                            </tr>
                            {/loop}
                        </tbody>
                    </table>
                </div>
                <fieldset class="layui-elem-field layui-field-title site-title">
                    <legend><a name="name">设置是否隐藏</a></legend>
                </fieldset>
                <div class="layui-form-item">
                    <label class="layui-form-label"> </label>
                    <div class="layui-input-inline" style="width: 60%;">
                        <div class="layui-row">
                            <div class="layui-col-sm12 layui-col-md6" style="height: 36px; line-height: 36px;">
                                <input type="checkbox" name="bannerDisplay" title="是否隐藏首页轮播图" lay-skin="primary" {if isset($list[1]['isdisplay']) && $list[1]['isdisplay'] == 0}checked{/if}>
                            </div>
                            <div class="layui-col-sm12 layui-col-md6" style="height: 36px; line-height: 36px;">
                                <input type="checkbox" name="navDisplay" title="是否隐藏首页导航" lay-skin="primary" {if isset($list[2]['isdisplay']) && $list[2]['isdisplay'] == 0}checked{/if}>
                            </div>
                            <div class="layui-col-sm12 layui-col-md6" style="height: 36px; line-height: 36px;">
                                <input type="checkbox" name="announcementDisplay" title="是否隐藏首页公告栏" lay-skin="primary" {if isset($list[3]['isdisplay']) && $list[3]['isdisplay'] == 0}checked{/if}>
                            </div>
                            <div class="layui-col-sm12 layui-col-md6" style="height: 36px; line-height: 36px;">
                                <input type="checkbox" name="couponDisplay" title="是否隐藏首页优惠券" lay-skin="primary" {if isset($list[4]['isdisplay']) && $list[4]['isdisplay'] == 0}checked{/if}>
                            </div>
                            <div class="layui-col-sm12 layui-col-md6" style="height: 36px; line-height: 36px;">
                                <input type="checkbox" name="productDisplay" title="是否隐藏产品模块" lay-skin="primary" {if isset($list[5]['isdisplay']) && $list[5]['isdisplay'] == 0}checked{/if}>
                            </div>
                            <div class="layui-col-sm12 layui-col-md6" style="height: 36px; line-height: 36px;">
                                <input type="checkbox" name="newsDisplay" title="是否隐藏文章模块" lay-skin="primary" {if isset($list[6]['isdisplay']) && $list[6]['isdisplay'] == 0}checked{/if}>
                            </div>
                        </div>
                    </div>
                </div>
                <input type="hidden" name="token" value="{$_W['token']}" />
                <div style="margin-left: 30px;margin-top: 20px;">
                     <input type="submit" class="layui-btn" name="submit" value="提交全局设置" />
                </div>
            </form>
        </div>
    </fieldset>
    <script>
    //layui
    layui.use(['form'], function() {
        var form = layui.form;
    });
    //添加优惠券
    $('#couponAdd').on('click',function(){
        var id = $('select[name="couponChange"]').val();
        if($('#couponTr'+id).is(':hidden')){
            $('#couponTr'+id).show();
            var value = $('input[name="couponList"]').val();
            if(value.length == 0 || value == ' '){
                value = id;
            }else{
                value = value+','+id;
            }
            $('input[name="couponList"]').attr('value',value);
        }
        return false;
    })
    //删除优惠券
    function couponDel(id){
        $('#couponTr'+id).hide();
        var value = $('input[name="couponList"]').val();
        if(value.substr(0,1) == id && value.length>1){
            value = value.replace(id+",","");
        }else if(value == id){
            value = value.replace(id,"");
        }else{
            value = value.replace(","+id,"");
        }
        $('input[name="couponList"]').attr('value',value);
    }
    </script>
</body>

</html>