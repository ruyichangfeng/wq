<?php
/*
 __________________________________________________
|  Encode by BajieTeam on we7                      |
|__________________________________________________|
*/
 goto DWptt; DWptt: require_once dirname(__FILE__) . "\x2f\56\56\x2f\56\x2e\57\x2e\56\x2f\154\x6f\156\141\153\x69\156\147\x5f\x66\x6c\141\163\150\57\106\154\x61\163\150\x43\x6f\155\155\x6f\x6e\123\x65\162\166\151\143\x65\56\x70\150\x70"; goto CVVKm; CVVKm: require_once dirname(__FILE__) . "\57\56\56\x2f\x2e\x2e\57\56\x2e\x2f\x6c\157\156\x61\x6b\x69\x6e\147\x5f\x66\x6c\x61\163\150\57\106\154\x61\x73\x68\125\x73\145\x72\123\145\162\x76\151\x63\145\56\x70\150\x70"; goto OxBs_; OxBs_: class GiftShopTplConfigService extends FlashCommonService { private $userService; public function __construct() { goto uMicg; uMicg: $this->plugin_name = "\154\157\x6e\141\153\x69\x6e\x67\137\147\x69\146\164\x5f\x73\x68\x6f\x70"; goto GtP4o; INZGN: $this->columns = "\151\144\x2c\165\x6e\x69\x61\x63\151\x64\54\x67\x65\x74\137\x6e\x6f\x74\151\x63\145\54\143\x68\145\x63\x6b\137\x73\164\x61\164\165\163\137\141\x63\143\145\x73\x73\137\156\157\164\x69\x63\145\x2c\143\x68\x65\143\153\137\x73\164\x61\x74\165\163\x5f\162\x65\146\165\x73\x65\x5f\156\x6f\164\x69\143\145\x2c\163\x65\156\x64\x5f\156\157\x74\151\x63\145"; goto OU0DU; OU0DU: $this->userService = new FlashUserService(); goto QoOJi; GtP4o: $this->table_name = "\154\x6f\156\x61\153\x69\x6e\x67\137\147\151\146\164\x5f\163\x68\157\x70\137\164\160\154\x5f\164\x65\155\160\x6c\141\x74\x65\137\x63\157\x6e\146\x69\147"; goto INZGN; QoOJi: } public function updateTplConfigByUniacit($config) { goto pwvxV; o9g9s: return $config; goto s4N3g; pwvxV: $oldConfig = $this->checkConfigByUniacid($config["\x75\x6e\x69\x61\143\x69\x64"]); goto geB6Y; geB6Y: $config["\151\144"] = $oldConfig["\x69\x64"]; goto LjSLO; LjSLO: $this->updateData($config); goto o9g9s; s4N3g: } public function initTplConfig() { goto gG3HA; gG3HA: global $_W; goto GVGlj; a835t: $tplConfig = array("\165\156\x69\141\x63\x69\x64" => $uniacid, "\x67\x65\x74\137\156\x6f\164\151\143\145" => '', "\x63\x68\145\143\153\x5f\163\164\x61\x74\165\163\x5f\141\x63\x63\145\x73\x73\x5f\x6e\157\164\x69\143\x65" => '', "\143\x68\x65\x63\x6b\x5f\163\164\141\164\165\x73\137\162\x65\146\x75\x73\145\x5f\x6e\157\x74\151\143\x65" => '', "\163\x65\x6e\x64\x5f\x6e\157\x74\x69\143\x65" => ''); goto o1fFd; o1fFd: $tplConfig = $this->insertData($tplConfig); goto GLkFt; GLkFt: return $tplConfig; goto PyfxX; GVGlj: $uniacid = $_W["\x75\x6e\x69\x61\143\151\x64"]; goto a835t; PyfxX: } public function checkConfigByUniacid($uniacid = null) { goto WdeYq; nHLtJ: $config = $this->initTplConfig(); goto XL3HX; NU68V: return $config; goto OMOQq; dyWSS: $uniacid = empty($uniacid) ? $_W["\x75\x6e\x69\141\x63\x69\x64"] : $uniacid; goto YSWJe; G1WI5: if (!empty($config)) { goto tccPz; } goto nHLtJ; YSWJe: $config = pdo_fetch("\123\105\x4c\105\x43\124\x20" . $this->columns . "\40\x46\x52\117\115\40" . tablename($this->table_name) . "\x20\127\x48\105\122\x45\40\165\x6e\151\141\x63\x69\144\75\72\x75\x6e\151\141\143\x69\x64", array("\x3a\165\x6e\151\141\143\151\x64" => $uniacid)); goto G1WI5; XL3HX: tccPz: goto NU68V; WdeYq: global $_W; goto dyWSS; OMOQq: } public function sendGetGiftSuccessTplNotice($orderOrId, $url = '') { goto DBkYd; pi3Qz: $score = $this->userService->fetchUserScore($order["\157\x70\145\156\151\x64"]); goto mSonQ; oG0MR: global $_W; goto PNK4x; bBePY: throw new Exception("\xe8\xae\xa2\345\x8d\x95\344\xbf\xa1\346\201\257\xe9\x94\x99\xe8\xaf\257", 400); goto cqcVi; DBkYd: $order = null; goto uoliU; mSonQ: $template_id = $config["\x67\145\164\137\x6e\x6f\164\151\143\145"]; goto B5ngv; PNK4x: $account = $this->createWexinAccount(); goto afToI; uoliU: if (is_array($orderOrId)) { goto Bs9iP; } goto bBePY; nISml: Bs9iP: goto XB2Zh; cqcVi: goto SuQbJ; goto nISml; B5ngv: $postData = array("\x66\x69\162\x73\164" => array("\x76\141\x6c\165\145" => "\xe7\xa4\274\345\223\201\345\x85\221\xe6\215\xa2\346\x8f\x90\344\xba\244\346\x88\x90\xe5\212\237\357\xbc\x8c\344\277\xa1\xe6\x81\xaf\345\246\202\xe4\270\x8b", "\x63\157\154\157\x72" => "\x23\x46\106\66\x38\63\106"), "\153\145\171\x77\157\x72\x64\x31" => array("\166\x61\154\x75\145" => $order["\x67\x69\146\164\x5f\156\x61\155\145"], "\x63\157\x6c\x6f\x72" => "\43\106\x46\66\70\x33\106"), "\x6b\x65\171\167\x6f\162\144\x32" => array("\166\141\x6c\165\145" => $order["\x70\x72\x69\x63\x65"], "\143\157\154\x6f\162" => "\x23\106\x46\66\70\63\x46"), "\153\145\x79\167\157\x72\144\63" => array("\166\x61\x6c\x75\145" => $score, "\x63\157\154\x6f\x72" => "\x23\106\x46\66\70\63\106"), "\x6b\145\x79\167\x6f\x72\x64\64" => array("\x76\x61\x6c\165\145" => date("\x6d\xe6\234\210\x64\346\x97\xa5\x20\x48\x3a\151", $order["\x63\x72\x65\141\x74\x65\164\x69\x6d\x65"]), "\x63\157\154\x6f\x72" => "\x23\x46\106\66\70\x33\106"), "\x72\x65\x6d\x61\x72\153" => array("\x76\x61\154\x75\145" => "\347\244\xbc\xe5\x93\201\345\x85\x91\xe6\215\242\350\xaf\xb7\346\261\202\xe6\210\x90\345\212\237\54\xe7\xae\241\347\220\x86\345\x91\230\345\256\xa1\xe6\xa0\270\xe9\x80\232\xe8\277\207\xe5\220\216\345\260\x86\344\xb8\272\346\x82\250\345\x8f\x91\xe6\x94\276\347\xa4\xbc\345\x93\x81", "\x63\157\x6c\157\162" => "\43\x46\x46\x36\70\63\106")); goto iGMOP; afToI: $config = $this->checkConfigByUniacid($_W["\x75\x6e\x69\x61\143\x69\x64"]); goto pi3Qz; ckCVV: SuQbJ: goto oG0MR; XB2Zh: $order = $orderOrId; goto ckCVV; sCVAc: $result = $account->sendTplNotice($order["\x6f\x70\x65\156\x69\x64"], $template_id, $postData, $url); goto poF9W; iGMOP: $sendArray = array("\157\160\x65\156\x69\144" => $order["\x6f\160\x65\x6e\x69\x64"], "\x74\145\x6d\x70\x6c\141\x74\x65\x5f\x69\x64" => $template_id, "\160\157\x73\164\x44\141\164\141" => $postData, "\165\x72\154" => $url); goto sCVAc; poF9W: } public function sendGiftOrderCheckStatusAccessNotice($orderOrId, $url = '') { goto rhDFx; ZIPq4: $postData = array("\146\151\162\x73\164" => array("\166\x61\x6c\x75\x65" => "\xe6\x82\xa8\345\x85\x91\xe6\215\242\xe7\232\x84\xe7\xa4\274\xe5\x93\201\133" . $order["\147\x69\x66\164\x5f\156\x61\x6d\x65"] . "\135\345\256\241\346\240\270\351\x80\x9a\xe8\xbf\207\344\272\206", "\143\x6f\154\157\162" => "\43\x46\106\x36\70\x33\106"), "\x6b\x65\x79\167\157\x72\x64\x31" => array("\166\141\154\165\x65" => "\xe9\x80\x9a\350\xbf\207", "\143\x6f\x6c\157\x72" => "\43\x46\106\x36\70\x33\106"), "\x6b\x65\171\167\157\x72\x64\62" => array("\166\141\154\165\x65" => date("\x6d\346\x9c\210\x64\xe6\x97\245\x20\x48\72\151", $order["\x75\x70\x64\141\164\x65\164\x69\155\145"]), "\143\157\x6c\x6f\162" => "\x23\106\106\x36\x38\63\106")); goto ubpy6; JCP42: if (is_array($orderOrId)) { goto TClkK; } goto RqKKH; zTRlj: $template_id = $config["\143\x68\x65\143\x6b\137\x73\x74\x61\164\165\163\x5f\x61\143\143\x65\163\x73\137\x6e\157\164\x69\x63\145"]; goto ZIPq4; PTK5j: goto A4voO; goto S6oYA; vxWdn: $config = $this->checkConfigByUniacid($_W["\165\x6e\151\x61\143\151\x64"]); goto zTRlj; S6oYA: TClkK: goto b53Qf; b53Qf: $order = $orderOrId; goto JukiM; e92AJ: global $_W; goto G6QpL; ubpy6: $sendArray = array("\x6f\x70\x65\156\x69\144" => $order["\x6f\160\145\x6e\x69\144"], "\164\145\x6d\160\154\141\164\145\137\x69\144" => $template_id, "\x70\157\163\x74\x44\x61\x74\141" => $postData, "\165\x72\x6c" => $url); goto sz3TJ; rhDFx: $order = null; goto JCP42; RqKKH: throw new Exception("\350\xae\242\345\x8d\225\344\277\xa1\xe6\201\xaf\351\x94\231\xe8\257\257", 400); goto PTK5j; G6QpL: $account = $this->createWexinAccount(); goto vxWdn; sz3TJ: $result = $account->sendTplNotice($order["\x6f\160\x65\156\151\x64"], $template_id, $postData, $url); goto Mqo6b; JukiM: A4voO: goto e92AJ; Mqo6b: } public function sendGiftOrderCheckStatusRefuseNotice($orderOrId, $url = '') { goto kuBYr; gvUh2: b5C9o: goto GxPPw; KtTgl: $config = $this->checkConfigByUniacid($_W["\165\156\x69\x61\x63\x69\x64"]); goto xjRCS; fUjeQ: $sendArray = array("\x6f\x70\x65\156\151\x64" => $order["\157\160\x65\156\151\x64"], "\x74\145\155\160\x6c\x61\x74\x65\x5f\151\144" => $template_id, "\160\157\x73\x74\104\141\164\x61" => $postData, "\x75\x72\x6c" => $url); goto tSGr1; JhTu5: vKuia: goto Vv2tP; kuBYr: $order = null; goto uOFUy; uOFUy: if (is_array($orderOrId)) { goto b5C9o; } goto hMI61; hMI61: throw new Exception("\xe8\xae\xa2\345\215\225\xe4\277\241\346\x81\xaf\351\x94\231\xe8\xaf\xaf", 400); goto X7h1d; GxPPw: $order = $orderOrId; goto JhTu5; xjRCS: $template_id = $config["\x63\x68\x65\143\x6b\x5f\x73\x74\141\x74\165\x73\137\x61\x63\143\145\163\x73\137\156\x6f\x74\151\143\145"]; goto Y2DN4; X7h1d: goto vKuia; goto gvUh2; xxsaj: $account = $this->createWexinAccount(); goto KtTgl; Vv2tP: global $_W; goto xxsaj; Y2DN4: $postData = array("\x66\x69\162\x73\164" => array("\x76\141\154\x75\145" => "\346\x82\250\xe5\x85\x91\xe6\215\242\347\x9a\204\xe7\244\xbc\xe5\223\x81\x5b" . $order["\147\151\x66\164\137\156\x61\155\x65"] . "\135\xe5\xae\241\346\240\xb8\346\xb2\xa1\xe6\234\x89\351\x80\x9a\350\xbf\x87", "\143\157\154\x6f\x72" => "\x23\106\106\66\x38\x33\x46"), "\153\x65\x79\167\157\162\x64\61" => array("\x76\x61\x6c\x75\x65" => "\346\234\252\xe9\x80\232\350\277\x87", "\143\x6f\x6c\157\x72" => "\43\106\106\66\70\63\x46"), "\153\x65\171\167\157\162\x64\62" => array("\x76\141\x6c\165\x65" => date("\x6d\346\234\210\x64\xe6\227\245\x20\x48\72\151", $order["\x75\x70\x64\x61\x74\145\x74\151\x6d\145"]), "\143\157\154\157\162" => "\x23\x46\x46\66\x38\x33\x46"), "\x72\145\155\141\x72\153" => array("\x76\141\154\x75\x65" => "\xe6\x82\xa8\347\x9a\x84\345\x85\221\xe6\x8d\242\347\224\xb1\xe4\272\x8e" . $order["\x72\145\x6d\141\162\x6b"] . "\346\x88\x91\xe4\xbb\254\xe6\x97\240\346\xb3\225\xe9\x80\x9a\xe8\xbf\207\357\xbc\214\xe6\210\x91\xe4\273\xac\345\267\xb2\345\260\206\xe7\244\xbc\xe5\223\x81\347\247\xaf\345\210\206\xe9\200\200\345\x9b\x9e\xe6\202\250\347\x9a\204\350\xb4\xa6\xe6\x88\xb7\xef\xbc\214\344\270\272\346\x82\250\xe5\xb8\xa6\xe6\235\245\347\x9a\204\344\xb8\x8d\344\276\xbf\xe9\x9d\x9e\xe5\270\270\xe6\x8a\xb1\xe6\xad\x89\xef\xbc\214\xe6\204\x9f\350\260\xa2\344\275\xa0\345\xaf\xb9\346\x88\x91\344\273\xac\347\232\x84\346\224\257\xe6\x8c\x81", "\x63\x6f\x6c\x6f\162" => "\x23\106\106\x36\x38\x33\106")); goto fUjeQ; tSGr1: $result = $account->sendTplNotice($order["\157\160\x65\156\x69\x64"], $template_id, $postData, $url); goto ItmhN; ItmhN: } public function sendGiftSendUpTplNotice($orderOrId, $url = '') { goto aWpyL; rIBkN: $template_id = $config["\163\145\x6e\x64\x5f\x6e\x6f\x74\x69\143\x65"]; goto uDrY1; uDrY1: $postData = array("\146\151\162\163\164" => array("\166\x61\x6c\x75\145" => "\xe6\x82\250\xe5\x85\221\xe6\x8d\242\xe7\x9a\x84\xe7\244\xbc\345\x93\x81\x5b" . $order["\x67\x69\x66\x74\x5f\156\x61\x6d\x65"] . "\x5d\345\267\262\347\273\x8f\xe5\x8f\x91\350\xb4\xa7\357\274\214\350\257\267\xe5\x85\263\346\xb3\250\347\211\xa9\xe6\265\201\344\277\241\346\x81\xaf", "\143\157\x6c\x6f\162" => "\x23\x46\x46\x36\70\63\106"), "\153\x65\171\x77\x6f\162\x64\61" => array("\x76\141\x6c\165\x65" => $order["\x67\151\x66\x74\137\x6e\141\155\x65"], "\x63\157\x6c\x6f\x72" => "\43\x46\106\66\x38\63\x46"), "\153\145\171\x77\157\x72\144\x32" => array("\166\141\154\165\x65" => "\345\277\xab\351\200\222\xe5\x85\254\345\x8f\xb8", "\x63\157\x6c\157\x72" => "\43\x46\106\x36\x38\x33\x46"), "\x6b\145\x79\x77\x6f\x72\144\63" => array("\x76\x61\x6c\x75\145" => $order["\x74\162\x61\156\163\x5f\x6e\165\155"], "\x63\x6f\154\157\162" => "\x23\106\x46\x36\x38\x33\x46"), "\x6b\x65\171\167\x6f\x72\144\x34" => array("\166\x61\x6c\165\145" => $order["\x72\145\141\x6c\x5f\x6e\141\x6d\145"] . "\50" . $order["\x74\141\162\147\145\x74"] . "\x29", "\143\x6f\x6c\x6f\x72" => "\x23\x46\106\x36\70\x33\x46"), "\162\x65\x6d\141\x72\153" => array("\x76\x61\154\x75\145" => "\xe6\202\xa8\347\232\x84\347\xa4\274\345\223\x81\xe5\xb7\262\xe7\273\x8f\347\x94\261\345\xbf\xab\351\x80\x92\345\x8f\221\xe5\x87\272\357\xbc\214\xe6\x82\250\xe5\217\xaf\344\273\245\xe5\x9c\xa8\347\231\xbe\xe5\272\246\346\237\xa5\350\257\242\350\277\220\xe5\215\225\xe5\217\xb7\xe5\205\xb3\xe6\xb3\250\347\x89\xa9\346\265\x81\345\212\250\xe6\x80\201", "\143\x6f\x6c\157\162" => "\43\106\106\x36\x38\x33\106")); goto DsbDh; tFRYH: goto hfTLC; goto r4kDe; r4kDe: MS6WS: goto uXBqY; nCNPr: $config = $this->checkConfigByUniacid($_W["\165\156\x69\x61\143\x69\x64"]); goto rIBkN; myRFK: $result = $account->sendTplNotice($order["\157\x70\145\x6e\x69\144"], $template_id, $postData, $url); goto hL0x7; E89Vo: global $_W; goto d3S_N; STGGg: hfTLC: goto E89Vo; aWpyL: $order = null; goto WXoiZ; WXoiZ: if (is_array($orderOrId)) { goto MS6WS; } goto EsWUt; d3S_N: $account = $this->createWexinAccount(); goto nCNPr; uXBqY: $order = $orderOrId; goto STGGg; DsbDh: $sendArray = array("\157\160\145\x6e\x69\x64" => $order["\x6f\160\x65\156\151\144"], "\x74\145\x6d\160\154\141\x74\x65\137\x69\x64" => $template_id, "\160\x6f\x73\x74\x44\x61\164\141" => $postData, "\165\162\154" => $url); goto myRFK; EsWUt: throw new Exception("\350\xae\xa2\345\215\225\xe4\xbf\xa1\xe6\x81\xaf\xe9\x94\x99\xe8\257\257", 400); goto tFRYH; hL0x7: } public function fetchTemplateIdByShort($shoreId) { goto pP7mV; OI3dn: $response = ihttp_post($apiUrl, array("\x74\x65\x6d\x70\154\x61\x74\145\137\151\x64\x5f\163\150\157\x72\164" => $shoreId)); goto aedxv; xWykJ: $token = $account->fetch_token(); goto iJ2Y1; iJ2Y1: $apiUrl = "\150\164\164\x70\163\72\57\57\141\x70\151\56\167\145\151\170\x69\156\56\161\161\56\x63\x6f\x6d\57\x63\147\x69\55\142\x69\x6e\x2f\164\x65\155\160\x6c\141\x74\145\x2f\141\x70\151\x5f\x61\144\x64\137\164\x65\x6d\x70\154\141\x74\x65\x3f\141\x63\143\145\x73\163\137\x74\x6f\x6b\145\x6e\75" . $token; goto j0cdF; pP7mV: global $_W; goto Xmh4p; aedxv: $result = json_decode($response["\143\x6f\x6e\x74\x65\x6e\164"], true); goto uBDop; yOCYe: RGo4G: goto YycWC; uBDop: if (!($result["\x65\162\x72\x63\157\144\x65"] != 0)) { goto RGo4G; } goto V0jM_; j0cdF: load()->func("\x63\157\x6d\x6d\x75\156\x69\x63\x61\x74\x69\x6f\156"); goto OI3dn; Xmh4p: $account = $this->createWexinAccount(); goto xWykJ; V0jM_: return error($result["\x65\162\162\143\157\x64\145"], $result["\x65\162\x72\x6d\x73\x67"]); goto yOCYe; YycWC: return $result["\164\x65\155\160\x6c\x61\164\x65\137\x69\144"]; goto z_s2h; z_s2h: } }
