<?php
 class AdminorderdetailController extends MobileBaseController { public $size = 10; public function init() { goto tM99p; c21qq: Uoo1h: goto Yxxim; tM99p: parent::init(); goto SyDB9; oMH2W: message("\351\xa1\xb5\351\235\xa2\345\x87\xba\xe9\x94\231", $this->createMobileUrl("\155\x65\x6d\x62\145\x72")); goto c21qq; SyDB9: if ($this->admin) { goto Uoo1h; } goto oMH2W; Yxxim: } public function index() { goto B9jg2; z6tLi: if (!empty($item)) { goto JK4Az; } goto SxGEg; brBGG: $item["\x67\157\157\x64\163\x6e\141\x6d\145"] = $detail[0]["\164\151\x74\x6c\145"]; goto z6tLi; hqOHu: $this->_cancelsend($id, $item); goto JaX7G; SxGEg: message("\xe6\212\261\346\xad\211\xef\xbc\214\350\xae\xa2\xe5\215\x95\xe4\270\215\xe5\xad\x98\345\234\xa8\41", referer(), "\x65\x72\x72\157\162"); goto B9WO9; JaX7G: KX3RE: goto f0CIU; GqJvF: On2oq: goto vj1kC; OKlsN: $data["\x64\145\164\x61\x69\x6c"] = $detail; goto x0wcJ; x0wcJ: $this->assign($data); goto G_l3c; ODrwk: if (!checksubmit("\x63\x6f\x6e\x66\x69\162\155\163\x65\156\144")) { goto On2oq; } goto DMuXb; nH_Cl: $item = pdo_fetch($sql, array("\72\151\x64" => $id, "\x3a\167\145\151\x64" => $this->W["\165\x6e\x69\141\143\151\x64"])); goto B5D6m; h2zs8: UcMYV: goto u_Yok; vj1kC: if (!checksubmit("\143\141\156\x63\x65\154\163\145\x6e\x64")) { goto KX3RE; } goto hqOHu; G_l3c: $this->display(); goto vhEUE; x7UER: $data["\x69\x74\x65\155"] = $item; goto OKlsN; DMuXb: $this->_confirmsend($id, $item); goto GqJvF; B9jg2: $id = intval($this->GPC["\151\144"]); goto hRt1B; IWuo1: $item["\x73\x74\141\x74\165\x73"] = self::$ORDER_STATUS[$item["\163\164\x61\x74\165\x73"]]; goto x7UER; hRt1B: $sql = "\x53\105\114\x45\103\x54\x20\12\141\56\x75\163\x65\162\x6e\x61\155\145\54\141\x2e\x6d\157\x62\151\x6c\145\54\x6f\x2e\x69\x64\54\x6f\x2e\x77\145\151\144\54\xa\x6f\x2e\157\x72\x64\x65\162\163\x6e\54\157\x2e\x72\145\155\141\x72\x6b\x2c\x6f\56\x6d\x65\x6d\142\x65\162\x69\144\54\x6f\56\x6f\162\144\145\162\x70\162\x69\143\145\x2c\x6f\56\160\x61\x79\x74\171\160\145\x2c\157\x2e\x6a\151\146\x65\156\54\x6f\56\x74\x72\x61\156\163\x69\x64\x2c\157\x2e\x63\x72\145\141\x74\x65\x74\151\155\145\x2c\141\56\x70\162\157\166\x69\156\x63\x65\x2c\x61\56\143\151\x74\x79\54\x61\56\x64\x69\163\164\x72\151\143\x74\x2c\141\x2e\141\144\x64\x72\145\163\x73\x2c\x6f\x2e\163\164\x61\x74\165\x73\54\x6f\56\x70\x61\162\x65\x6e\164\x31\54\x6f\x2e\160\141\x72\x65\x6e\164\62\x2c\x6f\x2e\160\141\162\145\156\x74\63\54\x6f\x2e\162\x65\x6d\x61\162\153\x2c\157\x2e\143\x6f\155\155\151\x73\x69\157\156\x31\54\157\x2e\x63\x6f\x6d\155\151\x73\x69\x6f\x6e\x32\54\x6f\56\x63\x6f\155\155\151\163\151\157\156\63\x2c\x6f\x2e\164\x6f\x74\x61\154\54\x6f\56\x79\165\156\x66\x65\x69\54\x6d\56\x6e\x69\x63\153\x6e\141\x6d\x65\x2c\x6d\x2e\157\x70\145\156\151\144\x2c\x6f\x2e\145\x78\x70\x72\x65\163\163\x63\x6f\x6d\x2c\157\x2e\145\x78\160\162\x65\163\163\x73\x6e\54\157\56\x66\x61\x68\x75\x6f\x74\x69\x6d\x65\x2c\157\x2e\163\150\x6f\x75\x68\x75\157\x74\151\x6d\x65\40\106\x52\x4f\x4d\40" . tablename("\x77\x67\137\146\x65\156\170\x69\x61\x6f\137\157\x72\144\145\162") . "\40\x61\163\40\x6f\40\114\x45\x46\124\40\112\117\111\x4e\x20" . tablename("\x77\x67\137\x66\x65\156\170\151\141\x6f\x5f\155\x65\x6d\x62\x65\162") . "\x20\101\x53\x20\x6d\x20\117\x4e\40\157\56\x6d\145\x6d\x62\145\x72\151\x64\75\x6d\56\151\x64\x20\x4c\x45\106\124\x20\112\x4f\x49\x4e\x20" . tablename("\x77\147\137\x66\x65\156\x78\151\x61\x6f\137\x6d\x65\x6d\x62\145\x72\137\x61\x64\144\x72\x65\x73\x73") . "\40\x41\123\40\141\x20\x4f\116\x20\157\x2e\x61\144\144\162\x65\x73\x73\x69\144\x3d\x61\56\x69\x64\40\167\150\145\162\x65\40\x6f\56\151\144\75\72\x69\144\40\x61\x6e\x64\x20\157\x2e\x77\145\x69\144\75\72\167\145\x69\144"; goto nH_Cl; EhtxA: $this->_cancelorder($item); goto h2zs8; OFYzL: $this->_doneorder($id); goto kcFSo; B5D6m: $detail = $this->OrderDetailModel->getList(["\157\162\144\145\162\137\x69\144" => $id], "\x2a"); goto brBGG; Qv1s4: if (!(!empty($item["\x70\x61\x72\145\156\164\61"]) || !empty($item["\x70\141\x72\x65\x6e\x74\x32"]) || !empty($item["\160\141\x72\x65\156\164\x33"]))) { goto CceOx; } goto e9Kds; TD5L1: foreach ($membernicknames as $key => $value) { goto slVcZ; hctKm: if ($item["\x70\141\162\x65\x6e\164\63"] == $value["\x69\x64"]) { goto b1Cj0; } goto OV7cb; ZUHOx: GNgFW: goto JA6aY; ntwwg: if ($item["\x70\141\x72\145\156\164\x32"] == $value["\x69\x64"]) { goto kVpeS; } goto hctKm; RuxSz: HVr8D: goto d5oo3; jfv2f: b1Cj0: goto HBY88; slVcZ: if ($item["\160\141\x72\x65\x6e\x74\x31"] == $value["\151\x64"]) { goto GNgFW; } goto ntwwg; JA6aY: $item["\x70\x61\x72\145\156\164\61"] = $value["\156\151\143\153\x6e\x61\155\145"]; goto miMpb; OV7cb: goto GoJ8o; goto ZUHOx; Gp4V5: $item["\160\141\162\x65\156\164\x32"] = $value["\156\151\143\x6b\x6e\x61\x6d\145"]; goto GeSaK; RQB83: GoJ8o: goto RuxSz; HBY88: $item["\x70\141\x72\145\156\x74\63"] = $value["\x6e\151\x63\x6b\156\x61\x6d\x65"]; goto RQB83; bHyXN: kVpeS: goto Gp4V5; GeSaK: goto GoJ8o; goto jfv2f; miMpb: goto GoJ8o; goto bHyXN; d5oo3: } goto zSdgk; kcFSo: aZt3J: goto Qv1s4; zSdgk: CNSij: goto yypV4; u_Yok: if (!checksubmit("\144\157\x6e\145\x6f\x72\x64\145\162")) { goto aZt3J; } goto OFYzL; B9WO9: JK4Az: goto ODrwk; e9Kds: $membernicknames = $this->MemberModel->getList(["\151\144" => [$item["\160\x61\162\145\156\x74\x31"], $item["\x70\x61\162\145\x6e\x74\x32"], $item["\x70\141\x72\145\x6e\x74\61"]]], ["\x69\144", "\x6e\x69\143\153\x6e\141\x6d\145"]); goto TD5L1; f0CIU: if (!checksubmit("\143\x61\x6e\143\145\x6c\157\x72\144\x65\162")) { goto UcMYV; } goto EhtxA; yypV4: CceOx: goto IWuo1; vhEUE: } private function _cancelorder($item) { goto stNGX; fyLYb: TJI11: goto aug9W; X8Sdz: if (!($update_order && $update_commission)) { goto bYMay; } goto W38UN; cHAKQ: $jifen = $this->module["\143\x6f\x6e\x66\151\x67"]["\170\151\141\x6a\x69\x72\x65\156\163\x68\x75"] + 0; goto v7L1a; stNGX: pdo_begin(); goto NIRlJ; aIN3M: $update_commission = true; goto hn0ZC; npKCR: pdo_commit(); goto iALvD; IHFKH: bYMay: goto jwkSa; v7L1a: gYpOJ: goto dftKR; E9TZB: Oq63a: goto mMMdT; dftKR: dJ3vG: goto IHFKH; SFcBL: if (!($item["\170\x69\x61\152\x69\137\157\x6e\x65\137\144\x69\x6e\147\144\x61\156"] == 1)) { goto gYpOJ; } goto cHAKQ; iALvD: uSYIp: goto X8Sdz; VCWKl: $this->site->sendQuXiaoFaHuo($this->module["\x63\x6f\156\146\x69\147"]["\x71\x75\170\x69\x61\157\x64\151\156\147\x64\141\x6e"], $this->W["\165\156\151\141\x63\x69\144"], $item); goto fyLYb; NIRlJ: $update_order = pdo_update("\167\x67\x5f\146\145\x6e\170\151\141\157\x5f\157\x72\144\145\162", array("\x73\x74\x61\164\165\x73" => "\55\x31"), array("\x69\144" => $item["\151\x64"])); goto LhFzO; y2JLG: pdo_rollback(); goto KMbjU; jwkSa: $this->ajaxReturn(0, "\xe5\217\x96\xe6\266\x88\350\256\xa2\345\215\x95\xe6\x88\x90\345\212\x9f"); goto j0dob; KMbjU: goto uSYIp; goto V_CX_; aug9W: $this->_quxiaoSanji($item); goto z08QH; hn0ZC: goto QQq97; goto E9TZB; NruC8: if ($update_order && $update_commission) { goto b3zFk; } goto y2JLG; LhFzO: if ($item["\x70\141\x72\145\156\164\x31"] && $item["\x63\157\x6d\155\x69\163\x69\157\x6e\61"] > 0 || $item["\160\141\x72\145\156\x74\62"] && $item["\x63\157\x6d\155\x69\163\x69\x6f\x6e\62"] > 0 || $item["\x70\x61\x72\145\x6e\x74\63"] && $item["\x63\x6f\155\x6d\x69\x73\x69\x6f\156\63"] > 0) { goto Oq63a; } goto aIN3M; V_CX_: b3zFk: goto npKCR; W38UN: if (empty($this->module["\143\157\x6e\x66\x69\147"]["\x71\165\170\x69\141\x6f\144\x69\x6e\147\144\x61\156"])) { goto TJI11; } goto VCWKl; z08QH: if (!($this->module["\143\157\x6e\x66\x69\x67"]["\x78\x69\x61\x6a\151\x72\145\x6e\x73\x68\165"] > 0)) { goto dJ3vG; } goto SFcBL; mMMdT: $update_commission = pdo_update("\x77\147\137\x66\x65\x6e\170\x69\141\x6f\x5f\x63\x6f\155\155\151\x73\163\151\157\156", array("\x73\x74\x61\x74\165\163" => 2, "\x66\x61\x68\165\157\x73\150\x69\152\x69\x61\x6e" => 0, "\165\160\x64\141\x74\x65\137\164\x69\155\145" => time()), array("\157\x72\144\x65\162\x73\156" => $item["\x6f\162\144\x65\162\163\156"])); goto bL_H2; bL_H2: QQq97: goto NruC8; j0dob: } private function _doneorder($id) { pdo_update("\167\x67\137\x66\145\x6e\x78\x69\x61\157\x5f\157\162\144\145\x72", array("\163\x74\x61\164\165\163" => "\x33"), array("\151\144" => $id)); $this->ajaxReturn(0, "\347\241\256\350\xae\244\346\224\xb6\350\xb4\xa7"); } private function _cancelsend($id, $item) { goto b3RK2; odJe2: pdo_rollback(); goto YYZfo; jZtdC: kdTKI: goto trdVP; trdVP: $this->ajaxReturn(0, "\xe5\x8f\x96\346\xb6\210\345\x8f\x91\350\xb4\247\xe6\x88\220\345\212\x9f"); goto keDQa; Oqupc: HJwz2: goto VfWkO; c2yBD: if ($update_order && $update_commission) { goto U7tPS; } goto odJe2; l90qy: U7tPS: goto sUiOt; b3RK2: pdo_begin(); goto rs7ni; sUiOt: pdo_commit(); goto jZtdC; ssBWj: if ($item["\x70\141\x72\145\156\164\61"] && $item["\143\x6f\155\155\151\x73\151\x6f\156\61"] > 0 || $item["\160\x61\162\145\156\164\x32"] && $item["\143\157\x6d\155\x69\163\x69\157\156\x32"] > 0 || $item["\160\141\162\145\x6e\x74\x33"] && $item["\x63\x6f\x6d\x6d\151\x73\151\x6f\x6e\x33"] > 0) { goto HJwz2; } goto gj5ID; YYZfo: $this->ajaxReturn(503, "\xe5\x8f\x96\xe6\266\210\xe5\x8f\221\350\xb4\247\345\244\xb1\xe8\264\xa5"); goto mX1k4; mX1k4: goto kdTKI; goto l90qy; b7M8F: PIGSp: goto c2yBD; gj5ID: $update_commission = true; goto CwjL1; rs7ni: $update_order = pdo_update("\x77\147\x5f\x66\145\156\170\x69\x61\157\137\x6f\162\x64\x65\x72", array("\163\x74\141\164\165\163" => 1), array("\x69\x64" => $id)); goto ssBWj; CwjL1: goto PIGSp; goto Oqupc; VfWkO: $update_commission = pdo_update("\x77\x67\137\146\x65\156\x78\151\x61\x6f\x5f\x63\x6f\x6d\x6d\151\x73\x73\151\x6f\156", array("\146\141\150\x75\157\163\x68\151\x6a\151\141\x6e" => 0, "\x75\160\144\141\x74\145\137\164\151\155\145" => time()), array("\x6f\162\144\x65\x72\x73\156" => $item["\157\162\144\x65\162\163\x6e"])); goto b7M8F; keDQa: } private function _confirmsend($id, $item) { goto kce5I; KHKUi: $update_order = pdo_update("\167\x67\x5f\146\x65\x6e\x78\x69\141\157\x5f\x6f\162\144\145\162", array("\163\x74\x61\164\x75\163" => 2, "\x65\170\160\162\145\163\x73\143\x6f\155" => $this->GPC["\x65\x78\160\162\145\x73\163\x63\157\x6d"], "\145\170\x70\162\x65\163\x73\163\156" => $this->GPC["\145\170\x70\x72\145\x73\x73\163\156"], "\x66\x61\150\165\157\164\x69\x6d\x65" => time()), array("\151\144" => $id)); goto EBH7z; F8fRG: goto BMU9j; goto HUnBW; jLlK9: goto uBjK_; goto fkkcW; SNnU_: $this->ajaxReturn(503, "\xe8\257\xb7\350\xbe\223\345\x85\xa5\350\xae\242\345\x8d\x95\345\217\267"); goto LAIe5; fzktG: $this->ajaxReturn(503, "\345\217\221\xe8\264\247\345\244\xb1\350\264\xa5"); goto F8fRG; ODi7S: $update_commission = true; goto jLlK9; MVtd_: $this->site->fahuotongzhi($item["\157\x70\145\x6e\x69\144"], $this->W["\x75\x6e\151\x61\143\x69\144"], $this->module["\143\157\x6e\146\x69\147"]["\146\x61\150\165\157\x74\157\156\x67\x7a\x68\x69"], $this->GPC["\x65\x78\160\162\x65\163\x73\x63\157\155"], $this->GPC["\145\170\160\x72\145\x73\x73\x73\x6e"], $item["\x67\x6f\157\144\x73\x6e\x61\x6d\145"], $item["\164\x6f\x74\141\154"], $dizhiinfo); goto yda9A; SOTsk: uBjK_: goto gL8Dr; V4GRr: pdo_rollback(); goto fzktG; pEDA2: $this->ajaxReturn(503, "\345\x8f\221\xe8\xb4\247\346\210\220\xe5\212\x9f"); goto C9u5m; Yb0Iu: if (empty($this->module["\x63\x6f\156\x66\x69\x67"]["\146\x61\150\x75\157\x74\x6f\156\147\172\150\x69"])) { goto D5PyS; } goto vk7wJ; vk7wJ: $dizhiinfo = $item["\x75\x73\x65\162\156\141\x6d\145"] . $item["\155\x6f\x62\x69\x6c\145"] . $item["\x70\x72\x6f\x76\x69\156\143\145"] . $item["\x63\151\x74\x79"] . $item["\144\151\x73\164\162\x69\143\x74"] . $item["\141\144\x64\162\x65\163\163"]; goto MVtd_; aFtZF: $update_commission = pdo_update("\167\147\x5f\x66\x65\x6e\170\x69\x61\157\137\143\157\x6d\x6d\151\163\x73\x69\157\x6e", array("\146\141\x68\x75\x6f\163\x68\x69\x6a\x69\x61\156" => time()), array("\157\162\144\145\162\163\x6e" => $item["\157\x72\x64\145\162\163\156"])); goto SOTsk; EBH7z: if ($item["\x70\x61\x72\x65\156\164\61"] && $item["\x63\x6f\155\x6d\151\x73\x69\157\156\x31"] > 0 || $item["\160\x61\x72\x65\x6e\164\62"] && $item["\143\157\155\x6d\x69\x73\x69\157\156\62"] > 0 || $item["\x70\141\x72\145\x6e\x74\x33"] && $item["\143\x6f\155\155\x69\x73\x69\x6f\x6e\63"] > 0) { goto HIV2k; } goto ODi7S; W7ldR: BMU9j: goto Yb0Iu; LAIe5: l6u3s: goto e30bW; HUnBW: ytvnJ: goto WXywI; e30bW: pdo_begin(); goto KHKUi; WXywI: pdo_commit(); goto W7ldR; gL8Dr: if ($update_order && $update_commission) { goto ytvnJ; } goto V4GRr; kce5I: if (!(!empty($this->GPC["\x69\x73\x65\x78\x70\x72\x65\x73\163"]) && empty($this->GPC["\145\170\160\x72\145\163\163\163\156"]))) { goto l6u3s; } goto SNnU_; fkkcW: HIV2k: goto aFtZF; yda9A: D5PyS: goto pEDA2; C9u5m: } public function addmarket() { goto ljlB0; RPvel: $market = trim($_GET["\155\x61\162\x6b\145\x74"]); goto VH1kU; TeiCN: $this->ajaxReturn(0, ''); goto mX6bB; VH1kU: $this->OrderDetailModel->update(["\151\x64" => $id], ["\x72\x65\155\141\x72\153" => $market]); goto TeiCN; ljlB0: $id = intval($_GET["\x69\x64"]); goto RPvel; mX6bB: } private function _quxiaoSanji($order) { goto AgEJ1; UjDa8: $level = $this->site->configs["\x63\x6f\156\146\x69\x67"]["\x6c\145\166\x65\x6c"]; goto lZWWq; W7Kf9: if (!($parent3 && $jifen3 > 0 && $level > 2)) { goto tsmMu; } goto WA8N3; tfwpm: tsmMu: goto seYWH; FOeEP: MAdcJ: goto UjDa8; AgEJ1: pdo_update("\167\147\x5f\146\x65\156\x78\151\141\157\137\x6d\x65\x6d\x62\x65\x72", ["\143\157\x6e\163\x75\x6d\x65\x20\x2d\75" => $order["\x6f\x72\144\x65\162\160\162\x69\x63\145"], "\157\162\x64\x65\x72\x5f\156\x75\155\x20\x2d\x3d" => 1], ["\151\144" => $order["\x6d\145\155\x62\x65\162\151\144"], "\x6f\x72\144\145\x72\x5f\x6e\165\155\40\x3e\x3d" => 1, "\143\x6f\156\163\165\155\x65\40\x3e\75" => $order["\157\162\144\x65\x72\x70\x72\x69\x63\x65"]]); goto RFrqg; Yvw7B: $parent2 = $order["\x70\141\162\145\156\x74\62"]; goto u1ILe; lZWWq: if (!($this->site->configs["\143\x6f\156\146\151\147"]["\170\x69\141\x6a\x69\152\151\x66\145\x6e"] > 0 && $order["\152\x69\146\x65\156"])) { goto dZtjf; } goto Htv6K; pdEYt: Rb1y3: goto H26Ih; xPuXd: $jifen3 = intval($jifen2 * $this->site->configs["\x63\157\x6e\x66\151\147"]["\170\x69\x61\152\151\152\151\146\145\156"] / 100); goto K72Pu; AEJE2: $this->addJifen($parent2, -$jifen2, "\xe8\256\xa2\xe5\x8d\225\x3a" . $order["\157\162\144\145\162\163\156"], [], $order["\x77\145\x69\x64"]); goto JqaDB; K72Pu: if (!($parent2 && $jifen2 > 0 && $level > 1)) { goto ved4J; } goto AEJE2; RFrqg: if (!$order["\x6a\151\x66\x65\x6e"]) { goto MAdcJ; } goto D3fWW; VMJwv: $parent3 = $order["\160\x61\x72\x65\x6e\x74\x33"]; goto xPuXd; D3fWW: $this->addJifen($order["\x6d\145\x6d\x62\145\x72\151\x64"], -$order["\152\x69\146\x65\x6e"], "\350\207\252\345\xb7\261\345\x8f\226\346\xb6\x88\xe8\xae\242\345\215\225" . $order["\157\162\144\145\162\x73\156"] . "\xe5\x87\217\345\xb0\x91\347\247\xaf\xe5\x88\206" . $order["\152\x69\x66\x65\156"], [], $order["\x77\145\151\144"]); goto FOeEP; seYWH: if (!($parent1 && $jifen1 > 0)) { goto Rb1y3; } goto r3e8M; u1ILe: $jifen2 = intval($jifen1 * $this->site->configs["\143\x6f\156\x66\151\147"]["\170\x69\141\152\151\152\x69\x66\x65\x6e"] / 100); goto VMJwv; H26Ih: dZtjf: goto DwNd5; Htv6K: $parent1 = $order["\x70\141\162\145\x6e\x74\61"]; goto ucxzw; JqaDB: ved4J: goto W7Kf9; r3e8M: $this->addJifen($parent1, -$jifen1, "\xe8\xae\xa2\xe5\x8d\x95\72" . $order["\x6f\x72\x64\145\162\163\x6e"], [], $order["\167\145\151\144"]); goto pdEYt; WA8N3: $this->addJifen($parent3, -$jifen3, "\xe8\256\xa2\345\215\x95\x3a" . $order["\x6f\162\144\145\x72\163\156"], [], $order["\x77\145\x69\144"]); goto tfwpm; ucxzw: $jifen1 = intval($order["\x6a\151\146\x65\x6e"] * $this->site->configs["\143\x6f\x6e\146\151\x67"]["\170\151\141\152\x69\x6a\x69\146\x65\x6e"] / 100); goto Yvw7B; DwNd5: } }