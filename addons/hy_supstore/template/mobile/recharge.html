<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>会员充值</title>
    <meta name="x5-orientation" content="portrait">
    <meta name="screen-orientation" content="portrait">
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
    <meta content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport">
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link href='../addons/hy_supstore/template/mobile/css/common.css' rel='stylesheet' type='text/css'>
    <link href='../addons/hy_supstore/template/mobile/css/mylist.css' rel='stylesheet' type='text/css'>
    <style>
   
    .mr5{
        margin-right: 5px;
    }

    /*选择店铺*/

    .select-store {
        margin: 10px auto;
        height: 50px;
        width: 100%;
        background-color: #fff;
    }

    .select-store span{
        display: inline-block;
        color: #666;
        line-height: 50px;
        text-align: center;
        padding: 0 5px;
    }

    .select-store a{
        display: inline-block;
        height: 30px;
        line-height: 30px;
        padding: 0 8px;
        background: linear-gradient(to right, #5a92ff , #4078e4);
        color: #fff;
        white-space: nowrap;
        text-align: center;
        font-size: 13px;
        border: none;
        border-radius: 2px;
        cursor: pointer;
    }

    .select-content{
        width: 100%;
        padding: 0 10px 0 10px;
    }

    /*选择店铺*/

    /*充值卡片*/

    .rechage-card{
        width: 100%;
        margin: 0 auto;
        margin-bottom: 10px;
        border: 1px solid #ebebeb;
        padding: 16px 10px;
        position: relative;
        background-color: #fff;
        border-radius: 3px;
        box-shadow: 0 2px 5px 0 rgba(0,0,0,.1);
        overflow: hidden;
    }
    
    /*角标*/
    .rechage-card .corner-mark{
        color: #fff;
        height: 36px;
        padding-top: 10px;
        width: 80px;
        position: absolute;
        left: -28px;
        top: -6px;
        text-align: center;
        line-height: 30px;
        font-family: "黑体";
        -moz-transform: rotate(45deg);
        -webkit-transform: rotate(45deg);
        -o-transform: rotate(45deg);
        -ms-transform: rotate(45deg);
        transform: rotate(-45deg);
        background: #D24161;
        background: -webkit-linear-gradient(#6BE04E,#22D469);
        background: -o-linear-gradient(#6BE04E,#22D469);
        background: -moz-linear-gradient(#6BE04E,#22D469);
        background: linear-gradient(#6BE04E,#22D469);
    }

    .rechage-card .card-top{
        display: block;
        width: 100%;
        padding-right: 70px;
        overflow: hidden;
    }

    .rechage-card .card-top .left{
        display: inline-block;
        float: left;
        font-size: 20px;
        padding-left: 20px;
        line-height: 20px;
        color: #e6352d;
        font-weight: bold;
    }

    .rechage-card .card-top .left .yen{
        float: left;
    }

    .rechage-card .card-top .right{
        float: left;
        max-width: 180px;
        font-size: 15px;
        font-weight: bold;
        color: #3d3d3d;
        margin-top: 4px;
        margin-left: 5px;
        overflow:hidden;     
        white-space:nowrap;  
        text-overflow:ellipsis;
    }
    @media screen and (max-width:340px) {
        .rechage-card .card-top .right{
            max-width: 105px;
        }
    }
    
    .rechage-card .card-bottom{
        overflow: hidden;
        font-size: 12px;
        color: #626262;
        margin-left: 26px;
        margin-top: 10px;
        padding-right: 80px;
        min-height: 40px;
    }

    .rechage-card .card-bottom ul li{
        width: 100%;
        line-height: 18px;
        font-size: 12px;
        color: #524b4b;
        overflow:hidden;     
        white-space:nowrap;  
        text-overflow:ellipsis;
    }

    .rechage-card .card-bottom ul li i{
        width: 20px;
    }

    .rechage-card .recharge-btn{
        display: block;
        position: absolute;
        top: 16px;
        right: 15px;
        margin: 0 auto;
        background-color: #ed4c54;
        border-radius: 30px;
        width: 54px;
        line-height: 24px;
        text-align: center;
        color: #fff;
        font-size: 12px;
    }

    .rechage-card .store-btn{
        display: block;
        position: absolute;
        bottom: 16px;
        right: 15px;
        margin: 0 auto;
        background: linear-gradient(to right, #5a92ff , #4078e4);
        width: 54px;
        line-height: 24px;
        text-align: center;
        color: #fff;
        font-size: 12px;
    }

    /*充值卡片*/
    </style>
</head>

<body>
    <div class="wrapper">
        <div class="my-list-header">
            <div class="my-nav-list-box">
                <div class="list-item">
                    <a class="my-current" href="{php echo $this->createMobileUrl('recharge')}">
                        充值中心
                    </a>
                </div>
                <div class="list-item">
                    <a href="{php echo $this->createMobileUrl('rechargelog')}">
                        <span>充值记录</span>
                    </a>
                </div>
            </div>
        </div>
        <div class="select-store">
            <span style="padding-left: 15px;">店铺规则:</span>
            <a onClick="javscript:openview();">选择店面</a>
            <span>已选店铺:</span>
            <span>{if $storename}{$storename}{else}未选{/if}</span>
        </div>
        {if $storeid}
        <!-- 选择店铺规则 -->
        <div class="select-content store">
            {loop $rulelist $item}
            <div class="rechage-card">
                <div class="corner-mark">店铺</div>
                <div class="card-top">
                    <div class="left">
                        <span class="yen">￥</span>
                        <span class="money">{if floor($item['credit2']) == $item['credit2']}{php echo floor($item['credit2'])}{else}{$item['credit2']}{/if} </span>
                    </div>
                    <div class="right">
                    充值到{$storename}
                    </div>
                </div>
                <div class="card-bottom">
                    <ul>
                        {if $item['credit3']!=0}
                        <li><i class="fa fa-cny"></i>送余额{$item['credit3']}元</li>
                        {/if}
                        {if $item['credit1']!=0}
                        <li><i class="fa fa-database"></i>送积分{$item['credit1']}个</li>
                        {/if}
                        {if $item['couponlist']}
                        <li><i class="fa fa-bookmark"></i>送
                        {loop $item['couponlist'] $itemCoupon}
                        <span class="mr5">{$itemCoupon['title']}优惠券{$itemCoupon['couponnum']}张</span>
                        {/loop}
                        </li>
                        {/if}
                        {if $item['oncecardlist']}
                        <li><i class="fa fa-credit-card"></i>{if $item['iscredit']==1}购买{else}送{/if}
                        {loop $item['oncecardlist'] $itemOncard}
                        <span class="mr5">{$itemOncard['title']}{$itemOncard['oncecardnum']}张</span>
                        {/loop}
                        </li>
                        {/if}
                    </ul>
                </div>
                <div class="recharge-btn" onclick="javascript:rechargesub({$item['credit2']},{$storeid},{$item['id']});">去充值</div>
                <a href="{php echo $this->createMobileUrl('storelist',array('op'=>'info','id'=>$storeid))}" class="store-btn" >去店铺</a>
            </div>
            {/loop}
        </div>
        <!-- 选择店铺规则 --> 
        {else}
        <!-- 推荐规则 -->
        <div class="select-content recommend">
            {loop $rulelistRecommend $itemRe}
                {loop $itemRe $item}
                <div class="rechage-card">
                    <div class="corner-mark">推荐</div>
                    <div class="card-top">
                        <div class="left">
                            <span class="yen">￥</span>
                            <span class="money">{if floor($item['credit2']) == $item['credit2']}{php echo floor($item['credit2'])}{else}{$item['credit2']}{/if}</span>
                        </div>
                        <div class="right">
                        充值到{$item['storename']}
                        </div>
                    </div>
                    <div class="card-bottom">
                        <ul>
                            {if $item['credit3']!=0}
                            <li><i class="fa fa-cny"></i>送余额{$item['credit3']}元</li>
                            {/if}
                            {if $item['credit1']!=0}
                            <li><i class="fa fa-database"></i>送积分{$item['credit1']}个</li>
                            {/if}
                            {if $item['couponlist']}
                            <li><i class="fa fa-bookmark"></i>送
                            {loop $item['couponlist'] $itemCoupon}
                            <span class="mr5">{$itemCoupon['title']}优惠券{$itemCoupon['couponnum']}张</span>
                            {/loop}
                            </li>
                            {/if}
                            {if $item['oncecardlist']}
                            <li><i class="fa fa-credit-card"></i>{if $item['iscredit']==1}购买{else}送{/if}
                            {loop $item['oncecardlist'] $itemOncard}
                            <span class="mr5">{$itemOncard['title']}{$itemOncard['oncecardnum']}张</span>
                            {/loop}
                            </li>
                            {/if}
                        </ul>
                    </div>
                    <div class="recharge-btn" onclick="javascript:rechargesub({$item['credit2']},{$item['storeid']},{$item['id']});">去充值</div>
                    <a href="{php echo $this->createMobileUrl('storelist',array('op'=>'info','id'=>$item['storeid']))}" class="store-btn" >去店铺</a>
                </div>
                {/loop}
            {/loop}
        </div>
        <!-- 推荐规则 --> 
        {/if} 
    </div>
    <form method="post" enctype="multipart/form-data" id="formRecharge">
        <input type="hidden" name="amount" id="amount" />
        <input type="hidden" name="ruleid" id="ruleid" />
        <input type="hidden" name="token" value="{$_W['token']}" />
        <input type="hidden" name="storeid" value="{$_GPC['storeid']}" />
        <input type="hidden" name="wxtoken" value="{$wxtoken}" />
    </form>
    <!--底部导航-->
    {template 'footerindex'}

    <script src="../addons/hy_supstore/template/layui/layui.js"></script>
    <script src="../addons/hy_supstore/template/js/jquery-3.2.1.min.js"></script>
    <script>
    layui.use(['form', 'layer', 'table', 'element'], function() {
        var $ = layui.jquery,
            form = layui.form,
            layer = layui.layer,
            element = layui.element;
    });

    function openview() {
        layer.open({
            type: 2,
            title: false,
            closeBtn: false,
            maxmin: false,
            scrollbar: false,
            shadeClose: true, //点击遮罩关闭层
            offset: 'lt',
            area: ['100%', '100%'],
            content: "{php echo $this->createMobileUrl('query')}"
        });
    }

    function select_entry(o) {
        //跳转
        window.location.href = "{php echo $this->createMobileUrl('recharge')}&storeid=" + o;
    }

    var count = 0;

    function rechargesub(amount,storeid,ruleid) {
        if(storeid){
            $('input[name="storeid"]').val(storeid);
        }
        $("#amount").val(amount);
        $("#ruleid").val(ruleid);
        count++;
        $("#formRecharge").submit();
    }
    </script>
</body>

</html>