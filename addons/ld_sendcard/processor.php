<?php
 goto VHv8s; VHv8s: defined("\111\116\x5f\x49\x41") or die("\101\143\143\145\163\x73\x20\x44\145\x6e\x69\145\x64"); goto a94eH; a94eH: load()->classs("\x77\145\x69\x78\x69\x6e\x2e\x61\x63\x63\x6f\165\x6e\164"); goto VRMIg; VRMIg: class Ld_SENDCARDModuleProcessor extends WeModuleProcessor { public function respond() { goto YQBaW; YQBaW: global $_W; goto kgOqF; KVqOL: $account = WeAccount::create(); goto ymQx_; FaszZ: d6NTl: goto yt12D; yt12D: SxXO_: goto jfjOe; jmeJP: switch ($activity["\164\x79\x70\x65"]) { case "\61": goto KIhF0; ZjFE8: k91sr: goto gwipc; KIhF0: $msg = array("\x74\x6f\x75\163\145\x72" => $openid, "\155\163\147\x74\x79\160\x65" => "\167\170\x63\141\x72\x64", "\167\x78\x63\x61\162\144" => array("\143\141\x72\144\x5f\x69\x64" => $activity["\x63\x61\x72\x64\151\144"])); goto zKTpz; LI4W8: $text = $res["\x6d\145\163\x73\x61\x67\145"]; goto ZjFE8; gwipc: return $this->respText($text); goto aHJxP; gVpei: if (is_error($res)) { goto KNpHp; } goto gF0Bn; aHJxP: goto SxXO_; goto l5EwP; gF0Bn: $text = "\xe6\201\255\xe5\x96\x9c\357\xbc\x81\xe9\xa2\x86\xe5\x8f\x96\xe6\210\x90\xe5\212\237\357\274\x81"; goto VRAZd; zKTpz: $res = $account->sendCustomNotice($msg); goto gVpei; UrBtl: KNpHp: goto LI4W8; VRAZd: goto k91sr; goto UrBtl; l5EwP: case "\x32": goto MiGN1; l7Qta: nDaxq: goto vv5Vb; Vi8uw: if (is_error($res)) { goto HJ6Os; } goto em54W; uOeK6: HJ6Os: goto OSxTf; vv5Vb: return $this->respText($text); goto MwVi9; em54W: $text = "\xe6\x81\255\xe5\226\234\357\xbc\x81\xe9\xa2\206\345\217\226\xe6\x88\x90\xe5\212\237\357\274\201"; goto Z7FLK; MwVi9: goto SxXO_; goto z1mH_; OSxTf: $text = $res["\x6d\145\163\163\141\x67\x65"]; goto l7Qta; MiGN1: $res = $this->senddjq($settings, $activity["\143\141\x72\x64\151\144"], $openid); goto Vi8uw; Z7FLK: goto nDaxq; goto uOeK6; z1mH_: default: goto SxXO_; } goto FaszZ; tXjzJ: $rid = $this->rule; goto Mrb3j; ymQx_: $event = $this->message["\x65\x76\x65\156\164"]; goto tXjzJ; O_yf_: $openid = $this->message["\x66\162\157\x6d"]; goto jmeJP; Mrb3j: $activity = pdo_get("\154\144\x5f\163\x65\156\144\x63\x61\162\x64\x5f\x62\141\163\145", array("\162\x69\x64" => $rid, "\x77\x65\151\x64" => $_W["\x75\x6e\151\x61\143\151\144"])); goto O_yf_; kgOqF: $settings = $this->module["\x63\157\156\x66\x69\x67"]; goto KVqOL; jfjOe: } public function senddjq($config, $coupon_stock_id, $openid) { goto whOwq; v00pZ: if ($e5VxU) { goto yHYSP; } goto sc2YR; gkFrD: return TRUE; goto xaLgX; kIulz: $ires = ihttp_request($url, $xml, $extras); goto UwUQ2; whOwq: $url = "\150\164\x74\160\163\x3a\x2f\x2f\141\x70\151\x2e\155\x63\150\x2e\x77\x65\x69\170\151\156\56\x71\x71\x2e\x63\x6f\x6d\57\155\155\160\x61\x79\x6d\153\x74\164\x72\x61\156\163\146\145\162\x73\57\163\145\x6e\x64\137\x63\157\165\160\x6f\156"; goto fjG6P; JKRxX: $data["\163\x69\x67\x6e"] = $this->getsign($data, $config["\141\160\x70\x6b\x65\x79"]); goto JJjam; OcslP: yHYSP: goto gkFrD; qVNDk: $e5VxU = !($res["\162\x65\163\x75\154\x74\137\x63\x6f\144\145"] == "\106\x41\x49\x4c"); goto v00pZ; THdQ7: $extras["\x43\x55\x52\114\117\120\124\137\123\123\114\x43\x45\x52\x54"] = ATTACHMENT_ROOT . "\x2f" . $config["\x61\x70\x69\x63\x6c\151\x65\x6e\x74\x5f\143\x65\162\164"]; goto HaIYi; S9eVI: $extras["\103\x55\122\114\117\120\x54\137\x43\x41\x49\x4e\106\117"] = ATTACHMENT_ROOT . "\x2f" . $config["\x72\157\157\164\x63\141"]; goto THdQ7; HaIYi: $extras["\103\x55\x52\x4c\117\120\124\137\123\123\114\x4b\105\x59"] = ATTACHMENT_ROOT . "\x2f" . $config["\141\x70\151\x63\x6c\151\145\x6e\x74\x5f\x6b\145\x79"]; goto IzgMi; sc2YR: return error(-1, "\xe5\217\221\351\200\201\xe5\xa4\xb1\xe8\264\xa5\xef\274\214\xe9\x94\x99\350\257\257\344\273\243\xe7\240\x81\xef\274\232{$res["\145\x72\162\137\x63\x6f\144\x65"]}\x2c\xe9\x94\x99\xe8\257\xaf\344\xbf\241\xe6\x81\257\357\274\232{$res["\145\x72\x72\x5f\x63\x6f\x64\145\x5f\x64\x65\x73"]}"); goto OcslP; UwUQ2: $res = xml2array($ires["\x63\157\x6e\164\145\x6e\x74"]); goto AcUV1; IzgMi: load()->func("\x63\157\x6d\155\x75\156\x69\x63\141\x74\151\157\x6e"); goto kIulz; AcUV1: WeUtility::logging("\345\217\221\346\224\xbe\xe4\273\xa3\xe9\207\221\xe5\x88\xb8", var_export($res, true)); goto qVNDk; JJjam: $xml = array2xml($data); goto S9eVI; fjG6P: $data = array("\x61\160\160\151\144" => $config["\141\160\x70\x69\x64"], "\143\157\x75\x70\157\x6e\x5f\x73\164\157\x63\x6b\137\x69\x64" => $coupon_stock_id, "\x6d\x63\150\x5f\x69\x64" => $config["\155\143\150\x5f\151\x64"], "\x6e\x6f\156\x63\145\x5f\x73\x74\162" => random(10), "\157\x70\x65\x6e\151\x64" => $openid, "\x6f\160\145\156\151\x64\137\x63\x6f\x75\156\164" => 1, "\x70\141\162\x74\156\x65\x72\137\164\x72\x61\144\145\137\156\x6f" => time() . random(6)); goto JKRxX; xaLgX: } public function getsign($signdata, $key) { goto Ns1Fb; Auvqg: $str = ''; goto x50II; AvVu3: return $sign; goto Z0Dr4; ZiJ6j: hhgXE: goto EuWNK; EuWNK: $str .= "\153\x65\171\x3d" . $key; goto hQvGA; Ns1Fb: ksort($signdata, SORT_STRING); goto Auvqg; hQvGA: $sign = strtoupper(MD5($str)); goto AvVu3; x50II: foreach ($signdata as $k => $v) { $str .= $k . "\75" . $v . "\46"; qddKK: } goto ZiJ6j; Z0Dr4: } }