<?php
/*
 __________________________________________________
|  Encode by BajieTeam on we7                      |
|__________________________________________________|
*/
 class GiftShopQrcodeService { public function generateQrcode() { goto kWBAq; yONB8: $result["\163\143\145\x6e\x65\x5f\151\144"] = $barcode["\141\143\164\151\157\x6e\137\x69\156\146\x6f"]["\163\x63\x65\x6e\145"]["\x73\x63\x65\156\145\x5f\x69\x64"]; goto u9vm9; Cg4Ta: $qrcode = $account->barCodeCreateDisposable($barcode); goto DYIml; KufTL: $scene_id = $this->generate_scene_id($_W["\x61\143\x63\157\x75\x6e\x74"]["\141\x63\151\144"]); goto eZEl1; sea9_: wYQUj: goto dTqal; DYIml: if ($qrcode["\145\162\x72\156\157"] != -1 && !empty($qrcode["\x74\151\x63\x6b\x65\164"])) { goto wYQUj; } goto GOus1; A0dKI: HB8iL: goto yONB8; u9vm9: return $result; goto ZmqKw; fbFo8: $result = array(); goto GQ2tl; eZEl1: $barcode = array("\x65\x78\x70\x69\162\x65\x5f\x73\x65\x63\x6f\156\144\163" => 604800, "\141\x63\164\151\157\156\x5f\156\141\x6d\145" => "\121\x52\137\123\x43\x45\x4e\x45", "\141\143\x74\x69\x6f\x6e\137\151\156\x66\157" => array("\163\143\145\x6e\x65" => array("\163\x63\x65\x6e\145\x5f\151\x64" => $scene_id))); goto Cg4Ta; kWBAq: global $_W; goto fbFo8; Q0qtN: $result["\161\x72\143\157\144\145"] = $qrcode_url; goto HA38B; dTqal: $qrcode_url = "\x68\x74\x74\x70\x73\72\57\57\155\x70\56\167\x65\151\x78\x69\156\56\161\161\56\143\157\155\57\x63\147\151\x2d\x62\151\156\x2f\x73\x68\x6f\x77\x71\162\143\157\x64\x65\77\x74\x69\143\x6b\x65\164\x3d" . urlencode($qrcode["\x74\x69\143\x6b\145\x74"]); goto Q0qtN; HA38B: $result["\161\x72\143\157\x64\x65\x5f\165\x70\144\x61\x74\145\x74\151\x6d\145"] = time(); goto exqQd; exqQd: $result["\x73\143\145\x6e\145\x5f\x69\144"] = $scene_id; goto A0dKI; GOus1: throw new Exception("\xe5\xbe\xae\344\xbf\xa1\345\x8f\267\346\x97\240\346\235\x83\351\x99\x90\xe7\x94\x9f\xe6\x88\x90\344\272\x8c\xe7\xbb\264\xe7\xa0\x81", 7400); goto X8pEO; X8pEO: goto HB8iL; goto sea9_; GQ2tl: load()->classs("\167\145\x69\170\151\x6e\x2e\141\143\143\157\x75\x6e\164"); goto redn5; redn5: $account = WeiXinAccount::create($_W["\x61\143\x63\157\x75\x6e\164"]["\141\x63\x69\x64"]); goto KufTL; ZmqKw: } private function generate_scene_id($uniacid) { goto tynqR; tynqR: $max = pdo_fetch("\x53\105\x4c\105\x43\x54\x20\165\156\151\141\x63\151\144\x2c\x6d\141\x78\x5f\x73\x63\145\x6e\x65\137\151\x64\x20\106\x52\x4f\x4d\x20" . tablename("\154\x6f\156\141\x6b\x69\156\x67\137\163\x75\160\145\162\x74\141\163\153\x5f\x6d\x61\x78\x5f\x73\x63\145\156\145") . "\x20\127\x48\105\x52\x45\x20\165\x6e\x69\141\143\151\144\40\x3d\x3a\x75\156\x69\141\x63\x69\x64", array("\x3a\165\x6e\x69\141\x63\151\x64" => $uniacid)); goto QzcVy; QzcVy: if (empty($max)) { goto knUU_; } goto NztTb; PrDej: pdo_insert("\154\157\156\x61\153\x69\156\147\137\x73\x75\160\x65\x72\164\141\x73\x6b\137\155\x61\x78\137\x73\x63\145\x6e\x65", $data); goto H2YTX; LzBpX: return $scene_id; goto FcXtP; JGlIz: knUU_: goto sw6ur; mW5Gf: reBp7: goto ysL_9; NztTb: $scene_id = $max["\x6d\141\170\137\x73\143\145\x6e\x65\137\x69\x64"] + 1; goto eFTqC; BEJJa: pdo_update("\154\x6f\156\141\153\151\156\x67\137\163\165\x70\x65\x72\x74\141\163\153\137\x6d\x61\x78\x5f\163\x63\145\156\145", $data, array("\165\156\151\x61\x63\x69\x64" => $uniacid)); goto LzBpX; sw6ur: $data = array("\x75\x6e\x69\141\x63\x69\x64" => $uniacid, "\x6d\x61\x78\x5f\x73\x63\145\156\x65\x5f\x69\x64" => 1); goto PrDej; H2YTX: return 1; goto mW5Gf; FcXtP: goto reBp7; goto JGlIz; eFTqC: $data = array("\x75\x6e\151\141\143\x69\144" => $uniacid, "\x6d\141\x78\x5f\x73\x63\145\x6e\x65\x5f\151\x64" => $scene_id); goto BEJJa; ysL_9: } }
