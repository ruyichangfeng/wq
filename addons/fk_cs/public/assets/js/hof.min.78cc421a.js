!function(a,b){a.ApplyAdmin=b()}(this,function(){function a(a,b){var e={opername:"tribe_cgi",module:"post",ver1:c,ver3:d,action:a};for(var f in b)b.hasOwnProperty(f)&&(e[f]=b[f]);Q.tdw(e)}function b(b,c,d,e){b=b,c=c,a("apply_chief"),DB.cgiHttp({url:"http://buluo.qq.com/cgi-bin/bar/apply/check",param:{bid:b},succ:function(c){if(!c.result||c.retcode){var f=c.retcode||"error";return Tip.show("申请失败("+f+")",{type:"warning"}),void a("reject_chief",{ver4:6})}if(1===c.result.violated)return void Tip.show(c.result.violate_msg,{type:"warning"});var g=c.result.small_admins,h=c.result.big_admins,i="";if(0===g&&(i+="&sna=1"),0===h&&(i+="&bna=1"),!c.result.qq_level||c.result.qq_level<=12)Tip.show("您的QQ等级太低，暂时无法申请酋长！",{type:"warning"}),a("reject_chief",{ver4:1});else if(c.result.isban)mqq.ui.showDialog({title:"",text:"您的帐号因在部落被举报有违规操作，暂时无法申请酋长！",needOkBtn:!0,okBtnText:"我知道了",needCancelBtn:!1},function(){}),a("reject_chief",{ver4:2});else if(1===c.result.has_submit||2===c.result.has_submit||3===c.result.has_submit)3===c.result.has_submit?Tip.show("您的酋长申请还在审核流程中，请勿重复申请！",{type:"warning"}):(1===c.result.has_submit||2===c.result.has_submit)&&Tip.show("您在一个月内无法重复申请该部落的酋长！",{type:"warning"}),a("reject_chief",{ver3:4});else if(2&c.result.admin)Tip.show("您已经是大酋长了，无法申请！",{type:"warning"}),a("reject_chief",{ver3:5});else{var j="";1===d&&(j="&bo=1"),11===d&&(j="&bo=1&noadmin=1"),2===d&&(j="&so=1"),4===c.result.has_submit&&(j="&so=1"),5===c.result.has_submit&&(j="&bo=1"),i+=j,1===e&&(i+="&notip=1"),localStorage.setItem("recruitCurrentState","1"),Util.openUrl("http://buluo.qq.com/mobile/recruit.html?_wv=1027&bid="+b+"&bname="+c.result.bname+"&sa="+(4&c.result.admin?1:0)+i,!0)}}})}var c,d;return{doApply:b}}),function(){window.honourHelper={renderHonours:function(a,b){var c,d,e,f=a.admin_ext,g=a["continue"],h='<span class="honour vip-icon" data-url="http://buluo.qq.com/xylm/business/personal_center/center.html?from=exp_icon"></span>',i="",j="";return a.vipno&&(j="&nbsp;",i=h),8===(8&f)?(c=a.title||"大明星",d="特约大神"===a.title?"http://buluo.qq.com/mobile/special_user.html?type=1":"http://buluo.qq.com/mobile/hof.html?bid="+b+"&type=admin&from=icon",i+=j+'<span class="honour vip" data-report-action="star" data-url="'+d+'">'+c+"</span>"):2===(2&f)?(e=a.owner?"首席酋长":"大酋长",i+=j+'<span class="honour admin" data-report-action="big" data-url="http://buluo.qq.com/mobile/hof.html?bid='+b+'&type=admin&from=icon">'+e+"</span>"):4===(4&f)?i+=j+'<span class="honour border-1px admin" data-report-action="small" data-url="http://buluo.qq.com/mobile/hof.html?bid='+b+'&type=admin&from=icon">小酋长</span>':256===(256&f)?i+=j+'<span class="honour admin xiaobian" data-report-action="xiaobian" data-url="http://buluo.qq.com/mobile/hof.html?bid='+b+'&type=admin&from=icon">小编</span>':2048===(2048&f)?i+=j+'<span class="honour rich" data-report-action="tuhao" data-url="http://buluo.qq.com/mobile/hof.html?bid='+b+'&type=rich&from=icon">土豪</span>':1024===(1024&f)?i+=j+'<span class="honour expert" data-report-action="daren" data-url="http://buluo.qq.com/mobile/hof.html?bid='+b+'&type=expert&from=icon">达人</span>':g>=7&&(i+=j+'<span class="honour fans" data-report-action="iron" data-url="http://buluo.qq.com/mobile/hof.html?bid='+b+'&type=fans&from=icon">铁杆粉</span>'),i},renderPoster:function(a,b){var c,d=arguments.length;return 1===d?c=!!a:2===d&&(c=a&&b?a===b:!1),c?'<span class="honour poster">楼主</span>':""},isAdmin:function(a){return 1===(1&a)||2===(2&a)||4===(4&a)||32===(32&a)},renderVip:function(a){var b='<span class="vip-icon" data-url="http://buluo.qq.com/xylm/business/personal_center/center.html?from=exp_icon"></span>';return 1===a?b:""}}}(),function(a,b){"function"==typeof define&&define.amd?define(b):"undefined"==typeof document?module.exports=b():a.TmplInline_hof=b()}(this,function(){var a={},b=function(a,b){function c(b){return d("undefined"==typeof a[b]?this[b]:a[b])}function d(a){return"undefined"==typeof a?"":a}a=a||{};var e=c("vips"),f=c("len"),g=c("imgHandle"),h=c("rich2plain"),i=c("chiefAdmins"),j=c("bigAdmins"),k=c("isWX"),l=c("smallAdmins"),m=c("xiaobianAdmins"),n="";if(n+="",e&&e.length>0){n+=' <div class="list-title section-1px"><span class="vip">明星</span></div> <ul class="list"> ';for(var o=0,f=e.length;f>o;o++){var p=e[o];n+=' <li data-uin="',n+=d(p.uin),n+='"> <div class="avatar"> <img src="',n+=d(g.defaultAvatar),n+='" lazy-src="',n+=d(p.pic),n+='"/> </div> <div class="content"> <div class="nick ',n+=d(p.vip_info?" user-nick-vipno":""),n+='"> <div class="nick_name only">',n+=d(h(p.nick_name)),n+='</div><i class="sex ',n+=d(1===p.gender?"male":"female"),n+='"></i>',n+=d(b.renderVip(p.vip_info)),n+=" </div> </div> </li> "}n+=" </ul> "}if(n+=" ",i&&i.length>0){n+=' <div class="list-title section-1px chief"> <span class="chief-admin">首席酋长</span> </div> <ul class="list"> ';for(var o=0,f=i.length;f>o;o++){var i=i[o];n+=' <li data-uin="',n+=d(i.uin),n+='"> <div class="avatar"> <img src="',n+=d(g.defaultAvatar),n+='" lazy-src="',n+=d(i.pic),n+='"/> </div> <div class="content"> <div class="nick ',n+=d(i.vip_info?" user-nick-vipno":""),n+='"> <div class="nick_name only">',n+=d(h(i.nick_name)),n+='</div><i class="sex ',n+=d(1===i.gender?"male":"female"),n+='"></i>',n+=d(b.renderVip(i.vip_info)),n+=" </div> </div> </li> "}n+=" </ul> "}if(n+=' <div class="list-title section-1px"><span class="big-admin">大酋长</span></div> ',j&&j.length>0){n+=' <ul class="list"> ';for(var o=0,f=j.length;f>o;o++){var q=j[o];n+=' <li data-uin="',n+=d(q.uin),n+='"> <div class="avatar"> <img src="',n+=d(g.defaultAvatar),n+='" lazy-src="',n+=d(q.pic),n+='"/> </div> <div class="content"> <div class="nick ',n+=d(q.vip_info?" user-nick-vipno":""),n+='"> <div class="nick_name only">',n+=d(h(q.nick_name)),n+='</div><i class="sex ',n+=d(1===q.gender?"male":"female"),n+='"></i>',n+=d(b.renderVip(q.vip_info)),n+=" </div> </div> </li> "}n+=" </ul> "}if(n+=" ",j.length<3&&!k&&(n+=' <div class="apply-admin" data-tag="1" id="apply_chief">申请大酋长</div> '),n+=" ",j.length||(n+=' <div class="no-user" id="chief_no_user">暂无酋长</div> '),n+=' <div class="list-title section-1px"> <span class="small-admin">小酋长</span> </div> ',l&&l.length>0){n+=' <ul class="list"> ';for(var o=0,f=l.length;f>o;o++){var r=l[o];n+=' <li data-uin="',n+=d(r.uin),n+='"> <div class="avatar"> <img src="',n+=d(g.defaultAvatar),n+='" lazy-src="',n+=d(r.pic),n+='"/> </div> <div class="content"> <div class="nick ',n+=d(r.vip_info?" user-nick-vipno":""),n+='"> <div class="nick_name only">',n+=d(h(r.nick_name)),n+='</div><i class="sex ',n+=d(1===r.gender?"male":"female"),n+='"></i>',n+=d(b.renderVip(r.vip_info)),n+=" </div> </div> </li> "}n+=" </ul> "}if(n+=" ",l.length<7&&j.length>=0&&!k&&(n+=' <div class="apply-admin" data-tag="2" id="apply_admin">申请小酋长</div> '),n+=" ",m&&m.length>0){n+=' <div class="list-title section-1px"> <span class="small-admin">小编</span> </div> <ul class="list"> ';for(var o=0,f=m.length;f>o;o++){var s=m[o];n+=' <li data-uin="',n+=d(s.uin),n+='"> <div class="avatar"> <img src="',n+=d(g.defaultAvatar),n+='" lazy-src="',n+=d(s.pic),n+='"/> </div> <div class="content"> <div class="nick ',n+=d(s.vip_info?" user-nick-vipno":""),n+='"> <div class="nick_name only">',n+=d(h(s.nick_name)),n+='</div><i class="sex ',n+=d(1===s.gender?"male":"female"),n+='"></i>',n+=d(b.renderVip(s.vip_info)),n+=" </div> </div> </li> "}n+=" </ul> "}return n+=" ",l.length||(n+=' <div class="no-user" id="admin_no_user">暂无酋长</div> '),n+=" "};a.admin="TmplInline_hof.admin",Tmpl.addTmpl(a.admin,b);var c=function(a,b){function c(b){return d("undefined"==typeof a[b]?this[b]:a[b])}function d(a){return"undefined"==typeof a?"":a}a=a||{};var e=c("len"),f=c("ranks"),g=c("start"),h=c("imgHandle"),i=(c("Math"),"");i+="";for(var j=0,e=f.length;e>j;j++){var k=f[j];if(i+=' <li class="',i+=d(!g&&3>j?"rank-top rank-"+(j+1):""),i+='" data-uin="',i+=d(k.uin),i+='"> ',!g&&3>j)i+=' <div class="rank-icon ri_',i+=d(j+1),i+='"><i></i></div> ';else{var l=g+j+1;i+=' <div class="rank ',i+=d(l>999?"small":""),i+='">',i+=d(l),i+="</div> "}i+=' <div class="avatar"> <img src="',i+=d(h.defaultAvatar),i+='" lazy-src="',i+=d(k.pic),i+='"/> </div> <div class="right-content hof-border-1px"> <div class="nick-wrap"> <div class="nick-name">',i+=d(k.nick_name),i+="</div> ",i+=' </div> <div class="award-count-wrap"> ',g||0!=j||(i+='<div class="award-title">获得赞赏次数</div>'),i+=' <div class="award-count"><span class="award-count-num">',i+=d(k.reward_times),i+="</span>次</div> </div> </div> </li> "}return i+=" "};a.expert="TmplInline_hof.expert",Tmpl.addTmpl(a.expert,c);var d=function(a,b){function c(b){return d("undefined"==typeof a[b]?this[b]:a[b])}function d(a){return"undefined"==typeof a?"":a}a=a||{};var e=c("len"),f=c("sfans_list"),g=c("userinfo"),h=c("start"),i=c("imgHandle"),j=c("rich2plain"),k=c("showMe"),l="";l+="";for(var m=0,e=f.length;e>m;m++){var n=f[m];if(l+=' <li class="hof-border-1px ',l+=d(n.uin===g.uin?"me":""),l+='" data-uin="',l+=d(n.uin),l+='"> ',!h&&3>m)l+=' <div class="rank-icon ri_',l+=d(m+1),l+='"><i></i></div> ';else{var o=h+m+1;l+=' <div class="rank ',l+=d(o>999?"small":""),l+='">',l+=d(o),l+="</div> "}l+=' <div class="avatar"> <img src="',l+=d(i.defaultAvatar),l+='" lazy-src="',l+=d(n.pic),l+='"/> </div> <div class="content"> <div class="nick',l+=d(n.vip_info?" user-nick-vipno":""),l+='"> <span class="nick_name">',l+=d(j(n.nick_name)),l+='</span> <i class="sex ',l+=d(1===n.gender?"male":"female"),l+='"></i> ',l+=d(b.renderVip(n.vip_info)),l+=' </div> <p class="text">连续签到',l+=d(n["continue"]),l+="天</p> </div> </li> "}return l+=" ",k&&(l+=' <li class="me dashed hof-border-1px" data-uin="',l+=d(n.uin),l+='"> <div class="rank small">',l+=d(g.rate),l+='</div> <div class="avatar"> <img src="',l+=d(g.pic),l+='"/> </div> <div class="content"> <div class="nick',l+=d(g.vip_info?" user-nick-vipno":""),l+='"> ',l+=d(j(g.nick_name)),l+=' <i class="sex ',l+=d(1===g.gender?"male":"female"),l+='"></i> ',l+=d(b.renderVip(g.vip_info)),l+=' </div> <p class="text">连续签到',l+=d(g.sign_count),l+="天</p> </div> </li> "),l+=" "};a.fans="TmplInline_hof.fans",Tmpl.addTmpl(a.fans,d);var e=function(a,b){function c(b){return d("undefined"==typeof a[b]?this[b]:a[b])}function d(a){return"undefined"==typeof a?"":a}a=a||{};var e=c("len"),f=c("ranks"),g=c("start"),h=c("imgHandle"),i=c("rich2plain"),j="";j+="";for(var k=0,e=f.length;e>k;k++){var l=f[k];if(j+=' <li class="',j+=d(!g&&3>k?"rank-top rank-"+(k+1):""),j+='" data-uin="',j+=d(l.uin),j+='"> ',!g&&3>k)j+=' <div class="rank-icon ri_',j+=d(k+1),j+='"><i></i></div> ';else{var m=g+k+1;j+=' <div class="rank ',j+=d(m>999?"small":""),j+='">',j+=d(m),j+="</div> "}j+=' <div class="avatar"> <img src="',j+=d(h.defaultAvatar),j+='" lazy-src="',j+=d(l.pic),j+='"/> </div> <div class="right-content hof-border-1px"> <div class="nick-wrap"><span class="nick-name">',j+=d(i(l.nick_name)),j+='</span></div> <div class="award-count-wrap"> ',g||0!=k||(j+='<div class="award-title">累计赞赏</div>'),j+=' <div class="award-count"><span class="award-count-num">',j+=d(l.reward_money/100),j+="</span>元</div> </div> </div> </li> "}return j+=" "};return a.rich="TmplInline_hof.rich",Tmpl.addTmpl(a.rich,e),a}),function(a,b){a.Hof=b()}(this,function(){function a(){var a=$(".container").height();a<$(document).height()&&k.rock()}function b(){if(!p&&["admin","fans","expert","rich"].indexOf(c)>-1){var a={admin:r+"部落酋长人员名单",fans:"快来围观"+r+"部落的铁杆粉吧~",expert:"快来围观"+r+"部落的达人吧~",rich:"快来围观"+r+"部落的土豪吧~"}[c];ActionButton.build({iconID:"4",type:"share"},function(){Util.shareMessage({shareUrl:location.href,pageUrl:location.href,imageUrl:s,title:r+"部落",barName:r,barId:d,content:a,succHandler:function(){v("Clk_share_"+c)}},function(){})})}p=!0}var c,d,e,f,g,h,i,j,k,l,m,n,o="http://xiaoqu.qq.com/mobile/",p=!1,q=!1,r="",s="",t=10,u=!1,v=function(a,b){var c,d={opername:"Grp_tribe",module:"hof"},e={0:{action:"exp"},admin:{action:"Clk_chief_person"},expert:{action:"Clk_talent_person"},admin_exp:{action:"chief_exp"},expert_exp:{action:"daren_exp"},fans_exp:{action:"iron_exp"},rich_exp:{action:"tuhao_exp"},fans:{action:"Clk_fans_person"},apply:{module:"refuse_apply",action:"Clk_person_data"},Clk_share_admin:{action:"Clk_share_chief"},Clk_share_fans:{action:"Clk_share_iron"},Clk_share_expert:{action:"Clk_share_daren"},Clk_share_rich:{action:"Clk_share_tuhao"},exp_repair:{action:"exp_repair"},Clk_repair:{action:"Clk_repair"}};for(c in e[a])d[c]=e[a][c];for(c in b)b.hasOwnProperty(c)&&(d[c]=b[c]);Q.tdw(d)},w=function(){n=!1,c=Util.queryString("type"),d=Util.queryString("bid"),e=$("#js_loading"),f=$("#js_empty"),g=$(".list"),h=$(".list-container"),i=$(".tip-container")},x=function(){h.on("tap","li",function(a){var b=$(this),d=a.srcElement||a.target,e=b.data("uin"),f=$(d).data("url");if(f){if(!f)return;f&&mqq.ui.openUrl({target:1,url:f}),a.stopImmediatePropagation()}else if(e&&(e+"").indexOf("*")<0){var f="personal.html#_wv=16777219&scene=hoflist&uin="+e;b.addClass("active"),v(c),setTimeout(function(){b.removeClass("active"),Util.openUrl(o+f,!0)},100)}}).on("tap",".apply-admin",function(){var a=~~$(this).data("tag");ApplyAdmin.doApply(d,4,a,1)}),$(".btn-get-more").on("tap",function(){$(".dashed").remove(),$(this).hide(),e.show(),l.rock(),l.melt()}),i.on("tap","#js_resign_btn",function(){v("Clk_repair");var a="http://buluo.qq.com/mobile/sign_calendar.html?_wv=1027&from=hof&bid="+d;mqq.ui.openUrl({url:a,target:1})})},y=function(a){var b=-t;return function(){return b+=t,{bid:d,type:a,num:t,start:b}}},z=function(){e.text("网络错误，请稍后重试").removeClass("spinner")},A=function(){j=new renderModel({comment:"adminModel",cgiName:"/cgi-bin/bar/fameHall",renderContainer:".list-container",renderTmpl:TmplInline_hof.admin,renderTool:window.honourHelper,param:function(){return{bid:d,type:1}},processData:function(a,b){b>=1&&DB.cgiHttp({url:"/cgi-bin/bar/apply/get_hire_switch",type:"POST",param:{bid:d},succ:function(a){0===a.retcode&&a.result.hire_flag&&($("#apply_chief").show(),$("#chief_no_user").hide(),$("#apply_admin").show(),$("#admin_no_user").hide())}}),a.result.isWX=navigator.userAgent.match(/\bMicroMessenger\/[\d\.]+/),r=a.result.name,s=a.result.pic,h.hasClass("admin")||h.addClass("admin");var c=a.result.admins;if(!c.length)return e.hide(),void f.text("该部落没有酋长").show();for(var g=[],i=[],j=[],k=[],l=[],m=0,n=c.length;n>m;m++){var o=c[m],p=o.admin;8===(8&p)?j.push(o):2===(2&p)?o.owner?l.push(o):g.push(o):4===(4&p)?i.push(o):256===(256&p)&&k.push(o)}a.result.bigAdmins=g,a.result.smallAdmins=i,a.result.xiaobianAdmins=k,a.result.chiefAdmins=l,a.result.vips=j,a.result.hire=~~Util.queryString("hire")||0},events:x,complete:function(){b(),imgHandle.lazy(h[0]),e.hide()},error:z}),k=new scrollModel({comment:"expertModel",cgiName:"/cgi-bin/bar/pay/dr_board",renderContainer:g,renderTmpl:TmplInline_hof.expert,renderTool:window.honourHelper,param:function(){var a=-t;return function(){return a+=t,{bid:d,num:t,start:a}}}(),events:x,processData:function(a,b){g.hasClass("expert")||g.addClass("expert"),a.result.ranks||(a.result.ranks=[]),r=a.result.name,s=a.result.pic,q||(document.title=r+"达人榜",mqq.ui.refreshTitle(),q=!0);var c=b||1;return a.result.start=(c-1)*t,1===b&&!a.result.ranks.length&&a.result.isend?(e.hide(),void f.text("虚位以待").show()):a.result.isend?(e.text("").removeClass("spinner"),void k.freeze()):void 0},complete:function(c,d){imgHandle.lazy(g[0]),b(),1===d&&($("#js_expert_tip").show(),c.result.isend||a())},error:z}),m=new scrollModel({comment:"richModel",cgiName:"/cgi-bin/bar/pay/rich_board",renderContainer:g,renderTmpl:TmplInline_hof.rich,renderTool:window.honourHelper,param:function(){var a=-t;return function(){return a+=t,{bid:d,num:t,start:a}}}(),events:x,processData:function(a,b){g.hasClass("rich")||g.addClass("rich"),a.result.ranks||(a.result.ranks=[]),r=a.result.name,s=a.result.pic,q||(document.title=r+"土豪榜",mqq.ui.refreshTitle(),q=!0);var c=b||1;return a.result.start=(c-1)*t,1===b&&!a.result.ranks.length&&a.result.isend?(e.hide(),void f.text("虚位以待").show()):a.result.isend?(e.text("").removeClass("spinner"),void m.freeze()):void 0},complete:function(a,c){imgHandle.lazy(g[0]),b(),1===c&&$("#js_rich_tip").show()},error:z}),l=new scrollModel({comment:"fansModel",cgiName:"/cgi-bin/bar/fameHall",renderContainer:g,renderTmpl:TmplInline_hof.fans,renderTool:window.honourHelper,param:y(3),events:x,processData:function(a,b){if(g.hasClass("fans")||g.addClass("fans"),!a.result.sfans_list)return void e.text("获取服务器数据发生异常").removeClass("spinner");if(r=a.result.name,s=a.result.pic,q||(document.title=r+"铁杆粉",mqq.ui.refreshTitle(),q=!0),1===b){var c=a.result.userinfo;if(c.is_sfans&&c.rate>t&&(a.result.showMe=!0,l.freeze(),e.hide(),$(".btn-get-more").show()),!a.result.sfans_list.length)return e.hide(),void f.text("该部落没有铁杆粉").show()}var d=b||1;if(a.result.start=(d-1)*t,a.result.sfans_isend){var h="";return a.result.sfans_count>199&&(h="只显示前200名，200名后的加油哦！"),e.text(h).removeClass("spinner"),void l.freeze()}},complete:function(a,c){if(n="明星"===a.result.category_name,a.result.isStarCategory=n,imgHandle.lazy(g[0]),b(),1===c){$("#js_fans_tip").html("连续签到7天即可点亮铁杆粉勋章").show();var d=a.result.userinfo,e=d.sign_count,f="";e>6?f='<p>我已连续签到<span class="num">'+e+'</span>天,当前排<span class="num">'+d.rate+"</span>名</p>":e>0&&(f='<p>我已连续签到<span class="num">'+e+'</span>天,还差<span class="num">'+(7-e)+"</span>天成为铁杆粉</p>"),u=n&&a.result&&a.result.userinfo&&a.result.userinfo.show_calendar_entrance&&1==a.result.userinfo.sign&&a.result.userinfo.leak_day&&a.result.userinfo.can_repari_day,u&&(f+='<p id="js_resign_btn" class="tip-btn">立即补签</p>',v("exp_repair")),e&&$("#js_fans_tip").html(f)}},error:z})},B=function(){w(),A(),"admin"===c?(v("admin_exp"),document.title="明星、酋长",j.rock()):"expert"===c?(v("expert_exp"),k.rock()):"rich"===c?(v("rich_exp"),m.rock()):(v("fans_exp"),l.rock()),v(0),mqq&&mqq.ui&&mqq.ui.refreshTitle&&mqq.ui.refreshTitle(),Login.continueLogin()};return{init:B}});