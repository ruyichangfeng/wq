{template 'public/header'}
<style>
img {
	vertical-align: middle;
}
#QuacorGrading input {
	background: url('{MODULE_URL}static/takeout/images/grading.png') no-repeat scroll right center;
	cursor: pointer;
	height: 30px;
	width: 30px;
	padding: 0;
	border: 0;
}
#QuacorGrading1 input {
	background: url('{MODULE_URL}static/takeout/images/grading.png') no-repeat scroll right center;
	cursor: pointer;
	height: 30px;
	width: 30px;
	padding: 0;
	border: 0;
}
</style>

<body data-spy="scroll" data-target="#myScrollspy">
<input type="hidden" name="id" id="id" value="{$id}">
<input type="hidden" name="orderid" id="orderid" value="{$item['orderid']}">
<input type="hidden" name="merchantid" id="merchantid" value="{$item['merchantid']}">

<div class="page">
 <div class="ub ub-ver c-wh uinn1"><!--菜品评分-->
   <div class="ub ub-f1 ub-pc umar-b ubb b-bla01 uinn13">
    {if $this->getMerchantInfo($item['merchantid'], 'coverpic') == ''}
    <div class="ub gouwu_pic ub-img1" style="background-image:url({MODULE_URL}static/takeout/images/nopic.jpg)"> </div>
    {else}
      {if strstr($this->getMerchantInfo($item['merchantid'], 'coverpic'),'images')}
        <div class="ub gouwu_pic ub-img1" style="background-image:url({$_W['attachurl']}{php echo $this->getMerchantInfo($item['merchantid'], 'coverpic')})"> </div>
      {else}
        <div class="ub gouwu_pic ub-img1" style="background-image:url({$_W['attachurl']}gohome/coverpic/{php echo $this->getMerchantInfo($item['merchantid'], 'coverpic')})"> </div>
      {/if}
    {/if}
    
    <div class="ub-f1"><textarea name="comment" id="comment" rows="2" placeholder="亲，请填写你对本店的真实评价！" value="" class=" uinn1 ulev-1 ub-f1 block ub-fh"></textarea></div>
   </div>
   <div class="ub-f1 ub uinn11 font-b2">整体评价</div>
   
   <div class="ub-f1 ub uinn11 ub-pc ub-ac ubb b-bla01">
    <div class="ub-f1 ulev-4"></div>
    <div class="ub ff-check">
    <input name="grade" type="radio" id="hh1" value="1"  checked>
      <label class="block uinn3 ulev0 t-dgra" for="hh1">
        <i class="iconfont icon-gouxuan ulev-1"></i>
        <font class="ulev-4">满意</font>
      </label>
      <input name="grade" type="radio" id="hh2" value="2" >
      <label class="block uinn3 ulev0 t-dgra umar-l" for="hh2">
        <i class="iconfont icon-gouxuan ulev-1"></i>
        <font class="ulev-4">不满意</font>
      </label>
    </div>
   </div>
   <!--
   {php $n=0;}
   {loop $list $vo}
   {php $n+=1;}
   <div class="ub-f1 ub uinn11 ub-pc ub-ac ubb b-bla01">
    <div class="ub-f1 ulev-4">{php echo $this->getCurryInfo($vo[curryid], 'curry_name')}</div>
    <div class="ub ff-check">
    <input name="grade{$n}" type="radio" id="hh{$n}{$k}" value="1"  checked>
    <label class="block uinn3 ulev0 t-dgra" for="hh{$n}{$k}"><i class="iconfont icon-gouxuan ulev-1"></i> <font class="ulev-4">满意</font></label>
    <input name="grade{$n}" type="radio" id="hh{$n}{$k}" value="2" >
    <label class="block uinn3 ulev0 t-dgra umar-l" for="hh{$n}{$k}"><i class="iconfont icon-gouxuan ulev-1"></i> <font class="ulev-4">不满意</font></label>
    </div>
   </div>
   {/loop}
   -->

</div>
<div class="ub ub-ver c-wh uinn1 umar-t1"><!--店铺评分-->
   <div class="ub-f1 ub uinn11 font-b2">店铺评分</div>
   <div class="ub-f1 ub uinn11 ub-pc ub-ac ubb b-bla01">
    <div class="ub">
     商家评分
    </div>
    <div class="ub-f1 umar-l" id="QuacorGrading">
      <input name="1" type="button" />
      <input name="2" type="button" />
      <input name="3" type="button" />
      <input name="4" type="button" />
      <input name="5" type="button" />
   </div>
   <div class="t-org ulev0 ub" id="QuacorGradingValue"><font>4</font></div><div class="ub ulev-2 umar-r1">分</div>
   </div>
   <div class="ub-f1 ub uinn11 ub-pc ub-ac ubb b-bla01">
    <div class="ub">
     服务态度
    </div>
    <div class="ub-f1 umar-l" id="QuacorGrading1">
      <input name="1" type="button" />
      <input name="2" type="button" />
      <input name="3" type="button" />
      <input name="4" type="button" />
      <input name="5" type="button" />
   </div>
   <div class="t-org ulev0 ub" id="QuacorGradingValue1"><font>4</font></div><div class="ub ulev-2 umar-r1">分</div>
   </div>
</div>
 
<!--底部浮动-->
<div class=" ub ub-f1 fixed c-wh ubt b-bla01 ub-fh ub-ac ub-pc" style="bottom:0; left:0; z-index:999">
 <div class="ub-f1 t-line15 umar-l ff-check">
    <input name="niming" type="checkbox" id="hh5" value="1" >
    <label class="block uinn3 ulev0 t-dgra" for="hh5"><i class="iconfont icon-gouxuan ulev-1"></i> <font class="ulev0">匿名评价</font></label>
 </div>
 <input type="hidden" name="xing" id="xing" value="">
 <input type="hidden" name="fxing" id="fxing" value="">

 <div onClick="submit()" class="c-red1 uinn8 t-wh ub umar-l">发布评论</div>
</div>
</div>   

{template 'public/footerjs'}
<script type="text/javascript">
function submit(){
  var id         = $("#id").val();
  var orderid    = $("#orderid").val();
  var merchantid = $("#merchantid").val();
  var grade      = $('input[name="grade"]:checked').val();
  var xing       = $("#xing").val();
  var fxing      = $("#fxing").val();
  var comment    = $("#comment").val();
  var niming     = $('input[name="niming"]:checked').val();

  var data           = {};
  data['id']         = id;
  data['orderid']    = orderid;
  data['merchantid'] = merchantid;
  data['grade']      = grade;
  data['xing']       = xing;
  data['fxing']      = fxing;
  data['comment']    = comment;
  data['niming']     = niming;
  
  $.ajax({
      url: "{php echo $this->createMobileUrl('takeorder', array('foo'=>'rateok'));}",
      type:"POST",
      data: data,
      dataType:"json",
      success: function(res){
        if(res == "1"){
          window.location.href = "{php echo $this->createMobileUrl('takeorder', array('foo'=>'myorder'))}";
        }else if(res == 2){
          alert('你已经评论过，不能重复评论！');
          return false;
        }else{
          alert('评论失败！');
          return false;
        }
      }
  });
}

var GradList = document.getElementById("QuacorGrading").getElementsByTagName("input");
for(var di=0;di<parseInt(document.getElementById("QuacorGradingValue").getElementsByTagName("font")[0].innerHTML);di++){
  GradList[di].style.backgroundPosition = 'left center';
};
for(var i=0;i < GradList.length;i++){ 
  //GradList[i].onmouseover = function(){
  GradList[i].onclick = function(){
    for(var Qi=0;Qi<GradList.length;Qi++){
      GradList[Qi].style.backgroundPosition = 'right center';
    }
    for(var Qii=0;Qii<this.name;Qii++){
      GradList[Qii].style.backgroundPosition = 'left center';
    }
    document.getElementById("QuacorGradingValue").innerHTML = '<font>'+this.name+'</font>';
    document.getElementById("xing").value = this.name;
  }
};

var GradList1 = document.getElementById("QuacorGrading1").getElementsByTagName("input");
for(var di=0;di<parseInt(document.getElementById("QuacorGradingValue1").getElementsByTagName("font")[0].innerHTML);di++){
  GradList1[di].style.backgroundPosition = 'left center';
};
for(var i=0;i < GradList1.length;i++){
  //GradList[i].onmouseover = function(){
  GradList1[i].onclick = function(){
    for(var Qi=0;Qi<GradList.length;Qi++){
      GradList1[Qi].style.backgroundPosition = 'right center';
    }
    for(var Qii=0;Qii<this.name;Qii++){
      GradList1[Qii].style.backgroundPosition = 'left center';
    }
    document.getElementById("QuacorGradingValue1").innerHTML = '<font>'+this.name+'</font>';
    document.getElementById("fxing").value = this.name;
  }
};
</script>
</body>
</html>
