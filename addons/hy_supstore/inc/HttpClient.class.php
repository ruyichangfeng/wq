<?php
 class HttpClient { var $host; var $port; var $path; var $method; var $postdata = ''; var $cookies = array(); var $referer; var $accept = "\164\145\170\164\57\x78\x6d\x6c\x2c\141\x70\160\154\151\143\x61\x74\151\x6f\x6e\57\x78\155\154\54\x61\160\160\154\x69\143\x61\x74\151\x6f\x6e\57\x78\x68\x74\155\x6c\53\170\155\x6c\x2c\x74\145\x78\164\57\150\x74\155\154\54\x74\145\170\164\57\160\x6c\x61\151\x6e\54\151\155\x61\147\145\x2f\160\x6e\147\54\151\x6d\x61\x67\x65\x2f\152\x70\145\147\x2c\151\155\141\x67\x65\57\x67\x69\x66\x2c\52\57\52"; var $accept_encoding = "\147\x7a\x69\x70"; var $accept_language = "\x65\156\55\165\x73"; var $user_agent = "\111\x6e\x63\165\164\151\x6f\40\110\164\x74\160\x43\x6c\x69\x65\x6e\164\x20\166\60\56\x39"; var $timeout = 20; var $use_gzip = true; var $persist_cookies = true; var $persist_referers = true; var $debug = false; var $handle_redirects = true; var $max_redirects = 5; var $headers_only = false; var $username; var $password; var $status; var $headers = array(); var $content = ''; var $errormsg; var $redirect_count = 0; var $cookie_host = ''; function HttpClient($host, $port = 80) { $this->host = $host; $this->port = $port; } function get($path, $data = false) { goto TQQie; TQQie: $this->path = $path; goto QEhJe; kHbt6: return $this->doRequest(); goto jf__u; S4H3L: if (!$data) { goto h1hv5; } goto PN8LD; QEhJe: $this->method = "\x47\x45\124"; goto S4H3L; PN8LD: $this->path .= "\x3f" . $this->buildQueryString($data); goto cS_BX; cS_BX: h1hv5: goto kHbt6; jf__u: } function post($path, $data) { goto RiTeG; oObcw: $this->method = "\x50\117\123\124"; goto eabtV; eabtV: $this->postdata = $this->buildQueryString($data); goto gdOl_; RiTeG: $this->path = $path; goto oObcw; gdOl_: return $this->doRequest(); goto V6AMY; V6AMY: } function buildQueryString($data) { goto sf3Oa; VILR6: goto xpFnW; goto epJeR; ETk0W: $querystring = substr($querystring, 0, -1); goto CC9WL; MsLHL: return $querystring; goto NqMMR; sf3Oa: $querystring = ''; goto BLhVf; rGsW6: foreach ($data as $key => $val) { goto FpR8k; FpR8k: if (is_array($val)) { goto CWKXf; } goto TfqG2; VBPfw: z2_Mq: goto jK0xA; R86Jo: goto IlIx0; goto dmQQV; za4y3: JbtEM: goto v6840; iHEon: foreach ($val as $val2) { $querystring .= urlencode($key) . "\x3d" . urlencode($val2) . "\46"; hsnks: } goto za4y3; dmQQV: CWKXf: goto iHEon; TfqG2: $querystring .= urlencode($key) . "\x3d" . urlencode($val) . "\46"; goto R86Jo; v6840: IlIx0: goto VBPfw; jK0xA: } goto NjrEX; CC9WL: xpFnW: goto MsLHL; epJeR: r61J3: goto rGsW6; BLhVf: if (is_array($data)) { goto r61J3; } goto DQopi; NjrEX: qYMJj: goto ETk0W; DQopi: $querystring = $data; goto VILR6; NqMMR: } function doRequest() { goto Vnhu3; bZi0m: if (!$this->headers_only) { goto DyTt5; } goto tjhj9; ZQdka: $this->referer = $this->getRequestURL(); goto ZHESw; gzT3M: goto WyQrG; goto i8aI6; GmGIO: $atStart = true; goto jma5Q; p_FVr: vznNt: goto d3BAX; jxP3_: $this->debug("\x43\157\x6e\164\145\156\164\40\x69\x73\x20\x67\x7a\151\x70\40\145\x6e\x63\157\144\145\144\x2c\40\x75\156\172\151\160\160\x69\156\x67\x20\151\x74"); goto xqbq6; K6_cH: Y2Nd3: goto LYiMP; p2PTa: $this->errormsg = ''; goto dvxsV; V4RMM: goto WyQrG; goto a_c3Q; xNAAV: if (preg_match("\x2f\x48\x54\x54\120\x5c\x2f\50\x5c\x64\x5c\56\x5c\144\x29\x5c\163\x2a\x28\134\144\53\51\134\163\52\x28\x2e\52\51\57", $line, $m)) { goto qjpH9; } goto zpXND; t7c0i: DyTt5: goto ogWP7; lB1Qy: goto WyQrG; goto TG1FI; CAuIr: qjpH9: goto ywhAm; rosmr: fclose($fp); goto sA9vW; s7704: n_3Jo: goto ZK_fp; DB9Wf: $this->headers[$key][] = $val; goto s7704; b0Qv0: $val = trim($m[2]); goto EYUHf; CCXAi: $key = strtolower(trim($m[1])); goto b0Qv0; c6Ogw: goto n_3Jo; goto c6P0a; XHjd_: KWuw8: goto mtcTB; Vnhu3: if ($fp = @fsockopen($this->host, $this->port, $errno, $errstr, $this->timeout)) { goto KWuw8; } goto k4zbi; dvxsV: $inHeaders = true; goto GmGIO; rb2WK: if (!$this->persist_referers) { goto wQXnf; } goto sD06Y; ywhAm: $http_version = $m[1]; goto bleaH; v83cO: if (is_array($cookies)) { goto vznNt; } goto BZyAR; BZyAR: $cookies = array($cookies); goto p_FVr; U7LtL: Fvhav: goto prIFR; p6ApU: $inHeaders = false; goto iMSWC; TG1FI: Xp8kZ: goto s23SU; R8bTQ: return false; goto CAuIr; Htbtf: x9a2V: goto K6_cH; k4zbi: switch ($errno) { case -3: $this->errormsg = "\123\x6f\143\153\x65\x74\x20\x63\162\x65\x61\x74\x69\157\156\40\146\141\x69\154\x65\x64\x20\50\55\63\51"; case -4: $this->errormsg = "\104\116\123\40\154\157\157\x6b\x75\160\x20\146\141\151\x6c\165\162\145\40\50\x2d\x34\x29"; case -5: $this->errormsg = "\x43\x6f\156\x6e\145\x63\x74\151\x6f\x6e\x20\162\145\146\165\163\x65\x64\40\x6f\162\40\164\x69\x6d\145\x64\40\157\165\164\x20\x28\x2d\x35\x29"; default: goto UM26N; jvWiw: $this->debug($this->errormsg); goto nZF9q; UM26N: $this->errormsg = "\x43\157\156\156\145\143\164\151\x6f\156\x20\x66\141\x69\x6c\145\x64\x20\50" . $errno . "\51"; goto A1ULr; A1ULr: $this->errormsg .= "\x20" . $errstr; goto jvWiw; nZF9q: } goto Htbtf; sA9vW: if (!(isset($this->headers["\x63\x6f\x6e\164\145\156\164\55\145\156\143\x6f\x64\151\x6e\x67"]) && $this->headers["\143\157\156\164\x65\x6e\164\55\x65\156\143\x6f\144\x69\156\x67"] == "\147\172\151\x70")) { goto LEo6W; } goto jxP3_; ZXhS_: goto cbeXe; goto taI8d; LYiMP: return false; goto XHjd_; Qm9mg: if (!($location || $uri)) { goto Ar1M6; } goto E5QTS; la0oF: fwrite($fp, $request); goto Qw7xW; ReTau: if (!$atStart) { goto O9rdG; } goto A4e80; YuOV_: return true; goto bKWSt; iYT63: LEo6W: goto lUxCy; kkFCv: $this->content = ''; goto p2PTa; vKN0n: zrb4r: goto YuOV_; GGrZL: $status_string = $m[3]; goto bKGYr; G39Wi: $this->content = gzinflate($this->content); goto iYT63; zdJII: $line = fgets($fp, 4096); goto ReTau; jxxqg: $this->redirect_count = 0; goto MSodj; LPB5v: GF8fX: goto rXKfB; KdJ_8: $this->errormsg = "\x4e\165\155\x62\x65\x72\x20\157\146\x20\x72\145\x64\x69\x72\x65\143\x74\x73\x20\x65\x78\143\145\145\144\145\x64\x20\155\x61\x78\151\x6d\165\155\40\50" . $this->max_redirects . "\x29"; goto PXCJ9; s23SU: $this->content .= $line; goto gzT3M; BJxMB: if (!$inHeaders) { goto Xp8kZ; } goto EBDxr; iMSWC: $this->debug("\x52\x65\143\145\x69\x76\145\144\x20\x48\145\x61\x64\x65\x72\163", $this->headers); goto bZi0m; pvN3u: O9rdG: goto BJxMB; xqbq6: $this->content = substr($this->content, 10); goto G39Wi; prIFR: if (preg_match("\x2f\x28\133\x5e\72\135\53\51\x3a\134\x73\52\50\56\52\51\x2f", $line, $m)) { goto XwSn0; } goto V4RMM; c6P0a: c1spE: goto DB9Wf; ZK_fp: cbeXe: goto lB1Qy; zpXND: $this->errormsg = "\123\164\x61\x74\165\x73\40\x63\157\x64\x65\x20\154\x69\156\x65\x20\x69\x6e\166\x61\154\x69\144\x3a\x20" . htmlentities($line); goto AVXxu; B1JLk: goto WyQrG; goto pvN3u; sD06Y: $this->debug("\120\145\x72\x73\x69\x73\164\151\156\147\x20\162\145\146\x65\162\x65\x72\x3a\40" . $this->getRequestURL()); goto ZQdka; rXKfB: $location = isset($this->headers["\154\157\143\x61\164\151\157\x6e"]) ? $this->headers["\x6c\157\x63\x61\x74\x69\x6f\156"] : ''; goto ddzwG; kk5X7: if (!$this->handle_redirects) { goto zrb4r; } goto xORaW; XyPpw: vhKdX: goto Ibhlv; Kz_D1: $cookies = $this->headers["\x73\145\x74\x2d\143\x6f\157\153\151\x65"]; goto v83cO; bleaH: $this->status = $m[2]; goto GGrZL; MxZ9J: fmwph: goto rb2WK; ogWP7: goto WyQrG; goto U7LtL; i8aI6: pzSA1: goto rosmr; R7vFM: if (feof($fp)) { goto pzSA1; } goto zdJII; TV4k1: if (is_array($this->headers[$key])) { goto c1spE; } goto TN1xT; lUxCy: if (!($this->persist_cookies && isset($this->headers["\163\145\164\55\x63\157\157\153\x69\x65"]) && $this->host == $this->cookie_host)) { goto fmwph; } goto Kz_D1; MSodj: return false; goto LPB5v; EBDxr: if (!(trim($line) == '')) { goto Fvhav; } goto p6ApU; ddzwG: $uri = isset($this->headers["\x75\162\151"]) ? $this->headers["\165\x72\151"] : ''; goto Qm9mg; Df5sh: $request = $this->buildRequest(); goto PW0e2; PXCJ9: $this->debug($this->errormsg); goto jxxqg; EYUHf: if (isset($this->headers[$key])) { goto R8dIa; } goto J2Ow2; J2Ow2: $this->headers[$key] = $val; goto ZXhS_; tjhj9: goto pzSA1; goto t7c0i; ZHESw: wQXnf: goto kk5X7; mtcTB: socket_set_timeout($fp, $this->timeout); goto Df5sh; d3BAX: foreach ($cookies as $cookie) { goto CUZ9M; rGrlD: LaeEf: goto xcVJu; tO_Dd: $this->cookies[$m[1]] = $m[2]; goto AzfTo; AzfTo: RSM2I: goto rGrlD; CUZ9M: if (!preg_match("\x2f\x28\x5b\x5e\75\135\x2b\51\75\x28\x5b\x5e\73\x5d\x2b\51\73\57", $cookie, $m)) { goto RSM2I; } goto tO_Dd; xcVJu: } goto XyPpw; a_c3Q: XwSn0: goto CCXAi; xORaW: if (!(++$this->redirect_count >= $this->max_redirects)) { goto GF8fX; } goto KdJ_8; E5QTS: $url = parse_url($location . $uri); goto H7pEp; taI8d: R8dIa: goto TV4k1; Ibhlv: $this->cookie_host = $this->host; goto MxZ9J; PW0e2: $this->debug("\x52\x65\x71\165\145\163\x74", $request); goto la0oF; bKGYr: $this->debug(trim($line)); goto B1JLk; A4e80: $atStart = false; goto xNAAV; Qw7xW: $this->headers = array(); goto kkFCv; H7pEp: return $this->get($url["\x70\x61\x74\150"]); goto qPUcC; jma5Q: WyQrG: goto R7vFM; TN1xT: $this->headers[$key] = array($this->headers[$key], $val); goto c6Ogw; qPUcC: Ar1M6: goto vKN0n; AVXxu: $this->debug($this->errormsg); goto R8bTQ; bKWSt: } function buildRequest() { goto V53yJ; tdbDW: $headers[] = "\x48\157\163\x74\x3a\x20{$this->host}"; goto RoRt1; ZgrB0: return $request; goto CLr_3; bxI9m: $headers[] = "\x41\143\143\x65\160\x74\55\145\156\x63\157\144\151\x6e\x67\72\40{$this->accept_encoding}"; goto hdhXp; etuNq: $headers[] = "\x43\157\156\x74\145\x6e\x74\x2d\x4c\x65\x6e\147\164\150\72\40" . strlen($this->postdata); goto VHi_Y; V53yJ: $headers = array(); goto R1zM7; dGvZW: $headers[] = "\x43\157\156\164\145\x6e\164\x2d\124\x79\x70\x65\72\x20\141\x70\x70\154\151\143\141\164\151\x6f\156\57\x78\x2d\167\x77\167\x2d\x66\x6f\x72\x6d\x2d\165\162\154\x65\x6e\x63\157\144\145\x64"; goto etuNq; Ro4Ba: if (!($this->username && $this->password)) { goto O_gBD; } goto FoDlD; FoDlD: $headers[] = "\101\x75\164\150\x6f\x72\x69\172\x61\x74\151\157\x6e\x3a\40\x42\x41\x53\x49\103\40" . base64_encode($this->username . "\72" . $this->password); goto mx4iW; RqPTa: if (!$this->postdata) { goto m5IdJ; } goto dGvZW; KRKL1: if (!$this->cookies) { goto Zs2D2; } goto L5kna; TXkvW: Zs2D2: goto Ro4Ba; IbI1d: if (!$this->referer) { goto KfM0q; } goto WZ1Fu; GknCf: $headers[] = "\101\143\x63\x65\160\x74\72\x20{$this->accept}"; goto nu5zx; ep2xf: $headers[] = "\101\143\x63\x65\x70\x74\55\x6c\141\156\147\165\141\147\145\x3a\40{$this->accept_language}"; goto IbI1d; RoRt1: $headers[] = "\125\163\145\x72\55\x41\147\x65\156\x74\72\x20{$this->user_agent}"; goto GknCf; lnYTI: $headers[] = $cookie; goto TXkvW; RTu7U: foreach ($this->cookies as $key => $value) { $cookie .= "{$key}\75{$value}\73\x20"; ZvMnh: } goto fB6fe; VHi_Y: m5IdJ: goto CSEyc; WZ1Fu: $headers[] = "\x52\x65\146\145\x72\x65\162\72\x20{$this->referer}"; goto WCaiB; hdhXp: AEjcP: goto ep2xf; R1zM7: $headers[] = "{$this->method}\40{$this->path}\x20\x48\124\124\x50\x2f\61\x2e\x30"; goto tdbDW; fB6fe: isVk9: goto lnYTI; WCaiB: KfM0q: goto KRKL1; L5kna: $cookie = "\103\157\x6f\153\x69\x65\72\x20"; goto RTu7U; nu5zx: if (!$this->use_gzip) { goto AEjcP; } goto bxI9m; CSEyc: $request = implode("\xd\12", $headers) . "\15\12\xd\xa" . $this->postdata; goto ZgrB0; mx4iW: O_gBD: goto RqPTa; CLr_3: } function getStatus() { return $this->status; } function getContent() { return $this->content; } function getHeaders() { return $this->headers; } function getHeader($header) { goto jhKfz; p45tQ: goto vMjTb; goto pmUqg; Ri9qH: vMjTb: goto NzQqT; jhKfz: $header = strtolower($header); goto MPoWv; QjYAS: return false; goto p45tQ; MPoWv: if (isset($this->headers[$header])) { goto WrIj5; } goto QjYAS; pmUqg: WrIj5: goto y13bq; y13bq: return $this->headers[$header]; goto Ri9qH; NzQqT: } function getError() { return $this->errormsg; } function getCookies() { return $this->cookies; } function getRequestURL() { goto cSg8u; jNBep: return $url; goto Ni6yC; R6tHp: $url .= "\x3a" . $this->port; goto ufmFE; ufmFE: KIjDJ: goto kK1ET; cSg8u: $url = "\x68\164\164\160\72\x2f\x2f" . $this->host; goto NhZQR; kK1ET: $url .= $this->path; goto jNBep; NhZQR: if (!($this->port != 80)) { goto KIjDJ; } goto R6tHp; Ni6yC: } function setUserAgent($string) { $this->user_agent = $string; } function setAuthorization($username, $password) { $this->username = $username; $this->password = $password; } function setCookies($array) { $this->cookies = $array; } function useGzip($boolean) { $this->use_gzip = $boolean; } function setPersistCookies($boolean) { $this->persist_cookies = $boolean; } function setPersistReferers($boolean) { $this->persist_referers = $boolean; } function setHandleRedirects($boolean) { $this->handle_redirects = $boolean; } function setMaxRedirects($num) { $this->max_redirects = $num; } function setHeadersOnly($boolean) { $this->headers_only = $boolean; } function setDebug($boolean) { $this->debug = $boolean; } function quickGet($url) { goto PDl12; w29Zf: $host = $bits["\150\157\x73\164"]; goto PuyGw; VqMso: $client = new HttpClient($host, $port); goto UObXX; yqyd0: $path = isset($bits["\x70\x61\164\x68"]) ? $bits["\x70\141\164\x68"] : "\x2f"; goto QGn54; UObXX: if (!$client->get($path)) { goto Wansg; } goto Qlq5K; heTwX: MEai5: goto VqMso; Qlq5K: return $client->getContent(); goto h18DW; h2nAr: Wansg: goto g5hXW; h18DW: goto r93rM; goto h2nAr; m3Yec: $path .= "\77" . $bits["\161\165\x65\162\171"]; goto heTwX; PDl12: $bits = parse_url($url); goto w29Zf; g5hXW: return false; goto jb7zc; jb7zc: r93rM: goto f60Ot; QGn54: if (!isset($bits["\x71\165\x65\162\x79"])) { goto MEai5; } goto m3Yec; PuyGw: $port = isset($bits["\x70\157\x72\164"]) ? $bits["\x70\157\x72\x74"] : 80; goto yqyd0; f60Ot: } function quickPost($url, $data) { goto M3Sb2; vGTci: LeD21: goto VJ79Q; sCqd3: $port = isset($bits["\160\x6f\162\164"]) ? $bits["\160\157\x72\x74"] : 80; goto JO8dN; lvYwL: $host = $bits["\x68\x6f\163\x74"]; goto sCqd3; BJLj2: goto CWPYz; goto vGTci; zGZwm: CWPYz: goto jjuPB; JO8dN: $path = isset($bits["\160\x61\164\150"]) ? $bits["\x70\141\x74\x68"] : "\x2f"; goto Eqdje; VJ79Q: return false; goto zGZwm; M3Sb2: $bits = parse_url($url); goto lvYwL; DIdA9: if (!$client->post($path, $data)) { goto LeD21; } goto J_Lcp; J_Lcp: return $client->getContent(); goto BJLj2; Eqdje: $client = new HttpClient($host, $port); goto DIdA9; jjuPB: } function debug($msg, $object = false) { goto PwCAy; zIAYT: ob_end_clean(); goto QqeEu; PwCAy: if (!$this->debug) { goto IdWwH; } goto dODMh; Gstl2: if (!$object) { goto Ti_pZ; } goto JPATH; nGGpF: $content = htmlentities(ob_get_contents()); goto zIAYT; aXVOK: print_r($object); goto nGGpF; HKnd7: IdWwH: goto e0SYP; Dbu3d: Ti_pZ: goto oRBwM; JPATH: ob_start(); goto aXVOK; QqeEu: print "\x3c\x70\x72\145\76" . $content . "\x3c\x2f\x70\162\145\76"; goto Dbu3d; dODMh: print "\74\x64\151\166\x20\x73\164\171\154\145\75\42\x62\157\x72\x64\x65\162\x3a\40\61\160\x78\40\x73\x6f\154\151\144\40\x72\x65\144\73\40\x70\141\x64\144\x69\156\147\x3a\40\60\x2e\x35\x65\155\x3b\40\155\x61\x72\147\151\156\x3a\x20\x30\x2e\x35\145\x6d\x3b\42\76\74\163\164\162\157\156\x67\76\110\164\164\160\x43\x6c\x69\x65\x6e\x74\40\x44\x65\x62\165\x67\x3a\x3c\57\x73\x74\162\x6f\156\147\x3e\x20" . $msg; goto Gstl2; oRBwM: print "\74\57\144\151\166\x3e"; goto HKnd7; e0SYP: } }