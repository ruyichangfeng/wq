<?php
 class Miaosha extends ZskWxapp { public function goodsList() { goto bmcPg; OUT_O: $result = $model->pagenation($sql); goto v1RIj; qUKqq: $now = date("\110\72\151", time()); goto hvWLJ; wZJMw: $where .= "\40\101\116\104\40{$tab1}\x2e\163\x74\x61\162\164\x74\x69\155\145\75\47" . $_GPC["\163\164\x61\162\164\164\151\x6d\145"] . "\x27"; goto f5UX8; i4XeW: $where = "{$tab1}\x2e\165\156\151\141\143\151\144\x3d{$uniacid}\x20\x61\156\144\x20{$tab1}\56\x73\x74\x61\x74\x75\x73\x3e\60\40\141\156\x64\x20{$tab1}\x2e\x64\141\x74\x65\154\151\156\145\x20\154\151\153\145\x20\47\x25" . $date . "\x25\47\x20\141\156\144\40\x74\151\155\x65\154\x69\x6e\x65\40\154\x69\x6b\x65\x20\47\x25" . $time . "\45\x27\40\x61\x6e\144\40{$tab0}\x2e\x73\x74\141\164\x75\x73\76\60\40\x20\141\x6e\x64\40{$tab1}\56\x74\171\160\145\75\62"; goto BHSXJ; c2J4z: if (!($time < $now)) { goto PknSZ; } goto nqgWb; QCuj_: $time = trim($_GPC["\164\x69\155\x65"]); goto qUKqq; mnoMS: $sql = "\123\x45\x4c\x45\x43\x54\40{$tab1}\56\52\54{$tab1}\56\151\x64\x20\141\x73\40\x64\151\x73\x63\157\x75\x6e\164\137\x69\x64\54{$tab0}\56\156\x61\x6d\145\54{$tab0}\x2e\160\x69\143\164\165\x72\x65\54{$tab0}\56\160\x72\151\x63\x65\54{$tab0}\x2e\x70\x72\x69\x63\x65\60\54{$tab0}\x2e\x70\151\x63\164\x75\x72\x65\137\x77\151\144\x65\54\x30\40\141\163\40\x69\x73\x5f\x73\164\x6f\160\x2c\x30\40\x61\163\x20\x73\164\157\160\137\x64\141\171\x2c\x30\x20\141\163\40\x73\x74\x6f\160\137\x68\x6f\165\162\x2c\60\x20\x61\x73\x20\163\164\x6f\x70\137\x6d\x69\x6e\165\164\145\x2c\60\40\x61\163\x20\x73\164\157\160\137\163\x65\x63\x6f\x6e\144\40\x20\x46\x52\x4f\115\x20{$tab1}\40\114\105\106\x54\40\40\112\x4f\111\116\x20{$tab0}\40\x4f\116\x20{$tab0}\x2e\151\x64\75{$tab1}\x2e\x67\x6f\x6f\144\163\151\144\x20\127\110\105\122\x45\40{$where}\x20\x6f\162\144\145\x72\40\142\x79\x20{$tab1}\x2e\163\x74\157\x70\x74\x69\155\145\40\x64\x65\x73\x63"; goto OUT_O; HakBm: $tab0 = $model->tablename("\147\x6f\x6f\x64\x73"); goto iGlBW; iGlBW: $tab1 = $model->tablename("\x64\151\x73\x63\157\x75\156\x74"); goto QCuj_; v1RIj: foreach ($result["\x64\x61\x74\141\163\145\x74"] as $key => $val) { goto v2NA8; v2NA8: $result["\144\x61\164\x61\163\x65\164"][$key]["\x70\162\151\x63\x65"] = floatval($val["\x70\162\151\143\145"]); goto cesq8; oUvu0: myJOT: goto U2GRA; cesq8: $result["\x64\x61\164\x61\163\x65\x74"][$key]["\x73\x74\x6f\160\x73\164\x61\155\x70"] = strtotime($val["\163\164\x6f\160\164\151\x6d\x65"]); goto oUvu0; U2GRA: } goto P1I50; S4RFW: echo JSON_OUT($result, true); goto Cun4D; P1I50: ec82O: goto WLLZM; WJKM5: $model = Model("\x64\x69\163\143\157\x75\x6e\164"); goto HakBm; BHSXJ: if (!(strlen($_GPC["\163\164\141\162\164\x74\151\155\x65"]) > 0)) { goto UHMJJ; } goto wZJMw; VpbB2: $goods = getDiscountGoodsInfo($list); goto MbFyZ; hvWLJ: $date = date("\x59\55\x6d\x2d\144", time()); goto c2J4z; O6M9k: $uniacid = intval($_W["\x75\156\x69\141\x63\x69\144"]); goto WJKM5; MbFyZ: $result["\x74\151\x6d\x65\x73\164\141\x6d\160"] = time(); goto US0_L; WLLZM: $result["\141\164\x74\x61\143\150\x75\x72\x6c"] = $_W["\x61\164\x74\141\143\x68\165\162\x6c"]; goto KTRKt; nqgWb: PknSZ: goto i4XeW; US0_L: $result["\144\141\164\x61\163\x65\x74"] = $goods; goto S4RFW; KTRKt: $list = $result["\144\x61\164\x61\x73\145\x74"]; goto VpbB2; bmcPg: global $_W, $_GPC; goto O6M9k; f5UX8: UHMJJ: goto mnoMS; Cun4D: } function getPintuanQR() { goto UaJ4H; dDp3C: $js = new WeixinJS($setting["\141\160\x70\151\144"], $setting["\163\145\x63\x72\145\x74"]); goto wEn8t; b5l9W: $res = CURL_image($url, $data); goto ajiB4; czdny: $data = "\x7b\15\12\x9\x9\x9\42\x73\143\x65\156\145\x22\x3a\x22\147\x6f\157\x64\163\151\x64\x3d" . $gid . "\42\54\15\12\x9\x9\x9\42\x70\141\x67\145\42\72\x22\x7a\x73\153\x5f\x6d\141\162\153\145\x74\x2f\x70\x61\x67\x65\163\57\x64\145\x74\x61\151\x6c\x73\x2f\151\x6e\144\x65\170\77\x67\x6f\x6f\144\163\151\144\x3d" . $gid . "\x22\54\15\xa\11\11\11\42\x77\151\x64\164\x68\42\x3a\x32\x30\x30\15\12\x9\11\x7d"; goto b5l9W; wEn8t: $token = $js->getToken(); goto eMjFT; ajiB4: $result["\142\x61\x73\x65\x36\64"] = "\x64\x61\164\141\x3a\151\155\x61\147\145\57\160\x6e\147\x3b\142\x61\163\145\66\x34\54" . base64_encode($res); goto HXXXT; eMjFT: $url = "\x68\164\x74\x70\x73\x3a\57\x2f\x61\160\151\56\167\145\151\x78\151\156\x2e\161\x71\56\143\157\x6d\57\x77\x78\141\x2f\147\145\x74\x77\170\141\x63\157\144\145\165\x6e\154\151\155\x69\164\77\141\x63\x63\x65\x73\163\x5f\164\x6f\x6b\145\x6e\x3d" . $token["\x61\143\143\145\x73\163\x5f\164\157\x6b\145\x6e"]; goto czdny; UaJ4H: $setting = getSetting(); goto dDp3C; HXXXT: } public function getMiaoShaInfo() { goto PcWfL; M9wp5: $tab0 = $model->tablename("\x6b\x61\x6e\x6a\151\x61\137\144\145\164\x61\x69\154"); goto VUosb; CkDm5: if (!empty($case)) { goto X3_GZ; } goto jT0aY; LeI_N: $uniacid = intval($_W["\x75\156\151\x61\143\x69\144"]); goto aw6Qr; tHjDp: goto XtTnK; goto rhv0I; QwaYc: XtTnK: goto XaDqa; wV9kU: $tab2 = $model->tablename("\x64\x69\163\x63\x6f\x75\x6e\164\147\162\x6f\165\160"); goto Yc4xo; jT0aY: $case["\x69\144"] = 0; goto tHjDp; rhv0I: X3_GZ: goto zULKk; B7VME: $m2 = Model("\x6b\x61\156\152\x69\141\x5f\x64\145\164\141\x69\x6c"); goto EuKgt; aw6Qr: $gid = intval($_GPC["\x67\151\144"]); goto m59US; m59US: $did = intval($_GPC["\144\x69\x64"]); goto r_pi3; Yc4xo: $discount = $model->where("\165\156\x69\x61\143\151\144\75{$uniacid}\x20\x61\156\144\40\x67\157\157\144\x73\x69\x64\75{$gid}\40\x61\x6e\144\x20\151\x64\75{$did}\x20\141\x6e\144\40\x74\x79\x70\x65\x3d\62")->get("\52"); goto cu7SD; AgKNg: $discount["\144\x61\x74\145\x73"] = explode("\54", $discount["\x64\x61\164\145\x6c\151\x6e\145"]); goto AjcRI; XaDqa: $result = array("\144\x69\163\143\157\165\x6e\164" => $discount); goto WeQhR; y_u5Y: $case = Model("\x67\x6f\157\144\163\143\x61\x73\145")->where("\x69\x64\x3d" . intval($group["\143\x61\163\x65\x69\x64"]))->get(); goto CkDm5; IisNg: $groupid = intval($_GPC["\147\x72\157\x75\160\151\x64"]); goto M9wp5; cu7SD: $discount["\143\x61\x73\x65\152\x73\x6f\x6e"] = json_decode($discount["\x63\141\163\145\x6a\163\157\156"], true); goto AgKNg; VUosb: $tab1 = $model->tablename("\x6d\x65\x6d\x62\x65\x72"); goto wV9kU; PcWfL: global $_W, $_GPC; goto LeI_N; AjcRI: $discount["\x74\151\155\x65\x73"] = explode("\54", $discount["\x74\x69\155\x65\154\x69\156\x65"]); goto y_u5Y; EuKgt: $openid = $_GPC["\x6f\x70\x65\x6e\151\144"]; goto IisNg; zULKk: $case["\x67\x6f\157\144\163\x63\157\165\156\x74"] = 1; goto QwaYc; r_pi3: $model = Model("\144\x69\163\x63\x6f\x75\156\x74"); goto B7VME; WeQhR: echo JSON_OUT($result); goto zYwUZ; zYwUZ: } public function noticeme() { goto hbV5W; NkU7o: $res["\x65\x72\162\x6d\163\147"] = "\xe5\xb7\262\347\xbb\217\xe9\242\204\347\272\xa6\346\x8f\x90\351\x86\222"; goto et20F; d7E1k: $res = array("\x73\x74\x61\164\165\163" => 0, "\145\162\162\155\163\x67" => "\345\217\202\346\x95\xb0\351\x94\231\xe8\257\xaf"); goto z1JPm; nwWTb: $date = date("\x59\x2d\x6d\55\x64\40\x48\x3a\151\x3a\163", $timestamp); goto cRQyD; z1JPm: if (!($timestamp > 150000000 && strlen($openid) > 20)) { goto ql0Wp; } goto hT9oL; jdzsa: $did = intval($_GPC["\x64\x69\x73\143\x6f\x75\156\x74\x69\x64"]); goto nVuKi; ja2nS: OGh8d: goto NxM7n; A5EqT: $res["\163\x74\x61\164\165\163"] = $model->add($notice); goto yR6Fh; hT9oL: $ex = $model->exist("\144\x69\x73\x63\x6f\x75\156\164\151\144\75" . $did . "\40\x61\x6e\144\40\157\x70\x65\x6e\x69\x64\x3d\47" . $openid . "\47\x20\x61\156\x64\x20\x6c\151\x6d\x69\164\x74\151\155\145\75" . $timestamp . "\x20\141\x6e\144\x20\x73\164\x61\164\165\163\75\60"); goto XjMp8; XEGY_: $uniacid = intval($_W["\x75\x6e\151\x61\x63\151\x64"]); goto qq3gZ; NxM7n: $discount = Model("\144\151\x73\x63\157\x75\x6e\x74")->where("\x69\144\x3d" . $did)->get("\151\144\54\x67\x6f\x6f\x64\x73\151\144"); goto pmLND; nVuKi: $model = Model("\144\151\x73\143\157\x75\x6e\164\x6e\157\x74\x69\143\145"); goto kwVLD; h2iaA: echo json_encode($res); goto y0bAj; LxRjM: ql0Wp: goto h2iaA; qq3gZ: $openid = $_GPC["\x6f\x70\145\156\151\x64"]; goto jdzsa; hbV5W: global $_W, $_GPC; goto XEGY_; pmLND: $goods = Model("\147\x6f\157\144\163")->where("\x69\144\x3d" . intval($discount["\x67\157\x6f\144\x73\x69\144"]))->get("\156\x61\x6d\145"); goto nwWTb; yR6Fh: BnN5P: goto LxRjM; et20F: goto BnN5P; goto ja2nS; cRQyD: $notice = array("\165\156\x69\141\x63\151\144" => $uniacid, "\157\x70\x65\156\x69\x64" => $openid, "\x6b\x65\171\x77\157\x72\x64\x31" => $goods["\x6e\141\x6d\x65"], "\144\x69\163\143\x6f\165\156\164\x69\x64" => intval($did), "\x74\171\x70\x65" => $discount["\164\x79\x70\x65"], "\153\x65\x79\167\x6f\x72\144\x32" => "\xe6\202\250\345\205\263\xe6\263\xa8\xe7\232\204\xe7\xa7\x92\346\235\200\346\264\xbb\xe5\x8a\xa8\xe5\260\x86\xe4\272\216" . $date . "\346\225\xb4\347\202\271\xe5\xbc\x80\345\xa7\x8b\xe6\x8a\xa2\xe8\264\255\x21", "\x63\x72\145\141\x74\x65\x74\151\x6d\x65" => $timestamp, "\154\151\155\151\164\164\x69\x6d\145" => $timestamp + 30, "\x73\x74\141\x74\x75\163" => 0); goto A5EqT; XjMp8: if (!$ex) { goto OGh8d; } goto NkU7o; kwVLD: $timestamp = intval($_GPC["\x74\x69\x6d\x65\163\x74\141\x6d\x70"]); goto d7E1k; y0bAj: } public function getTimeline() { goto HhKBd; PpLIq: goto hAH6V; goto BpTQO; F2GM7: hAH6V: goto yBSA0; ChDAI: PZjkW: goto c25xm; HhKBd: $time = time(); goto Apb2_; II3Yw: $line = array(); goto N0y0o; TmDYX: $h = $i * 2; goto s8I1h; wH7WT: KRAoB: goto fPjKl; s8I1h: $item = array("\x74\151\155\x65\163\164\x61\155\160" => strtotime($today . "\40" . $h . "\72\60\x30\x3a\x30\60"), "\x74\x69\x6d\x65" => date("\x48\72\x69", strtotime($today . "\x20" . $h . "\x3a\x30\60\72\60\x30"))); goto LvFP7; Apb2_: $now = intval(date("\110", $time)); goto ikGsW; c25xm: IZk47: goto wH7WT; QPiIx: $nextday = date("\x59\x2d\155\x2d\x64", $time + 86400); goto II3Yw; RTlAp: goto X4e_v; goto ChDAI; LvFP7: if (!(($i + 1) * 2 > 24)) { goto wpubr; } goto M2jAK; BpTQO: X4e_v: goto P9luN; P9luN: echo json_encode($line); goto VS0Wt; sNDOf: wpubr: goto Apa21; AA05_: if (!(count($line) > 4)) { goto PZjkW; } goto RTlAp; yBSA0: if (!($i < 24)) { goto X4e_v; } goto XvTbz; BWaN3: $item = array("\x74\151\155\x65\x73\164\141\x6d\160" => strtotime($nextday . "\x20" . $h . "\72\x30\60\x3a\60\60"), "\164\x69\155\145" => date("\110\x3a\x69", strtotime($nextday . "\40" . $h . "\x3a\60\x30\x3a\x30\x30"))); goto sNDOf; M2jAK: $h = $i * 2 - 24; goto BWaN3; ikGsW: $today = date("\131\55\x6d\55\144", $time); goto QPiIx; XvTbz: if (!($now < ($i + 1) * 2)) { goto IZk47; } goto TmDYX; fPjKl: $i++; goto PpLIq; N0y0o: $i = 0; goto F2GM7; Apa21: array_push($line, $item); goto AA05_; VS0Wt: } }