{template 'common/header-base'}

<link href="{MODULE_URL}static/js/artDialog/skins/idialog.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="{MODULE_URL}static/js/artDialog/artDialog.js"></script>
<script type="text/javascript" src="{MODULE_URL}static/js/artDialog/plugins/iframeTools.js"></script>

<div class="clearfix">    
    <form id="theform" class="form form-horizontal" action="javascript:;" method="post">
    <input type="hidden" name="merchant_id" id="merchant_id" value="{$id}" />
    <input type="hidden" name="id" id="id" value="{$item['id']}" />

        <div class="panel panel-default">
            <div class="panel-heading">
                简易优惠活动模型[详细优惠活动模型正在开发中]
            </div>
            <div class="panel-body">
                
                <div class="form-group">
                    <label class="col-xs-12 col-sm-3 col-md-2 control-label">新用户减</label>
                    <div class="col-sm-9 col-xs-12">
                        <input type="text" name="new_disc" id="new_disc" value="{$item[new_disc]}" class="form-control">
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-xs-12 col-sm-3 col-md-2 control-label">满减活动一</label>
                    <div class="col-sm-9 col-xs-12">
                        满<input type="text" name="man_1" id="man_1" value="{$item[man_1]}" >
                        减<input type="text" name="jian_1" id="jian_1" value="{$item[jian_1]}" >
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-xs-12 col-sm-3 col-md-2 control-label">满减活动二</label>
                    <div class="col-sm-9 col-xs-12">
                        满<input type="text" name="man_2" id="man_2" value="{$item[man_2]}">
                        减<input type="text" name="jian_2" id="jian_2" value="{$item[jian_2]}">
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-xs-12 col-sm-3 col-md-2 control-label">满减活动三</label>
                    <div class="col-sm-9 col-xs-12">
                        满<input type="text" name="man_3" id="man_3" value="{$item[man_3]}" >
                        减<input type="text" name="jian_3" id="jian_3" value="{$item[jian_3]}" >
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-xs-12 col-sm-3 col-md-2 control-label">折扣商品打折数</label>
                    <div class="col-sm-9 col-xs-12">
                        <input type="text" name="disc" id="disc" value="{$item[disc]}" class="form-control">
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="col-xs-12 col-sm-3 col-md-2 control-label"></label>
                    <div class="col-md-2 col-lg-1">
                        <div onclick="submitok()" class="btn btn-primary btn-block">保存</div>
                        
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>

<script type="text/javascript">
function submitok(){
	var id = $("#id").val();
    var merchant_id = $("#merchant_id").val();
    var new_disc    = $("#new_disc").val();
    var man_1       = $("#man_1").val();
    var jian_1      = $("#jian_1").val();
    var man_2       = $("#man_2").val();
    var jian_2      = $("#jian_2").val();
    var man_3       = $("#man_3").val();
    var jian_3      = $("#jian_3").val();
    var disc        = $("#disc").val();

    if(new_disc != ""){
    	if(isNaN(new_disc)){
	  		alert("首单减必须是数字！");
	  		return false;
	  	}
	  	if(new_disc<0){
	  		alert("首单减必须为大于的数字！");
	  		return false;
	  	}
	} 	
    
    if(man_1 != ""){
    	if(isNaN(man_1)){
	  		alert("满减必须是数字！");
	  		return false;
	  	}
	  	if(man_1<0){
	  		alert("满减活动不能为负数！");
	  		return false;
	  	}
	  	if(isNaN(jian_1)){
	  		alert("满减必须是数字！");
	  		return false;
	  	}
	  	if(jian_1<0){
	  		alert("满减活动一不能为负数！");
	  		return false;
	  	}
	  	if(jian_1 == ''){
	  		alert('满减活动一数据不能为空！');
	  		return false;
	  	}
    }

    if(man_2 != ""){
    	if(isNaN(man_2)){
	  		alert("满减必须是数字！");
	  		return false;
	  	}
	  	if(man_2<0){
	  		alert("满减活动二不能为负数！");
	  		return false;
	  	}
	  	if(isNaN(jian_2)){
	  		alert("满减必须是数字！");
	  		return false;
	  	}
	  	if(jian_2<0){
	  		alert("满减活动二不能为负数！");
	  		return false;
	  	}
	  	if(jian_2 == ''){
	  		alert('满减活动二数据不能为空！');
	  		return false;
	  	}
    }

    if(man_3 != ""){
    	if(isNaN(man_3)){
	  		alert("满减必须是数字！");
	  		return false;
	  	}
	  	if(man_3<0){
	  		alert("满减活动三不能为负数！");
	  		return false;
	  	}
	  	if(isNaN(jian_3)){
	  		alert("满减必须是数字！");
	  		return false;
	  	}
	  	if(jian_3<0){
	  		alert("满减活动三不能为负数！");
	  		return false;
	  	}
	  	if(jian_3 == ''){
	  		alert('满减活动三数据不能为空！');
	  		return false;
	  	}
    }

    if(disc != ''){
    	if(isNaN(disc)){
	  		alert("折扣必须是数字！");
	  		return false;
	  	}
	  	if(disc<0){
	  		alert("折扣必须不能为负数！");
	  		return false;
	  	}
    }

    var data = {};
    data['id'] = id;
    data['merchant_id'] = merchant_id;
    data['new_disc']    = new_disc;
    data['man_1']		= man_1;
    data['jian_1']	    = jian_1;
    data['man_2']		= man_2;
    data['jian_2']	    = jian_2;
    data['man_3']		= man_3;
    data['jian_3']	    = jian_3;
    data['disc']	    = disc;
    $.ajax({
        url: "{php echo $this->createWebUrl('takeout', array('foo'=>'activityok'))}",
        type:"POST",
        data:data,
        dataType:"json",
        success: function(res){
            if(res == 1){
                art.dialog({
                    title: '提示消息',
                    content: '配置成功',
                    ok: function () {
                        art.dialog.close();
                        return false;
                    }
                });
            }else{
                art.dialog({
                    time: 1,
                    content: '配置失败！'
                });
            }
        }
    });
}
</script>