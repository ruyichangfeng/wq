function Events(){}function triggerEvents(a,b,c){var e,f,g,h,i,d=!0;if(a)switch(e=0,f=a.length,g=b[0],h=b[1],i=b[2],b.length){case 0:for(;f>e;e+=2)d=a[e].call(a[e+1]||c)!==!1&&d;break;case 1:for(;f>e;e+=2)d=a[e].call(a[e+1]||c,g)!==!1&&d;break;case 2:for(;f>e;e+=2)d=a[e].call(a[e+1]||c,g,h)!==!1&&d;break;case 3:for(;f>e;e+=2)d=a[e].call(a[e+1]||c,g,h,i)!==!1&&d;break;default:for(;f>e;e+=2)d=a[e].apply(a[e+1]||c,b)!==!1&&d}return d}function isFunction(a){return"[object Function]"===Object.prototype.toString.call(a)}function getNode(a,b,c){var d=document.createElement(a);return d.className=b||"",d.innerHTML=c||"",d}var keys,Eventor,Event,F_tap,PickerDialog,ITEM_HEIGHT,BLANK_ITEM_NUMBER,SPEED_FACTOR,MAX_ANIMATION_TOUCH_MOVE_TIME,MAX_ANIMATION_TIME,RESET_POSITION_ANIMATION_TIME,SLOW_DRAG_ANIMATION_TIME,CALLBACK_DELAY,ITEM_CLASS,SELECTED_CLASS,TEMPLATE,BaseScroller,PickerCore,Picker,eventSplitter=/\s+/;Events.prototype.on=function(a,b,c){var d,e,f;if(!b)return this;for(d=this.__events||(this.__events={}),a=a.split(eventSplitter);e=a.shift();)f=d[e]||(d[e]=[]),f.push(b,c);return this},Events.prototype.once=function(a,b,c){var d=this,e=function(){d.off(a,e),b.apply(c||d,arguments)};return this.on(a,e,c)},Events.prototype.off=function(a,b,c){var d,e,f,g;if(!(d=this.__events))return this;if(!(a||b||c))return delete this.__events,this;for(a=a?a.split(eventSplitter):keys(d);e=a.shift();)if(f=d[e])if(b||c)for(g=f.length-2;g>=0;g-=2)b&&f[g]!==b||c&&f[g+1]!==c||f.splice(g,2);else delete d[e];return this},Events.prototype.trigger=function(a){var b,c,d,e,f,g,h=[],j=!0;if(!(b=this.__events))return this;for(a=a.split(eventSplitter),f=1,g=arguments.length;g>f;f++)h[f-1]=arguments[f];for(;c=a.shift();)(d=b.all)&&(d=d.slice()),(e=b[c])&&(e=e.slice()),"all"!==c&&(j=triggerEvents(e,h,this)&&j),j=triggerEvents(d,[c].concat(h),this)&&j;return j},Events.prototype.emit=Events.prototype.trigger,keys=Object.keys,keys||(keys=function(a){var c,b=[];for(c in a)a.hasOwnProperty(c)&&b.push(c);return b}),Events.mixTo=function(a){function e(c){a[c]=function(){return b[c].apply(d,Array.prototype.slice.call(arguments)),this}}var c,d,b=Events.prototype;if(isFunction(a)){for(c in b)b.hasOwnProperty(c)&&(a.prototype[c]=b[c]);Object.keys(b).forEach(function(c){a.prototype[c]=b[c]})}else{d=new Events;for(c in b)b.hasOwnProperty(c)&&e(c)}},Eventor=Events,Event={tap:function(a,b){return a?(a.__tap={},a.__tap.event={start:function(b){b.stopPropagation(),a.__tap.clickabled=!0,a.__tap.starttime=b.timeStamp,a.__tap.startPageX=b.changedTouches[0].pageX,a.__tap.startPageY=b.changedTouches[0].pageY},move:function(b){(Math.abs(b.changedTouches[0].pageX-a.__tap.startPageX)>=5||Math.abs(b.changedTouches[0].pageY-a.__tap.startPageY)>=5)&&(a.__tap.clickabled=!1)},end:function(c){c.stopPropagation(),c.preventDefault(),c.timeStamp-a.__tap.starttime>30&&c.timeStamp-a.__tap.starttime<300&&a.__tap.clickabled&&b&&b(c)},click:function(a){a.stopPropagation(),b&&b(a)}},navigator.userAgent.match(/AppleWebKit.*Mobile.*/)?(a.addEventListener("touchstart",a.__tap.event.start,!1),a.addEventListener("touchmove",a.__tap.event.move,!1),a.addEventListener("touchend",a.__tap.event.end,!1)):a.addEventListener("click",a.__tap.event.click,!1),a):console.error("tap对象不能为空")},untap:function(a){return a?(a.__tap=a.__tap||{},navigator.userAgent.match(/AppleWebKit.*Mobile.*/)&&a.__tap.event?(a.__tap.event.start&&a.removeEventListener("touchstart",a.__tap.event.start,!1),a.__tap.event.move&&a.removeEventListener("touchmove",a.__tap.event.move,!1),a.__tap.event.end&&a.removeEventListener("touchend",a.__tap.event.end,!1)):a.__tap.event&&a.__tap.event.click&&a.removeEventListener("click",a.__tap.event.click,!1),a):console.error("untap对象不能为空")}},window.__tap__=Event.tap,window.__untap__=Event.untap,F_tap=Event,PickerDialog=function(a){var b,c;return this.params={},"[object Object]"===Object.prototype.toString.call(a)&&(this.params={input:a.input||"",container:document.querySelector(a.input)||"",innerHTML:a.innerHTML||"",onOpen:a.onOpen||function(){},onClose:a.onClose||function(){},_open:a._open||function(){},_close:a._close||function(){}},this.input=document.querySelector(a.input)),this.params&&this.params.input?this.params.container&&this.params.container?(!!document.querySelectorAll(".picker-mask").length<=0&&(b=document.createElement("a"),b.className="picker-mask",b.href="javascript:void(0);",document.body.appendChild(b)),c=document.createElement("div"),c.className="picker-dialog",document.body.appendChild(c),this.mask=document.querySelector(".picker-mask"),this.container=document.querySelectorAll(".picker-dialog"),this.container=this.container[this.container.length-1],this.container.innerHTML=this.params.innerHTML,this._hackInputFocus(),this._bindEvents(),a=null,this):(console.error("picker-dialog: container对应的dom对象不存在"),!1):(console.error("picker-dialog: input对应的dom对象不存在"),!1)},Eventor.mixTo(PickerDialog),PickerDialog.prototype._hackInputFocus=function(){var a=document.createElement("div"),b=this.params.container,c=b.parentNode,d=document.getElementById(b.getAttribute("id")+"Mask");return d?(d.style.width=b.offsetWidth+2*b.clientLeft+"px",d.style.height=b.offsetHeight+2*b.clientTop+"px",d.style.position="absolute",d.style.left=b.offsetLeft+"px",d.style.top=b.offsetTop+"px"):(a.style.width=b.offsetWidth+2*b.clientLeft+"px",a.style.height=b.offsetHeight+2*b.clientTop+"px",a.style.position="absolute",a.style.left=b.offsetLeft+"px",a.style.top=b.offsetTop+"px",a.setAttribute("id",b.getAttribute("id")+"Mask"),c.insertBefore(a,b),this.input=document.getElementById(b.getAttribute("id")+"Mask")),this._bindEventInput(),this},PickerDialog.prototype.updateInputPosition=function(){this._hackInputFocus()},PickerDialog.prototype._bindEventInput=function(){var b,a=this;return F_tap.untap(this.input),b=function(){a.show(),function(){var b=document.documentElement.clientHeight,c=document.body.scrollTop,d=a.container.offsetHeight,e=a.input.getBoundingClientRect().top+c,f=a.input.offsetHeight;(e-c+f>b-d||f>e-c+f)&&a.scrollAnimate(e-(b-d)/2,400)}()},F_tap.tap(this.input,b),F_tap.tap(this.params.container,b),this},PickerDialog.prototype.scrollAnimate=function(a,b){var c=this,d=25*((document.body.scrollTop-a)/b),e=-1;return c.interval=setInterval(function(){Math.abs(document.body.scrollTop-a)<Math.abs(d)&&clearInterval(c.interval),e=document.body.scrollTop,document.body.scrollTop=e-d,e==document.body.scrollTop&&clearInterval(c.interval)},8),this},PickerDialog.prototype._bindEvents=function(){function b(){a.hide(),a.emit("close")}var a=this;return F_tap.tap(this.mask,b),this.container.addEventListener("touchmove",function(a){return a.stopPropagation(),a.preventDefault(),!1},!1),this},PickerDialog.prototype.show=function(){var a=this;return a.mask.classList.add("show"),a.container.classList.add("modal-in"),a.params._open&&a.params._open(this),a.params.onOpen&&a.params.onOpen(this),this},PickerDialog.prototype.hide=function(){var a=this;return a.mask.classList.remove("show"),a.container.classList.remove("modal-in"),a.params._close&&a.params._close(this),a.params.onClose&&a.params.onClose(this),this},PickerDialog.prototype.html=function(a){return this.container.innerHTML=a,this},ITEM_HEIGHT=34,BLANK_ITEM_NUMBER=3,SPEED_FACTOR=3,MAX_ANIMATION_TOUCH_MOVE_TIME=200,MAX_ANIMATION_TIME=1500,RESET_POSITION_ANIMATION_TIME=.2,SLOW_DRAG_ANIMATION_TIME=.1,CALLBACK_DELAY=50,ITEM_CLASS="basescroller-item",SELECTED_CLASS="basescroller-selected",TEMPLATE='<div class="basescroller-component">   <div class="basescroller-mask"></div>   <div class="basescroller-current-indicator"></div>   <div class="basescroller-scroller"></div> </div>',BaseScroller=function(a){var c,d,b=document.createElement("div");if(b.innerHTML=TEMPLATE,this.scrollerComponent=b.firstElementChild,this.scroller=this.scrollerComponent.lastElementChild,a=a||{},c=a.itemsNumber,c&&0==c%2)throw new Error("Option itemsNumber must be odd number");this.itemHeight=parseInt(a.itemHeight)||ITEM_HEIGHT,this.blankItemNumber=c?(c-1)/2:BLANK_ITEM_NUMBER,this.blankEdgeHeight=this.itemHeight*this.blankItemNumber,this.maxTransitionY=this.itemHeight*(this.blankItemNumber+1),d=a.container,d&&d.nodeType==Node.ELEMENT_NODE&&d.appendChild(this.scrollerComponent),this.parentHeight=2*this.blankEdgeHeight+this.itemHeight,a.className&&(this.scrollerComponent.className=a.className+" basescroller-component"),a.data&&this.render(a.data),this.callback=a.selectedCallback,this._resetHeight(),this.startYInMove=0,this.touch=null,this._init()},BaseScroller.prototype={currentValue:null,prevValue:null,_init:function(){this._setTransitionDuratoin(RESET_POSITION_ANIMATION_TIME),this._bindEvents()},_bindEvents:function(){var g,a=this,b=this.itemHeight,c=this.blankEdgeHeight,d=this.scroller,e=this.scrollerComponent,f=this.parentHeight;e.addEventListener("touchstart",function(b){var c=b.changedTouches[0];a._setTransitionDuratoin(0),g=+new Date,a.startY=a.startYInMove=c.clientY,clearTimeout(a.callbackTimer)},!1),e.addEventListener("touchmove",function(b){b.preventDefault(),a.touch=b.changedTouches[0],a._setPosition()},!1),e.addEventListener("touchend",function(e){var k,l,o,p,q,r,h=e.changedTouches[0],i=+new Date,j=a._getCurrentTransitionY(),m=!1,n=h.clientY-a.startY;0!=n&&(MAX_ANIMATION_TOUCH_MOVE_TIME>i-g?(m=!0,o=Math.abs(n)/(i-g)/SPEED_FACTOR,0>n?(l=Math.abs(-(a.scrollerHeight-f)-j)/o,k=-(a.scrollerHeight-f)-c):(l=Math.abs(j)/o,k=c),l>MAX_ANIMATION_TIME&&(l=MAX_ANIMATION_TIME,p=o*l,k=0>n?j-p:j+p),k=Math.round(k/b)*b,l/=1e3):(l=SLOW_DRAG_ANIMATION_TIME,k=Math.round(j/b)*b),k>c?k=c:k<a.minTransitionY+b&&(k=a.minTransitionY+b),Math.abs(k-j)<c&&(l=SLOW_DRAG_ANIMATION_TIME),a._setTransitionDuratoin(l),a._setTransformY(k),q=Math.abs(k/b-a.blankItemNumber),r=d.children[parseInt(q)],r&&(a._selectElem(r),a.prevValue=a.currentValue,a.currentValue=r.dataset.value,"function"==typeof a.callback&&(a.callbackTimer=setTimeout(function(){a.callback(a.currentValue,a.prevValue)},CALLBACK_DELAY))),a.touch=null)},!1)},_resetHeight:function(){this.scrollerHeight=this.scroller.childElementCount*this.itemHeight,this.minTransitionY=-(this.scrollerHeight+this.maxTransitionY-this.parentHeight)},_setPosition:function(a){var b,c,d,e;a=a||this.touch,a&&(b=a.clientY,c=b-this.startYInMove,d=this._getCurrentTransitionY(),e=d+c,e>this.maxTransitionY?e=this.maxTransitionY:e<this.minTransitionY&&(e=this.minTransitionY),this._setTransformY(e),this.startYInMove=b)},_setTransitionDuratoin:function(a){var b="all "+a+"s ease-out";this.scroller.style.webkitTransition=b,this.scroller.style.transition=b},_setTransformY:function(a){this.scroller.style.webkitTransform="translate3d(0, "+a+"px, 0)"},_getCurrentTransitionY:function(){var a=this.scroller.style.webkitTransform;return a?parseFloat(a.split(",")[1].trim()):0},_getRealTransitionY:function(){var a=window.getComputedStyle(this.scroller),b=a["-webkit-transform"].match(/,\s?(-?\d+)\)/);return b&&2==b.length?parseFloat(b[1]):0},_selectElem:function(a){var b=this.scroller.querySelector("."+SELECTED_CLASS);b&&b.classList.remove(SELECTED_CLASS),a.classList.add(SELECTED_CLASS)},selectByIndex:function(a){var c,d,b=this.scroller;return 0>a||a>b.childElementCount-1?!1:(c=this.blankEdgeHeight-this.itemHeight*a,this._setTransitionDuratoin(RESET_POSITION_ANIMATION_TIME),this._setTransformY(c),d=b.children[a],this._selectElem(d),this.prevValue=this.currentValue,this.currentValue=d.dataset.value,void 0)},select:function(a){var b,c,d;if(void 0===a||null===a)return this;for(b=this.scroller.children,c=0,d=b.length;d>c;c++)if(b[c].dataset.value==a)return this.selectByIndex(c),void 0;return this},selectThenCallback:function(a){return this.select(a),"function"==typeof this.callback&&this.callback(this.currentValue,this.prevValue),this},getValue:function(){return this.currentValue},setSelectedCallback:function(a){return this.callback=a,this},render:function(a){if(!a||0==a.length||a.constructor!==Array)return!1;var b="";return a[0].constructor===Object?a.forEach(function(a){b+='<div class="'+ITEM_CLASS+'" data-value="'+a.value+'">'+a.name+"</div>"}):a.forEach(function(a){b+='<div class="'+ITEM_CLASS+'" data-value="'+a+'">'+a+"</div>"}),this.scroller.innerHTML=b,this._resetHeight(),this.selectByIndex(0),this},destroy:function(){this.scrollerComponent.parentNode.removeChild(this.scrollerComponent)},appendTo:function(a){a&&a.nodeType==Node.ELEMENT_NODE&&(a.appendChild(this.scrollerComponent),this._resetHeight())}},PickerCore=BaseScroller,Picker=function(a){var b=this;return"[object Object]"===Object.prototype.toString.call(a)&&(this.params={itemsNumber:a.itemsNumber||7,itemHeight:a.itemHeight||30,cols:a.cols||[],input:a.input||"",inputContainer:document.querySelector(a.input)||"",toolbarTemplate:a.toolbarTemplate||'<div class="picker-toolbar"><a href="javascript:void(0);" class="picker-toolbar-left">取消</a><a href="javascript:void(0);" class="picker-toolbar-right">完成</a></div>',formatValue:a.formatValue||function(a,b){return b.join(" ")},after:a.after,_open:function(){b.inputSelf.value=b.params.formatValue(b,b._getValues())},_close:function(){}},this.input=document.querySelector(a.input),this.inputSelf=this.input,a.container&&(this.params.container=a.container||"",this.container=document.querySelector(a.container)),a.onOpen&&(this.params.onOpen=a.onOpen),a.onClose&&(this.params.onClose=a.onClose),a.onChange&&(this.params.onChange=a.onChange),a=null),this.isError()?!1:(this.init(),this)},Eventor.mixTo(Picker),Picker.prototype.isError=function(){return this.input?this.params.container&&!this.container?(console.error("container对应的dom对象不存在"),!0):!1:(console.error("input对应的dom对象不存在"),!0)},Picker.prototype.init=function(){return this.input.setAttribute("readonly","readonly"),this.input.style.webkitTapHighlightColor="rgba(0,0,0,0)",this.container?(this.dialog={},this.dialog.container=this.container,this.dialog.container.innerHTML='<div class="picker-cols"></div>',this._wrap=this.dialog.container.querySelector(".picker-cols"),this.initPickerCore()):(this.initDialog(),this.initPicker(),this.initPickerCore(),this._bindEventToolbar()),this.params.after&&this.params.after(this),this._getValues(),this},Picker.prototype.destroy=function(){(this.container.classList+"").indexOf("modal-in")>0&&this.dialog.hide(),this.params.container?this.container.innerHTML="":this.container.remove(),F_tap.untap(this.input),clearTimeout(this.timeout);for(var a in this)delete this[a]},Picker.prototype.initPicker=function(){return this._wrap=this.container.querySelector(".picker-cols"),this},Picker.prototype.initDialog=function(){return this.dialog=new PickerDialog(this.params),this.params.container||(this.container=this.dialog.container,this.container.innerHTML=this.params.toolbarTemplate+'<div class="picker-cols"></div>'),this},Picker.prototype.close=function(){return this.dialog.hide(),this.params.onClose&&this.params.onClose(this),this},Picker.prototype.open=function(){return this.dialog.show(),this.params.onOpen&&this.params.onOpen(this),this},Picker.prototype.initPickerCore=function(){var b,c,d,e,f,g,a=this;for(this.cols=[],b=this.params.cols,c=0;c<b.length;c++)if(b[c].divider===!0)this._wrap.appendChild(getNode("div","basescroller-divider",b[c].content));else{if(!b[c].values)continue;if(b[c].displayValues)for(d=[],e=0;e<b[c].values.length;e++)d.push({name:b[c].displayValues[e]||b[c].values[e],value:b[c].values[e]});else d=b[c].values;f={container:this._wrap,data:d,itemHeight:this.params.itemHeight,itemsNumber:this.params.itemsNumber,selectedCallback:function(){var d=c;return function(c,e){b[d].onChange?b[d].onChange(a,c,e):a.params.onChange&&a.params.onChange(a,c,e),a.inputSelf.value=a.params.formatValue(this,a._getValues())}}()},g=new PickerCore(f),g.container=g.scrollerComponent,g.items=g.container.querySelectorAll(".basescroller-item"),delete g.scrollerComponent,g.values=b[c].values,g.replaceValues=function(b,c){var d,e;if(a._InitCssPickerCore(),c){for(d=[],e=0;e<b.length;e++)d.push({name:c[e]||b[e],value:b[e]});this.render(d)}else this.render(b)},this.cols.push(g)}return this._wrap.appendChild(getNode("div","basescroller-current-indicator-all")),this._component=this.container.querySelectorAll(".basescroller-component"),this._InitCssPickerCore(),this},Picker.prototype._InitCssPickerCore=function(){var a=this;return a._setCssWidth(),this.timeout=setTimeout(function(){var b,c,d,e;if(a.params){for(a._setCssWidth(),a._wrap.style.height=a.params.itemsNumber*a.params.itemHeight+"px",b=a._wrap.querySelectorAll(".basescroller-item"),c=a._wrap.querySelectorAll(".basescroller-current-indicator"),d=a._wrap.querySelector(".basescroller-current-indicator-all"),e=0;e<a._component.length;e++)a._component[e].style.height=a.params.itemsNumber*a.params.itemHeight+"px";for(e=0;e<c.length;e++)c[e].style.height=a.params.itemHeight-2+"px",c[e].style.top=a.params.itemHeight*(a.params.itemsNumber-1)/2+"px";for(d.style.top=a.params.itemHeight*(a.params.itemsNumber-1)/2+"px",d.style.height=a.params.itemHeight-2+"px",e=0;e<b.length;e++)b[e].style.height=a.params.itemHeight+"px",b[e].style.lineHeight=a.params.itemHeight+"px"}},100),this},Picker.prototype._setCssWidth=function(){var a,b;for(a=0;a<this._component.length;a++)b=this._component[a].querySelector(".basescroller-scroller"),b=b?b.offsetWidth:this._component[a].offsetWidth,this._component[a].style.width=this.params.cols[a].width?this.params.cols[a].width+"px":b+"px",this._component[a].style.textAlign=this.params.cols[a].textAlign||"center"},Picker.prototype.setValue=function(a){if("[object Array]"==Object.prototype.toString.call(a))for(var b=0;b<this.cols.length;b++)a[b]&&this.cols[b].select(a[b]);else console.error("setValue的参数必须是数组")},Picker.prototype._bindEventToolbar=function(){var c,a=this,b=a.container.querySelector(".picker-toolbar-right");b&&(a.on("toolbarRight",function(){a.close()}),b.click=function(b){a.emit("toolbarRight",b)},F_tap.tap(b,b.click)),c=a.container.querySelector(".picker-toolbar-left"),c&&(a.on("toolbarLeft",function(){a.close()}),c.click=function(b){a.emit("toolbarLeft",b)},F_tap.tap(c,c.click))},Picker.prototype._bindEventInput11111=function(){var a=this;return F_tap.untap(this.input),F_tap.tap(this.input,function(){a.open(),function(){var b=document.documentElement.clientHeight,c=document.body.scrollTop,d=a.dialog.container.offsetHeight,e=a.input.offsetTop,f=a.input.offsetHeight;(e-c+f>b-d||f>e-c+f)&&a.scrollAnimate(e-(b-d)/2,400)}()}),F_tap.tap(this.params.inputContainer,function(){a.open(),function(){var b=document.documentElement.clientHeight,c=document.body.scrollTop,d=a.dialog.container.offsetHeight,e=a.input.offsetTop,f=a.input.offsetHeight;(e-c+f>b-d||f>e-c+f)&&a.scrollAnimate(e-(b-d)/2,400)}()}),this},Picker.prototype._getValues=function(){var b,a=[];for(b=0;b<this.cols.length;b++)this.cols[b].getValue&&a.push(this.cols[b].getValue());return this.values=a,a};